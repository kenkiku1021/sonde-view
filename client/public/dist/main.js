/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={472:function(){!function(t){var e=this||t||{};function n(t,e){if(e<=0)return"";var n="";do{1&e&&(n+=t)}while((e>>=1)>=1&&(t+=t));return n}void 0!==e.agh?t=e.agh:void 0!==e.module&&void 0!==e.module.exports?t=e.module.exports:null==t&&(t=e.agh={});var r=4294967296,i=-2147483648,o=r*r;function s(t){return t<0?Math.ceil(t):Math.floor(t)}function a(t,e){switch(t=s(t),e){case"hh":return(t&=255)>=128?t-256:t;case"h":return(t&=65535)>=32768?t-65536:t;case"l":case"z":case"t":case"I32":case"I":return(t%=r)<i?t+=r:t>2147483647&&(t-=r),t;case"ll":case"I64":case"q":case"L":return(t%=o)<-0x8000000000000000?t+=o:t>0x8000000000000000&&(t-=o),t;case"j":default:return t}}function u(t,e){switch(t=s(t),e){case"hh":return 255&t;case"h":return 65535&t;case"l":case"z":case"t":case"I32":case"I":return(t%=r)<0?t+r:t;case"ll":case"I64":case"q":case"L":return(t%=o)<0?t+o:t;case"j":default:if(t<0){var n=t<i?1+Math.ceil(Math.LOG2E*Math.log(-t)):32;t+=Math.pow(2,n)}return t}}function c(t,e){if("h"===e||"hh"===e){var n=t<0?-1:1,r=Math.floor(Math.LOG2E*Math.log(n*t)),i=Math.pow(2,r-23);t=(0|t/i)*i}return t}function l(t,e){return t|=0,"h"!==e&&"hh"!==e||(t&=255),t}var h=[/(...)(?!$)/g,/(^.|...)(?!$)/g,/(^..|...)(?!$)/g];function f(t,e){return t.length<4||!/\'/.test(e)?t:t.replace(h[t.length%3],"$1,")}var p="0123456789abcdef";function d(t,e,r,i){var o="";do{o=p.charAt(t%i)+o,t=Math.floor(t/i)}while(t>0);return null!=r&&(o=n("0",r-o.length)+o),o}function g(t,e,n,r){return f(d(t,0,n,10),e)}function v(t,e,n,r){return d(t,0,n,16).toUpperCase()}var y=[];function m(t,e){if(0===t)return[0,0];var n=1+Math.floor(y[e]*Math.log(t));return(t*=Math.pow(e,-n))*e<1?(t*=e,n--):t>=1&&(t/=e,n++),[t,n]}y[2]=Math.LOG2E,y[10]=Math.LOG10E,y[16]=Math.LOG2E/4;var b=[];function w(t,e,r){for(var i="";--e>0;)i+=p.charAt(0|(t=t*r%r));var o=Math.round(t*r%r);if(o==r){var s=b[r].exec(i)[0].length;if(s<i.length){var a=i.length-s-1;i=i.slice(0,a)+p.charAt(1+(0|i.charAt(a)))+n("0",s+1)}else i="1"+n("0",s+1)}else i+=p.charAt(o);return i}function E(t,e){return t.replace(/(\.[\da-f]*?)0+$/,(function(t,n){return n&&n.length>1?n:/#/.test(e)?".":""}))}function I(t,e,n,r){if(isNaN(t))return"nan";if(!isFinite(t))return"inf";null==n&&(n=6);var i=m(t,10),o=i[0],s=i[1]-1,a=w(o,1+n,10);return a.length>n+1&&(a=a.slice(0,-1),s++),(n>0||/#/.test(e))&&(a=a.slice(0,1)+"."+a.slice(1)),a+(s<0?"e-"+(1e3-s).toString().slice(1):"e+"+(1e3+s).toString().slice(1))}function _(t,e,n,r){if(isNaN(t))return"nan";if(!isFinite(t))return"inf";null==n&&(n="h"===r||"hh"===r?6:13);var i=m(t,2),o=i[0],s=i[1]-1,a=w(1/8*o,n+1,16);return a.length>n+1&&(a=a.slice(0,-1),s++),(a.length>1||/#/.test(e))&&(a=a.slice(0,1)+"."+a.slice(1)),(a=E(a,e))+(s<0?"p-"+(1e3-s).toString().slice(1):"p+"+(1e3+s).toString().slice(1))}function S(t,e,n,r){if(isNaN(t))return"nan";if(!isFinite(t))return"inf";if(null==n&&(n=6),t>=1)var i=m(t,10),o=i[0],s=i[1];else o=t/10,s=1;var a=w(o,s+n,10);if(n>0||/#/.test(e)){var u=a.length-n;a=f(a.slice(0,u),e)+"."+a.slice(u)}else a=f(a,e);return a}function T(t,e,r,i){if(isNaN(t))return"nan";if(!isFinite(t))return"inf";if(null==r?r=6:r<1&&(r=1),t<1e-4||Math.pow(10,r)<=t+.5){var o=I(t,e,r-1);return/#/.test(e)?o:function(t,e){return t.replace(/(\.\d*?)0+e/,(function(t,n){return n&&n.length>1?n+"e":/#/.test(e)?".e":"e"}))}(o,e)}var s=m(t,10),a=s[0],u=s[1];r<1&&(r=1);var c=w(a,r,10),l=c.length-(r-u);return l>0?(l<c.length||/#/.test(e))&&(c=f(c.slice(0,l),e)+"."+c.slice(l,r)):c="0."+n("0",-l)+c.slice(0,r),/#/.test(e)?c:E(c,e)}function k(t,e,n,r){return String.fromCharCode(t)}function x(t,e,n,r){return t=null==t?void 0===t?"(undefined)":"(null)":t.toString(),null!=n&&(t=t.slice(0,n)),t}b[10]=/9*$/,b[16]=/f*$/;var N={d:{getv:a,integral:!0,signed:!0,prefix:null,conv:g},i:{getv:a,integral:!0,signed:!0,prefix:null,conv:g},u:{getv:u,integral:!0,signed:!1,prefix:null,conv:g},o:{getv:u,integral:!0,signed:!1,prefix:function(t){return/#/.test(t)?"0":""},conv:function(t,e,n,r){return d(t,0,n,8)}},x:{getv:u,integral:!0,signed:!1,prefix:function(t){return/#/.test(t)?"0x":""},conv:function(t,e,n,r){return d(t,0,n,16)}},X:{getv:u,integral:!0,signed:!1,prefix:function(t){return/#/.test(t)?"0X":""},conv:v},e:{getv:c,integral:!1,signed:!0,prefix:null,conv:I},E:{getv:c,integral:!1,signed:!0,prefix:null,conv:function(t,e,n,r){return I(t,e,n).toUpperCase()}},f:{getv:c,integral:!1,signed:!0,prefix:null,conv:S},F:{getv:c,integral:!1,signed:!0,prefix:null,conv:function(t,e,n,r){return S(t,e,n).toUpperCase()}},g:{getv:c,integral:!1,signed:!0,prefix:null,conv:T},G:{getv:c,integral:!1,signed:!0,prefix:null,conv:function(t,e,n,r){return T(t,e,n).toUpperCase()}},a:{getv:c,integral:!1,signed:!0,prefix:function(t){return"0x"},conv:_},A:{getv:c,integral:!1,signed:!0,prefix:function(t){return"0X"},conv:function(t,e,n,r){return _(t,e,n,r).toUpperCase()}},c:{getv:l,integral:!1,signed:!1,prefix:null,conv:k},C:{getv:l,integral:!1,signed:!1,prefix:null,conv:k},s:{getv:null,integral:!1,signed:!1,prefix:null,conv:x},S:{getv:null,integral:!1,signed:!1,prefix:null,conv:x},p:{getv:u,integral:!1,signed:!1,prefix:function(t){return"0x"},conv:v},n:{getv:null,integral:!1,signed:!1,prefix:null,conv:function(t,e,n,r,i){return t[0]=a(i,r),""}},"%":{noValue:!0,integral:!1,signed:!1,prefix:null,conv:function(t,e,n,r){return"%"}}};function A(t){var e=arguments,r=1,i=0,o=0,s=t.replace(/%(?:(\d+)\$)?([-+ 0#']*)(\d+|\*(?:\d+\$)?)?(\.(?:\d+|\*(?:\d+\$)?)?)?(hh|ll|I(?:32|64)?|[hlLjztqw])?(.|$)/g,(function(t,s,a,u,c,l,h,f){if(o+=f-i,i=f+t.length,null==(h=N[h]))return o+=(g="(sprintf:error:"+t+")").length,g;s=null==s||""===s?null:"*"===s?0|e[r++]:0|s,u=null==u||""===u?0:"*"===u?0|e[r++]:"*"===u.charAt(0)?e[0|u.slice(1,-1)]:0|u,c=null==c||""===c?null:".*"===c?0|e[r++]:"*"===c.charAt(1)?e[0|c.slice(2,-1)]:0|c.slice(1);var p=h.noValue?null:null===s?e[r++]:e[s];h.getv&&(p=h.getv(p,l));var d="";h.signed&&(p<0?(d="-",p=-p):/\+/.test(a)?d="+":/ /.test(a)&&(d=" ")),h.prefix&&0!=p&&(d+=h.prefix(a));var g,v=h.conv(p,a,c,l,o),y="",m="",b="";return(u-=d.length+v.length)>=1&&(/-/.test(a)?b=n(" ",u):!/0/.test(a)||h.integral&&null!=c?y=n(" ",u):m=n("0",u)),o+=(g=y+d+m+v+b).length,g}));return[o+=t.length-i,s]}t.sprintf=function(){var t=A.apply(this,arguments);return t[1]},t.vsprintf=function(t,e){return A.apply(this,[t].concat(e))[1]};var D=null;D=e.agh&&e.printh?function(t){printh(agh.Text.Escape(t,"html"))}:e.process&&e.process.stdout?function(t){process.stdout.write(t)}:e.console&&e.console.log?function(t){console.log(t)}:function(t){document.write(t)},t.printf=function(){var t=A.apply(this,arguments);return D(t[1]),t[0]}}(this)},18:(t,e,n)=>{"use strict";var r=n(178);t.exports=function(t,e,n){var i=[],o=!1,s=!1;function a(){if(o)throw new Error("Nested m.redraw.sync() call");o=!0;for(var e=0;e<i.length;e+=2)try{t(i[e],r(i[e+1]),u)}catch(t){n.error(t)}o=!1}function u(){s||(s=!0,e((function(){s=!1,a()})))}return u.sync=a,{mount:function(e,n){if(null!=n&&null==n.view&&"function"!=typeof n)throw new TypeError("m.mount(element, component) expects a component, not a vnode");var o=i.indexOf(e);o>=0&&(i.splice(o,2),t(e,[],u)),null!=n&&(i.push(e,n),t(e,r(n),u))},redraw:u}}},223:(t,e,n)=>{"use strict";var r=n(178),i=n(373),o=n(164),s=n(249),a=n(561),u=n(562),c=n(127),l={};t.exports=function(t,e){var n;function h(e,r,i){if(e=s(e,r),null!=n){n();var o=i?i.state:null,a=i?i.title:null;i&&i.replace?t.history.replaceState(o,a,m.prefix+e):t.history.pushState(o,a,m.prefix+e)}else t.location.href=m.prefix+e}var f,p,d,g,v=l,y=m.SKIP={};function m(i,s,b){if(null==i)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var w,E=0,I=Object.keys(b).map((function(t){if("/"!==t[0])throw new SyntaxError("Routes must start with a `/`");if(/:([^\/\.-]+)(\.{3})?:/.test(t))throw new SyntaxError("Route parameter names must be separated with either `/`, `.`, or `-`");return{route:t,component:b[t],check:u(t)}})),_="function"==typeof setImmediate?setImmediate:setTimeout,S=o.resolve(),T=!1;if(n=null,null!=s){var k=a(s);if(!I.some((function(t){return t.check(k)})))throw new ReferenceError("Default route doesn't match any known routes")}function x(){T=!1;var n=t.location.hash;"#"!==m.prefix[0]&&(n=t.location.search+n,"?"!==m.prefix[0]&&"/"!==(n=t.location.pathname+n)[0]&&(n="/"+n));var r=n.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent).slice(m.prefix.length),i=a(r);function o(){if(r===s)throw new Error("Could not resolve default route "+s);h(s,null,{replace:!0})}c(i.params,t.history.state),function t(n){for(;n<I.length;n++)if(I[n].check(i)){var s=I[n].component,a=I[n].route,u=s,c=g=function(o){if(c===g){if(o===y)return t(n+1);f=null==o||"function"!=typeof o.view&&"function"!=typeof o?"div":o,p=i.params,d=r,g=null,v=s.render?s:null,2===E?e.redraw():(E=2,e.redraw.sync())}};return void(s.view||"function"==typeof s?(s={},c(u)):s.onmatch?S.then((function(){return s.onmatch(i.params,r,a)})).then(c,o):c("div"))}o()}(0)}return n=function(){T||(T=!0,_(x))},"function"==typeof t.history.pushState?(w=function(){t.removeEventListener("popstate",n,!1)},t.addEventListener("popstate",n,!1)):"#"===m.prefix[0]&&(n=null,w=function(){t.removeEventListener("hashchange",x,!1)},t.addEventListener("hashchange",x,!1)),e.mount(i,{onbeforeupdate:function(){return!(!(E=E?2:1)||l===v)},oncreate:x,onremove:w,view:function(){if(E&&l!==v){var t=[r(f,p.key,p)];return v&&(t=v.render(t[0])),t}}})}return m.set=function(t,e,n){null!=g&&((n=n||{}).replace=!0),g=null,h(t,e,n)},m.get=function(){return d},m.prefix="#!",m.Link={view:function(t){var e,n,r=t.attrs.options,o={};c(o,t.attrs),o.selector=o.options=o.key=o.oninit=o.oncreate=o.onbeforeupdate=o.onupdate=o.onbeforeremove=o.onremove=null;var s=i(t.attrs.selector||"a",o,t.children);return(s.attrs.disabled=Boolean(s.attrs.disabled))?(s.attrs.href=null,s.attrs["aria-disabled"]="true",s.attrs.onclick=null):(e=s.attrs.onclick,n=s.attrs.href,s.attrs.href=m.prefix+n,s.attrs.onclick=function(t){var i;"function"==typeof e?i=e.call(t.currentTarget,t):null==e||"object"!=typeof e||"function"==typeof e.handleEvent&&e.handleEvent(t),!1===i||t.defaultPrevented||0!==t.button&&0!==t.which&&1!==t.which||t.currentTarget.target&&"_self"!==t.currentTarget.target||t.ctrlKey||t.metaKey||t.shiftKey||t.altKey||(t.preventDefault(),t.redraw=!1,m.set(n,null,r))}),s}},m.param=function(t){return p&&null!=t?p[t]:p},m}},262:(t,e,n)=>{"use strict";var r=n(373);r.trust=n(742),r.fragment=n(621),t.exports=r},865:(t,e,n)=>{"use strict";var r=n(262),i=n(74),o=n(165),s=function(){return r.apply(this,arguments)};s.m=r,s.trust=r.trust,s.fragment=r.fragment,s.mount=o.mount,s.route=n(843),s.render=n(358),s.redraw=o.redraw,s.request=i.request,s.jsonp=i.jsonp,s.parseQueryString=n(874),s.buildQueryString=n(478),s.parsePathname=n(561),s.buildPathname=n(249),s.vnode=n(178),s.PromisePolyfill=n(803),t.exports=s},165:(t,e,n)=>{"use strict";var r=n(358);t.exports=n(18)(r,requestAnimationFrame,console)},127:t=>{"use strict";t.exports=Object.assign||function(t,e){e&&Object.keys(e).forEach((function(n){t[n]=e[n]}))}},249:(t,e,n)=>{"use strict";var r=n(478),i=n(127);t.exports=function(t,e){if(/:([^\/\.-]+)(\.{3})?:/.test(t))throw new SyntaxError("Template parameter names *must* be separated");if(null==e)return t;var n=t.indexOf("?"),o=t.indexOf("#"),s=o<0?t.length:o,a=n<0?s:n,u=t.slice(0,a),c={};i(c,e);var l=u.replace(/:([^\/\.-]+)(\.{3})?/g,(function(t,n,r){return delete c[n],null==e[n]?t:r?e[n]:encodeURIComponent(String(e[n]))})),h=l.indexOf("?"),f=l.indexOf("#"),p=f<0?l.length:f,d=h<0?p:h,g=l.slice(0,d);n>=0&&(g+=t.slice(n,s)),h>=0&&(g+=(n<0?"?":"&")+l.slice(h,p));var v=r(c);return v&&(g+=(n<0&&h<0?"?":"&")+v),o>=0&&(g+=t.slice(o)),f>=0&&(g+=(o<0?"":"&")+l.slice(f)),g}},562:(t,e,n)=>{"use strict";var r=n(561);t.exports=function(t){var e=r(t),n=Object.keys(e.params),i=[],o=new RegExp("^"+e.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,(function(t,e,n){return null==e?"\\"+t:(i.push({k:e,r:"..."===n}),"..."===n?"(.*)":"."===n?"([^/]+)\\.":"([^/]+)"+(n||""))}))+"$");return function(t){for(var r=0;r<n.length;r++)if(e.params[n[r]]!==t.params[n[r]])return!1;if(!i.length)return o.test(t.path);var s=o.exec(t.path);if(null==s)return!1;for(r=0;r<i.length;r++)t.params[i[r].k]=i[r].r?s[r+1]:decodeURIComponent(s[r+1]);return!0}}},561:(t,e,n)=>{"use strict";var r=n(874);t.exports=function(t){var e=t.indexOf("?"),n=t.indexOf("#"),i=n<0?t.length:n,o=e<0?i:e,s=t.slice(0,o).replace(/\/{2,}/g,"/");return s?("/"!==s[0]&&(s="/"+s),s.length>1&&"/"===s[s.length-1]&&(s=s.slice(0,-1))):s="/",{path:s,params:e<0?{}:r(t.slice(e+1,i))}}},803:t=>{"use strict";var e=function(t){if(!(this instanceof e))throw new Error("Promise must be called with `new`");if("function"!=typeof t)throw new TypeError("executor must be a function");var n=this,r=[],i=[],o=c(r,!0),s=c(i,!1),a=n._instance={resolvers:r,rejectors:i},u="function"==typeof setImmediate?setImmediate:setTimeout;function c(t,e){return function o(c){var h;try{if(!e||null==c||"object"!=typeof c&&"function"!=typeof c||"function"!=typeof(h=c.then))u((function(){e||0!==t.length||console.error("Possible unhandled promise rejection:",c);for(var n=0;n<t.length;n++)t[n](c);r.length=0,i.length=0,a.state=e,a.retry=function(){o(c)}}));else{if(c===n)throw new TypeError("Promise can't be resolved w/ itself");l(h.bind(c))}}catch(t){s(t)}}}function l(t){var e=0;function n(t){return function(n){e++>0||t(n)}}var r=n(s);try{t(n(o),r)}catch(t){r(t)}}l(t)};e.prototype.then=function(t,n){var r,i,o=this._instance;function s(t,e,n,s){e.push((function(e){if("function"!=typeof t)n(e);else try{r(t(e))}catch(t){i&&i(t)}})),"function"==typeof o.retry&&s===o.state&&o.retry()}var a=new e((function(t,e){r=t,i=e}));return s(t,o.resolvers,r,!0),s(n,o.rejectors,i,!1),a},e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(t){return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))},e.resolve=function(t){return t instanceof e?t:new e((function(e){e(t)}))},e.reject=function(t){return new e((function(e,n){n(t)}))},e.all=function(t){return new e((function(e,n){var r=t.length,i=0,o=[];if(0===t.length)e([]);else for(var s=0;s<t.length;s++)!function(s){function a(t){i++,o[s]=t,i===r&&e(o)}null==t[s]||"object"!=typeof t[s]&&"function"!=typeof t[s]||"function"!=typeof t[s].then?a(t[s]):t[s].then(a,n)}(s)}))},e.race=function(t){return new e((function(e,n){for(var r=0;r<t.length;r++)t[r].then(e,n)}))},t.exports=e},164:(t,e,n)=>{"use strict";var r=n(803);"undefined"!=typeof window?(void 0===window.Promise?window.Promise=r:window.Promise.prototype.finally||(window.Promise.prototype.finally=r.prototype.finally),t.exports=window.Promise):void 0!==n.g?(void 0===n.g.Promise?n.g.Promise=r:n.g.Promise.prototype.finally||(n.g.Promise.prototype.finally=r.prototype.finally),t.exports=n.g.Promise):t.exports=r},478:t=>{"use strict";t.exports=function(t){if("[object Object]"!==Object.prototype.toString.call(t))return"";var e=[];for(var n in t)r(n,t[n]);return e.join("&");function r(t,n){if(Array.isArray(n))for(var i=0;i<n.length;i++)r(t+"["+i+"]",n[i]);else if("[object Object]"===Object.prototype.toString.call(n))for(var i in n)r(t+"["+i+"]",n[i]);else e.push(encodeURIComponent(t)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}}},874:t=>{"use strict";t.exports=function(t){if(""===t||null==t)return{};"?"===t.charAt(0)&&(t=t.slice(1));for(var e=t.split("&"),n={},r={},i=0;i<e.length;i++){var o=e[i].split("="),s=decodeURIComponent(o[0]),a=2===o.length?decodeURIComponent(o[1]):"";"true"===a?a=!0:"false"===a&&(a=!1);var u=s.split(/\]\[?|\[/),c=r;s.indexOf("[")>-1&&u.pop();for(var l=0;l<u.length;l++){var h=u[l],f=u[l+1],p=""==f||!isNaN(parseInt(f,10));if(""===h)null==n[s=u.slice(0,l).join()]&&(n[s]=Array.isArray(c)?c.length:0),h=n[s]++;else if("__proto__"===h)break;if(l===u.length-1)c[h]=a;else{var d=Object.getOwnPropertyDescriptor(c,h);null!=d&&(d=d.value),null==d&&(c[h]=d=p?[]:{}),c=d}}}return r}},358:(t,e,n)=>{"use strict";t.exports=n(452)(window)},621:(t,e,n)=>{"use strict";var r=n(178),i=n(359);t.exports=function(){var t=i.apply(0,arguments);return t.tag="[",t.children=r.normalizeChildren(t.children),t}},373:(t,e,n)=>{"use strict";var r=n(178),i=n(359),o=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,s={},a={}.hasOwnProperty;function u(t){for(var e in t)if(a.call(t,e))return!1;return!0}function c(t){for(var e,n="div",r=[],i={};e=o.exec(t);){var a=e[1],u=e[2];if(""===a&&""!==u)n=u;else if("#"===a)i.id=u;else if("."===a)r.push(u);else if("["===e[3][0]){var c=e[6];c&&(c=c.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===e[4]?r.push(c):i[e[4]]=""===c?c:c||!0}}return r.length>0&&(i.className=r.join(" ")),s[t]={tag:n,attrs:i}}function l(t,e){var n=e.attrs,i=r.normalizeChildren(e.children),o=a.call(n,"class"),s=o?n.class:n.className;if(e.tag=t.tag,e.attrs=null,e.children=void 0,!u(t.attrs)&&!u(n)){var c={};for(var l in n)a.call(n,l)&&(c[l]=n[l]);n=c}for(var l in t.attrs)a.call(t.attrs,l)&&"className"!==l&&!a.call(n,l)&&(n[l]=t.attrs[l]);for(var l in null==s&&null==t.attrs.className||(n.className=null!=s?null!=t.attrs.className?String(t.attrs.className)+" "+String(s):s:null!=t.attrs.className?t.attrs.className:null),o&&(n.class=null),n)if(a.call(n,l)&&"key"!==l){e.attrs=n;break}return Array.isArray(i)&&1===i.length&&null!=i[0]&&"#"===i[0].tag?e.text=i[0].children:e.children=i,e}t.exports=function(t){if(null==t||"string"!=typeof t&&"function"!=typeof t&&"function"!=typeof t.view)throw Error("The selector must be either a string or a component.");var e=i.apply(1,arguments);return"string"==typeof t&&(e.children=r.normalizeChildren(e.children),"["!==t)?l(s[t]||c(t),e):(e.tag=t,e)}},359:(t,e,n)=>{"use strict";var r=n(178);t.exports=function(){var t,e=arguments[this],n=this+1;if(null==e?e={}:("object"!=typeof e||null!=e.tag||Array.isArray(e))&&(e={},n=this),arguments.length===n+1)t=arguments[n],Array.isArray(t)||(t=[t]);else for(t=[];n<arguments.length;)t.push(arguments[n++]);return r("",e.key,e,t)}},452:(t,e,n)=>{"use strict";var r=n(178);t.exports=function(t){var e,n=t&&t.document,i={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function o(t){return t.attrs&&t.attrs.xmlns||i[t.tag]}function s(t,e){if(t.state!==e)throw new Error("`vnode.state` must not be modified")}function a(t){var e=t.state;try{return this.apply(e,arguments)}finally{s(t,e)}}function u(){try{return n.activeElement}catch(t){return null}}function c(t,e,n,r,i,o,s){for(var a=n;a<r;a++){var u=e[a];null!=u&&l(t,u,i,s,o)}}function l(t,e,i,s,u){var h=e.tag;if("string"==typeof h)switch(e.state={},null!=e.attrs&&F(e.attrs,e,i),h){case"#":!function(t,e,r){e.dom=n.createTextNode(e.children),w(t,e.dom,r)}(t,e,u);break;case"<":f(t,e,s,u);break;case"[":!function(t,e,r,i,o){var s=n.createDocumentFragment();if(null!=e.children){var a=e.children;c(s,a,0,a.length,r,null,i)}e.dom=s.firstChild,e.domSize=s.childNodes.length,w(t,s,o)}(t,e,i,s,u);break;default:!function(t,e,i,s,a){var u=e.tag,l=e.attrs,h=l&&l.is,f=(s=o(e)||s)?h?n.createElementNS(s,u,{is:h}):n.createElementNS(s,u):h?n.createElement(u,{is:h}):n.createElement(u);if(e.dom=f,null!=l&&function(t,e,n){for(var r in e)x(t,r,null,e[r],n)}(e,l,s),w(t,f,a),!E(e)&&(null!=e.text&&(""!==e.text?f.textContent=e.text:e.children=[r("#",void 0,void 0,e.text,void 0,void 0)]),null!=e.children)){var p=e.children;c(f,p,0,p.length,i,null,s),"select"===e.tag&&null!=l&&function(t,e){if("value"in e)if(null===e.value)-1!==t.dom.selectedIndex&&(t.dom.value=null);else{var n=""+e.value;t.dom.value===n&&-1!==t.dom.selectedIndex||(t.dom.value=n)}"selectedIndex"in e&&x(t,"selectedIndex",null,e.selectedIndex,void 0)}(e,l)}}(t,e,i,s,u)}else!function(t,e,n,i,o){(function(t,e){var n;if("function"==typeof t.tag.view){if(t.state=Object.create(t.tag),null!=(n=t.state.view).$$reentrantLock$$)return;n.$$reentrantLock$$=!0}else{if(t.state=void 0,null!=(n=t.tag).$$reentrantLock$$)return;n.$$reentrantLock$$=!0,t.state=null!=t.tag.prototype&&"function"==typeof t.tag.prototype.view?new t.tag(t):t.tag(t)}if(F(t.state,t,e),null!=t.attrs&&F(t.attrs,t,e),t.instance=r.normalize(a.call(t.state.view,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");n.$$reentrantLock$$=null})(e,n),null!=e.instance?(l(t,e.instance,n,i,o),e.dom=e.instance.dom,e.domSize=null!=e.dom?e.instance.domSize:0):e.domSize=0}(t,e,i,s,u)}var h={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function f(t,e,r,i){var o=e.children.match(/^\s*?<(\w+)/im)||[],s=n.createElement(h[o[1]]||"div");"http://www.w3.org/2000/svg"===r?(s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+e.children+"</svg>",s=s.firstChild):s.innerHTML=e.children,e.dom=s.firstChild,e.domSize=s.childNodes.length,e.instance=[];for(var a,u=n.createDocumentFragment();a=s.firstChild;)e.instance.push(a),u.appendChild(a);w(t,u,i)}function p(t,e,n,r,i,o){if(e!==n&&(null!=e||null!=n))if(null==e||0===e.length)c(t,n,0,n.length,r,i,o);else if(null==n||0===n.length)I(t,e,0,e.length);else{var s=null!=e[0]&&null!=e[0].key,a=null!=n[0]&&null!=n[0].key,u=0,h=0;if(!s)for(;h<e.length&&null==e[h];)h++;if(!a)for(;u<n.length&&null==n[u];)u++;if(null===a&&null==s)return;if(s!==a)I(t,e,h,e.length),c(t,n,u,n.length,r,i,o);else if(a){for(var f,p,b,w,E,S=e.length-1,T=n.length-1;S>=h&&T>=u&&(b=e[S],w=n[T],b.key===w.key);)b!==w&&d(t,b,w,r,i,o),null!=w.dom&&(i=w.dom),S--,T--;for(;S>=h&&T>=u&&(f=e[h],p=n[u],f.key===p.key);)h++,u++,f!==p&&d(t,f,p,r,y(e,h,i),o);for(;S>=h&&T>=u&&u!==T&&f.key===w.key&&b.key===p.key;)m(t,b,E=y(e,h,i)),b!==p&&d(t,b,p,r,E,o),++u<=--T&&m(t,f,i),f!==w&&d(t,f,w,r,i,o),null!=w.dom&&(i=w.dom),h++,b=e[--S],w=n[T],f=e[h],p=n[u];for(;S>=h&&T>=u&&b.key===w.key;)b!==w&&d(t,b,w,r,i,o),null!=w.dom&&(i=w.dom),T--,b=e[--S],w=n[T];if(u>T)I(t,e,h,S+1);else if(h>S)c(t,n,u,T+1,r,i,o);else{var k,x,N=i,A=T-u+1,D=new Array(A),C=0,O=0,L=2147483647,R=0;for(O=0;O<A;O++)D[O]=-1;for(O=T;O>=u;O--){null==k&&(k=g(e,h,S+1));var P=k[(w=n[O]).key];null!=P&&(L=P<L?P:-1,D[O-u]=P,b=e[P],e[P]=null,b!==w&&d(t,b,w,r,i,o),null!=w.dom&&(i=w.dom),R++)}if(i=N,R!==S-h+1&&I(t,e,h,S+1),0===R)c(t,n,u,T+1,r,i,o);else if(-1===L)for(C=(x=function(t){var e=[0],n=0,r=0,i=0,o=v.length=t.length;for(i=0;i<o;i++)v[i]=t[i];for(i=0;i<o;++i)if(-1!==t[i]){var s=e[e.length-1];if(t[s]<t[i])v[i]=s,e.push(i);else{for(n=0,r=e.length-1;n<r;){var a=(n>>>1)+(r>>>1)+(n&r&1);t[e[a]]<t[i]?n=a+1:r=a}t[i]<t[e[n]]&&(n>0&&(v[i]=e[n-1]),e[n]=i)}}for(r=e[(n=e.length)-1];n-- >0;)e[n]=r,r=v[r];return v.length=0,e}(D)).length-1,O=T;O>=u;O--)p=n[O],-1===D[O-u]?l(t,p,r,o,i):x[C]===O-u?C--:m(t,p,i),null!=p.dom&&(i=n[O].dom);else for(O=T;O>=u;O--)p=n[O],-1===D[O-u]&&l(t,p,r,o,i),null!=p.dom&&(i=n[O].dom)}}else{var M=e.length<n.length?e.length:n.length;for(u=u<h?u:h;u<M;u++)(f=e[u])===(p=n[u])||null==f&&null==p||(null==f?l(t,p,r,o,y(e,u+1,i)):null==p?_(t,f):d(t,f,p,r,y(e,u+1,i),o));e.length>M&&I(t,e,u,e.length),n.length>M&&c(t,n,u,n.length,r,i,o)}}}function d(t,e,n,i,s,u){var c=e.tag;if(c===n.tag){if(n.state=e.state,n.events=e.events,function(t,e){do{var n;if(null!=t.attrs&&"function"==typeof t.attrs.onbeforeupdate&&void 0!==(n=a.call(t.attrs.onbeforeupdate,t,e))&&!n)break;if("string"!=typeof t.tag&&"function"==typeof t.state.onbeforeupdate&&void 0!==(n=a.call(t.state.onbeforeupdate,t,e))&&!n)break;return!1}while(0);return t.dom=e.dom,t.domSize=e.domSize,t.instance=e.instance,t.attrs=e.attrs,t.children=e.children,t.text=e.text,!0}(n,e))return;if("string"==typeof c)switch(null!=n.attrs&&U(n.attrs,n,i),c){case"#":!function(t,e){t.children.toString()!==e.children.toString()&&(t.dom.nodeValue=e.children),e.dom=t.dom}(e,n);break;case"<":!function(t,e,n,r,i){e.children!==n.children?(S(t,e),f(t,n,r,i)):(n.dom=e.dom,n.domSize=e.domSize,n.instance=e.instance)}(t,e,n,u,s);break;case"[":!function(t,e,n,r,i,o){p(t,e.children,n.children,r,i,o);var s=0,a=n.children;if(n.dom=null,null!=a){for(var u=0;u<a.length;u++){var c=a[u];null!=c&&null!=c.dom&&(null==n.dom&&(n.dom=c.dom),s+=c.domSize||1)}1!==s&&(n.domSize=s)}}(t,e,n,i,s,u);break;default:!function(t,e,n,i){var s=e.dom=t.dom;i=o(e)||i,"textarea"===e.tag&&(null==e.attrs&&(e.attrs={}),null!=e.text&&(e.attrs.value=e.text,e.text=void 0)),function(t,e,n,r){if(null!=n)for(var i in n)x(t,i,e&&e[i],n[i],r);var o;if(null!=e)for(var i in e)null==(o=e[i])||null!=n&&null!=n[i]||N(t,i,o,r)}(e,t.attrs,e.attrs,i),E(e)||(null!=t.text&&null!=e.text&&""!==e.text?t.text.toString()!==e.text.toString()&&(t.dom.firstChild.nodeValue=e.text):(null!=t.text&&(t.children=[r("#",void 0,void 0,t.text,void 0,t.dom.firstChild)]),null!=e.text&&(e.children=[r("#",void 0,void 0,e.text,void 0,void 0)]),p(s,t.children,e.children,n,null,i)))}(e,n,i,u)}else!function(t,e,n,i,o,s){if(n.instance=r.normalize(a.call(n.state.view,n)),n.instance===n)throw Error("A view cannot return the vnode it received as argument");U(n.state,n,i),null!=n.attrs&&U(n.attrs,n,i),null!=n.instance?(null==e.instance?l(t,n.instance,i,s,o):d(t,e.instance,n.instance,i,o,s),n.dom=n.instance.dom,n.domSize=n.instance.domSize):null!=e.instance?(_(t,e.instance),n.dom=void 0,n.domSize=0):(n.dom=e.dom,n.domSize=e.domSize)}(t,e,n,i,s,u)}else _(t,e),l(t,n,i,u,s)}function g(t,e,n){for(var r=Object.create(null);e<n;e++){var i=t[e];if(null!=i){var o=i.key;null!=o&&(r[o]=e)}}return r}var v=[];function y(t,e,n){for(;e<t.length;e++)if(null!=t[e]&&null!=t[e].dom)return t[e].dom;return n}function m(t,e,r){var i=n.createDocumentFragment();b(t,i,e),w(t,i,r)}function b(t,e,n){for(;null!=n.dom&&n.dom.parentNode===t;){if("string"!=typeof n.tag){if(null!=(n=n.instance))continue}else if("<"===n.tag)for(var r=0;r<n.instance.length;r++)e.appendChild(n.instance[r]);else if("["!==n.tag)e.appendChild(n.dom);else if(1===n.children.length){if(null!=(n=n.children[0]))continue}else for(r=0;r<n.children.length;r++){var i=n.children[r];null!=i&&b(t,e,i)}break}}function w(t,e,n){null!=n?t.insertBefore(e,n):t.appendChild(e)}function E(t){if(null==t.attrs||null==t.attrs.contenteditable&&null==t.attrs.contentEditable)return!1;var e=t.children;if(null!=e&&1===e.length&&"<"===e[0].tag){var n=e[0].children;t.dom.innerHTML!==n&&(t.dom.innerHTML=n)}else if(null!=t.text||null!=e&&0!==e.length)throw new Error("Child node of a contenteditable must be trusted");return!0}function I(t,e,n,r){for(var i=n;i<r;i++){var o=e[i];null!=o&&_(t,o)}}function _(t,e){var n,r,i,o=0,u=e.state;if("string"!=typeof e.tag&&"function"==typeof e.state.onbeforeremove&&null!=(i=a.call(e.state.onbeforeremove,e))&&"function"==typeof i.then&&(o=1,n=i),e.attrs&&"function"==typeof e.attrs.onbeforeremove&&null!=(i=a.call(e.attrs.onbeforeremove,e))&&"function"==typeof i.then&&(o|=2,r=i),s(e,u),o){if(null!=n){var c=function(){1&o&&((o&=2)||l())};n.then(c,c)}null!=r&&(c=function(){2&o&&((o&=1)||l())},r.then(c,c))}else k(e),T(t,e);function l(){s(e,u),k(e),T(t,e)}}function S(t,e){for(var n=0;n<e.instance.length;n++)t.removeChild(e.instance[n])}function T(t,e){for(;null!=e.dom&&e.dom.parentNode===t;){if("string"!=typeof e.tag){if(null!=(e=e.instance))continue}else if("<"===e.tag)S(t,e);else{if("["!==e.tag&&(t.removeChild(e.dom),!Array.isArray(e.children)))break;if(1===e.children.length){if(null!=(e=e.children[0]))continue}else for(var n=0;n<e.children.length;n++){var r=e.children[n];null!=r&&T(t,r)}}break}}function k(t){if("string"!=typeof t.tag&&"function"==typeof t.state.onremove&&a.call(t.state.onremove,t),t.attrs&&"function"==typeof t.attrs.onremove&&a.call(t.attrs.onremove,t),"string"!=typeof t.tag)null!=t.instance&&k(t.instance);else{var e=t.children;if(Array.isArray(e))for(var n=0;n<e.length;n++){var r=e[n];null!=r&&k(r)}}}function x(t,e,r,i,o){if("key"!==e&&"is"!==e&&null!=i&&!A(e)&&(r!==i||function(t,e){return"value"===e||"checked"===e||"selectedIndex"===e||"selected"===e&&t.dom===u()||"option"===t.tag&&t.dom.parentNode===n.activeElement}(t,e)||"object"==typeof i)){if("o"===e[0]&&"n"===e[1])return M(t,e,i);if("xlink:"===e.slice(0,6))t.dom.setAttributeNS("http://www.w3.org/1999/xlink",e.slice(6),i);else if("style"===e)R(t.dom,r,i);else if(D(t,e,o)){if("value"===e){if(("input"===t.tag||"textarea"===t.tag)&&t.dom.value===""+i&&t.dom===u())return;if("select"===t.tag&&null!==r&&t.dom.value===""+i)return;if("option"===t.tag&&null!==r&&t.dom.value===""+i)return}"input"===t.tag&&"type"===e?t.dom.setAttribute(e,i):t.dom[e]=i}else"boolean"==typeof i?i?t.dom.setAttribute(e,""):t.dom.removeAttribute(e):t.dom.setAttribute("className"===e?"class":e,i)}}function N(t,e,n,r){if("key"!==e&&"is"!==e&&null!=n&&!A(e))if("o"!==e[0]||"n"!==e[1]||A(e))if("style"===e)R(t.dom,n,null);else if(!D(t,e,r)||"className"===e||"value"===e&&("option"===t.tag||"select"===t.tag&&-1===t.dom.selectedIndex&&t.dom===u())||"input"===t.tag&&"type"===e){var i=e.indexOf(":");-1!==i&&(e=e.slice(i+1)),!1!==n&&t.dom.removeAttribute("className"===e?"class":e)}else t.dom[e]=null;else M(t,e,void 0)}function A(t){return"oninit"===t||"oncreate"===t||"onupdate"===t||"onremove"===t||"onbeforeremove"===t||"onbeforeupdate"===t}function D(t,e,n){return void 0===n&&(t.tag.indexOf("-")>-1||null!=t.attrs&&t.attrs.is||"href"!==e&&"list"!==e&&"form"!==e&&"width"!==e&&"height"!==e)&&e in t.dom}var C=/[A-Z]/g;function O(t){return"-"+t.toLowerCase()}function L(t){return"-"===t[0]&&"-"===t[1]?t:"cssFloat"===t?"float":t.replace(C,O)}function R(t,e,n){if(e===n);else if(null==n)t.style.cssText="";else if("object"!=typeof n)t.style.cssText=n;else if(null==e||"object"!=typeof e)for(var r in t.style.cssText="",n)null!=(i=n[r])&&t.style.setProperty(L(r),String(i));else{for(var r in n){var i;null!=(i=n[r])&&(i=String(i))!==String(e[r])&&t.style.setProperty(L(r),i)}for(var r in e)null!=e[r]&&null==n[r]&&t.style.removeProperty(L(r))}}function P(){this._=e}function M(t,e,n){if(null!=t.events){if(t.events[e]===n)return;null==n||"function"!=typeof n&&"object"!=typeof n?(null!=t.events[e]&&t.dom.removeEventListener(e.slice(2),t.events,!1),t.events[e]=void 0):(null==t.events[e]&&t.dom.addEventListener(e.slice(2),t.events,!1),t.events[e]=n)}else null==n||"function"!=typeof n&&"object"!=typeof n||(t.events=new P,t.dom.addEventListener(e.slice(2),t.events,!1),t.events[e]=n)}function F(t,e,n){"function"==typeof t.oninit&&a.call(t.oninit,e),"function"==typeof t.oncreate&&n.push(a.bind(t.oncreate,e))}function U(t,e,n){"function"==typeof t.onupdate&&n.push(a.bind(t.onupdate,e))}return P.prototype=Object.create(null),P.prototype.handleEvent=function(t){var e,n=this["on"+t.type];"function"==typeof n?e=n.call(t.currentTarget,t):"function"==typeof n.handleEvent&&n.handleEvent(t),this._&&!1!==t.redraw&&(0,this._)(),!1===e&&(t.preventDefault(),t.stopPropagation())},function(t,n,i){if(!t)throw new TypeError("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var o=[],s=u(),a=t.namespaceURI;null==t.vnodes&&(t.textContent=""),n=r.normalizeChildren(Array.isArray(n)?n:[n]);var c=e;try{e="function"==typeof i?i:void 0,p(t,t.vnodes,n,o,null,"http://www.w3.org/1999/xhtml"===a?void 0:a)}finally{e=c}t.vnodes=n,null!=s&&u()!==s&&"function"==typeof s.focus&&s.focus();for(var l=0;l<o.length;l++)o[l]()}}},742:(t,e,n)=>{"use strict";var r=n(178);t.exports=function(t){return null==t&&(t=""),r("<",void 0,void 0,t,void 0,void 0)}},178:t=>{"use strict";function e(t,e,n,r,i,o){return{tag:t,key:e,attrs:n,children:r,text:i,dom:o,domSize:void 0,state:void 0,events:void 0,instance:void 0}}e.normalize=function(t){return Array.isArray(t)?e("[",void 0,void 0,e.normalizeChildren(t),void 0,void 0):null==t||"boolean"==typeof t?null:"object"==typeof t?t:e("#",void 0,void 0,String(t),void 0,void 0)},e.normalizeChildren=function(t){var n=[];if(t.length){for(var r=null!=t[0]&&null!=t[0].key,i=1;i<t.length;i++)if((null!=t[i]&&null!=t[i].key)!==r)throw new TypeError("Vnodes must either always have keys or never have keys!");for(i=0;i<t.length;i++)n[i]=e.normalize(t[i])}return n},t.exports=e},74:(t,e,n)=>{"use strict";var r=n(164),i=n(165);t.exports=n(775)(window,r,i.redraw)},775:(t,e,n)=>{"use strict";var r=n(249);t.exports=function(t,e,n){var i=0;function o(t){return new e(t)}function s(t){return function(i,s){"string"!=typeof i?(s=i,i=i.url):null==s&&(s={});var a=new e((function(e,n){t(r(i,s.params),s,(function(t){if("function"==typeof s.type)if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]=new s.type(t[n]);else t=new s.type(t);e(t)}),n)}));if(!0===s.background)return a;var u=0;function c(){0==--u&&"function"==typeof n&&n()}return function t(e){var n=e.then;return e.constructor=o,e.then=function(){u++;var r=n.apply(e,arguments);return r.then(c,(function(t){if(c(),0===u)throw t})),t(r)},e}(a)}}function a(t,e){for(var n in t.headers)if({}.hasOwnProperty.call(t.headers,n)&&e.test(n))return!0;return!1}return o.prototype=e.prototype,o.__proto__=e,{request:s((function(e,n,r,i){var o,s=null!=n.method?n.method.toUpperCase():"GET",u=n.body,c=!(null!=n.serialize&&n.serialize!==JSON.serialize||u instanceof t.FormData),l=n.responseType||("function"==typeof n.extract?"":"json"),h=new t.XMLHttpRequest,f=!1,p=h,d=h.abort;for(var g in h.abort=function(){f=!0,d.call(this)},h.open(s,e,!1!==n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),c&&null!=u&&!a(n,/^content-type$/i)&&h.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof n.deserialize||a(n,/^accept$/i)||h.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(h.withCredentials=n.withCredentials),n.timeout&&(h.timeout=n.timeout),h.responseType=l,n.headers)({}).hasOwnProperty.call(n.headers,g)&&h.setRequestHeader(g,n.headers[g]);h.onreadystatechange=function(t){if(!f&&4===t.target.readyState)try{var o,s=t.target.status>=200&&t.target.status<300||304===t.target.status||/^file:\/\//i.test(e),a=t.target.response;if("json"===l?t.target.responseType||"function"==typeof n.extract||(a=JSON.parse(t.target.responseText)):l&&"text"!==l||null==a&&(a=t.target.responseText),"function"==typeof n.extract?(a=n.extract(t.target,n),s=!0):"function"==typeof n.deserialize&&(a=n.deserialize(a)),s)r(a);else{try{o=t.target.responseText}catch(t){o=a}var u=new Error(o);u.code=t.target.status,u.response=a,i(u)}}catch(t){i(t)}},"function"==typeof n.config&&(h=n.config(h,n,e)||h)!==p&&(o=h.abort,h.abort=function(){f=!0,o.call(this)}),null==u?h.send():"function"==typeof n.serialize?h.send(n.serialize(u)):u instanceof t.FormData?h.send(u):h.send(JSON.stringify(u))})),jsonp:s((function(e,n,r,o){var s=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+i++,a=t.document.createElement("script");t[s]=function(e){delete t[s],a.parentNode.removeChild(a),r(e)},a.onerror=function(){delete t[s],a.parentNode.removeChild(a),o(new Error("JSONP request failed"))},a.src=e+(e.indexOf("?")<0?"?":"&")+encodeURIComponent(n.callbackKey||"callback")+"="+encodeURIComponent(s),t.document.documentElement.appendChild(a)}))}}},843:(t,e,n)=>{"use strict";var r=n(165);t.exports=n(223)(window,r)}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=n(865),e=n.n(t);const r={WindspeedUnitEnum:{M_PER_SEC:1,KM_PER_HOUR:2,KT:3},validWindspeedUnit:t=>t==WindspeedUnitEnum.M_PER_SEC||t==WindspeedUnitEnum.KM_PER_HOUR||t==WindspeedUnitEnum.KT,conv_m_s_to_kt:t=>1.9438*t,conv_m_s_to_km_h:t=>3600*t/1e3,windspeedUnitText:t=>{switch(t){case r.WindspeedUnitEnum.M_PER_SEC:return"m/s";case r.WindspeedUnitEnum.KM_PER_HOUR:return"km/h";case r.WindspeedUnitEnum.KT:return"kt";default:return""}},AltitudeUnitEnum:{M:1,FT:2},validAltitudeUnit:t=>t==AltitudeUnitEnum.M||t==AltitudeUnitEnum.FT,conv_ft_to_m:t=>.3048*t,altitudeUnitText:t=>{switch(t){case r.AltitudeUnitEnum.M:return"m";case r.AltitudeUnitEnum.FT:return"ft";default:return""}}},i=r,o={TO:1,FROM:2},s=t=>t==DirectionEnum.TO||t==DirectionEnum.FROM,a={TRUE:1,MAG:2},u=t=>t==MagDeclinationEnum.TRUE||t==MagDeclinationEnum.MAG,c="SONDE_VIEW_SETTING",l=new class{constructor(){this.mslUnit=i.AltitudeUnitEnum.M,this.aglUnit=i.AltitudeUnitEnum.M,this.windspeedUnit=i.WindspeedUnitEnum.M_PER_SEC,this.windDirection=o.TO,this.magDeclination=a.MAG,this.load()}save(){window.localStorage&&window.localStorage.setItem(c,JSON.stringify(this))}load(){if(window.localStorage){const t=window.localStorage.getItem(c);if(t&&""!=t){const t=JSON.parse();for(let e in this)this[e]=t[e]?t[e]:this[e]}}}getMslUnit(){return this.mslUnit}setMslUnit(t){i.validAltitudeUnit(t)&&(this.mslUnit=t,this.save())}getAglUnit(){return this.aglUnit}setAglUnit(t){i.validAltitudeUnit(t)&&(this.aglUnit=t,this.save())}getWindspeedUnit(){return this.windspeedUnit}setWindspeedUnit(t){i.validWindspeedUnit(t)&&(this.windspeedUnit=t,this.save())}getWindDirection(){return this.windDirection}setWindDirection(t){s(t)&&(this.windDirection=t,this.save())}getMagDeclination(){return this.magDeclination}setMagDeclination(t){u(t)&&(this.magDeclination=t,this.save())}};var h=n(472),f=n.n(h);function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?Object(arguments[e]):{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){d(t,e,n[e])}))}return t}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e,n){return e&&y(t.prototype,e),n&&y(t,n),t}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(t,e){return!e||"object"!==p(e)&&"function"!=typeof e?b(t):e}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function I(t,e){return(I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}var S={type:"logger",log:function(t){this.output("log",t)},warn:function(t){this.output("warn",t)},error:function(t){this.output("error",t)},output:function(t,e){console&&console[t]&&console[t].apply(console,e)}},T=new(function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(this,t),this.init(e,n)}return m(t,[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||S,this.options=e,this.debug=e.debug}},{key:"setDebug",value:function(t){this.debug=t}},{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"log","",!0)}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","",!0)}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"error","")}},{key:"deprecate",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(t,e,n,r){return r&&!this.debug?null:("string"==typeof t[0]&&(t[0]="".concat(n).concat(this.prefix," ").concat(t[0])),this.logger[e](t))}},{key:"create",value:function(e){return new t(this.logger,g({},{prefix:"".concat(this.prefix,":").concat(e,":")},this.options))}}]),t}()),k=function(){function t(){v(this,t),this.observers={}}return m(t,[{key:"on",value:function(t,e){var n=this;return t.split(" ").forEach((function(t){n.observers[t]=n.observers[t]||[],n.observers[t].push(e)})),this}},{key:"off",value:function(t,e){this.observers[t]&&(e?this.observers[t]=this.observers[t].filter((function(t){return t!==e})):delete this.observers[t])}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if(this.observers[t]){var i=[].concat(this.observers[t]);i.forEach((function(t){t.apply(void 0,n)}))}if(this.observers["*"]){var o=[].concat(this.observers["*"]);o.forEach((function(e){e.apply(e,[t].concat(n))}))}}}]),t}();function x(){var t,e,n=new Promise((function(n,r){t=n,e=r}));return n.resolve=t,n.reject=e,n}function N(t){return null==t?"":""+t}function A(t,e,n){t.forEach((function(t){e[t]&&(n[t]=e[t])}))}function D(t,e,n){function r(t){return t&&t.indexOf("###")>-1?t.replace(/###/g,"."):t}function i(){return!t||"string"==typeof t}for(var o="string"!=typeof e?[].concat(e):e.split(".");o.length>1;){if(i())return{};var s=r(o.shift());!t[s]&&n&&(t[s]=new n),t=Object.prototype.hasOwnProperty.call(t,s)?t[s]:{}}return i()?{}:{obj:t,k:r(o.shift())}}function C(t,e,n){var r=D(t,e,Object);r.obj[r.k]=n}function O(t,e){var n=D(t,e),r=n.obj,i=n.k;if(r)return r[i]}function L(t,e,n){var r=O(t,n);return void 0!==r?r:O(e,n)}function R(t,e,n){for(var r in e)"__proto__"!==r&&"constructor"!==r&&(r in t?"string"==typeof t[r]||t[r]instanceof String||"string"==typeof e[r]||e[r]instanceof String?n&&(t[r]=e[r]):R(t[r],e[r],n):t[r]=e[r]);return t}function P(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var M={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function F(t){return"string"==typeof t?t.replace(/[&<>"'\/]/g,(function(t){return M[t]})):t}var U="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1;function j(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(t){if(t[e])return t[e];for(var r=e.split(n),i=t,o=0;o<r.length;++o){if("string"==typeof i[r[o]]&&o+1<r.length)return;if(void 0===i[r[o]]){for(var s=2,a=r.slice(o,o+s).join(n),u=i[a];void 0===u&&r.length>o+s;)s++,u=i[a=r.slice(o,o+s).join(n)];if(void 0===u)return;if("string"==typeof u)return u;if(a&&"string"==typeof u[a])return u[a];var c=r.slice(o+s).join(n);return c?j(u,c,n):void 0}i=i[r[o]]}return i}}var V=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return v(this,e),n=w(this,E(e).call(this)),U&&k.call(b(n)),n.data=t||{},n.options=r,void 0===n.options.keySeparator&&(n.options.keySeparator="."),void 0===n.options.ignoreJSONStructure&&(n.options.ignoreJSONStructure=!0),n}return _(e,t),m(e,[{key:"addNamespaces",value:function(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}},{key:"removeNamespaces",value:function(t){var e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}},{key:"getResource",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,o=void 0!==r.ignoreJSONStructure?r.ignoreJSONStructure:this.options.ignoreJSONStructure,s=[t,e];n&&"string"!=typeof n&&(s=s.concat(n)),n&&"string"==typeof n&&(s=s.concat(i?n.split(i):n)),t.indexOf(".")>-1&&(s=t.split("."));var a=O(this.data,s);return a||!o||"string"!=typeof n?a:j(this.data&&this.data[t]&&this.data[t][e],n,i)}},{key:"addResource",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},o=this.options.keySeparator;void 0===o&&(o=".");var s=[t,e];n&&(s=s.concat(o?n.split(o):n)),t.indexOf(".")>-1&&(r=e,e=(s=t.split("."))[1]),this.addNamespaces(e),C(this.data,s,r),i.silent||this.emit("added",t,e,n,r)}},{key:"addResources",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var i in n)"string"!=typeof n[i]&&"[object Array]"!==Object.prototype.toString.apply(n[i])||this.addResource(t,e,i,n[i],{silent:!0});r.silent||this.emit("added",t,e,n)}},{key:"addResourceBundle",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},s=[t,e];t.indexOf(".")>-1&&(r=n,n=e,e=(s=t.split("."))[1]),this.addNamespaces(e);var a=O(this.data,s)||{};r?R(a,n,i):a=g({},a,n),C(this.data,s,a),o.silent||this.emit("added",t,e,n)}},{key:"removeResourceBundle",value:function(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}},{key:"hasResourceBundle",value:function(t,e){return void 0!==this.getResource(t,e)}},{key:"getResourceBundle",value:function(t,e){return e||(e=this.options.defaultNS),"v1"===this.options.compatibilityAPI?g({},{},this.getResource(t,e)):this.getResource(t,e)}},{key:"getDataByLanguage",value:function(t){return this.data[t]}},{key:"toJSON",value:function(){return this.data}}]),e}(k),q={processors:{},addPostProcessor:function(t){this.processors[t.name]=t},handle:function(t,e,n,r,i){var o=this;return t.forEach((function(t){o.processors[t]&&(e=o.processors[t].process(e,n,r,i))})),e}},B={},K=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return v(this,e),n=w(this,E(e).call(this)),U&&k.call(b(n)),A(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,b(n)),n.options=r,void 0===n.options.keySeparator&&(n.options.keySeparator="."),n.logger=T.create("translator"),n}return _(e,t),m(e,[{key:"changeLanguage",value:function(t){t&&(this.language=t)}},{key:"exists",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}},n=this.resolve(t,e);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(t,e){var n=void 0!==e.nsSeparator?e.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var r=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,i=e.ns||this.options.defaultNS;if(n&&t.indexOf(n)>-1){var o=t.match(this.interpolator.nestingRegexp);if(o&&o.length>0)return{key:t,namespaces:i};var s=t.split(n);(n!==r||n===r&&this.options.ns.indexOf(s[0])>-1)&&(i=s.shift()),t=s.join(r)}return"string"==typeof i&&(i=[i]),{key:t,namespaces:i}}},{key:"translate",value:function(t,n,r){var i=this;if("object"!==p(n)&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),n||(n={}),null==t)return"";Array.isArray(t)||(t=[String(t)]);var o=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,s=this.extractFromKey(t[t.length-1],n),a=s.key,u=s.namespaces,c=u[u.length-1],l=n.lng||this.language,h=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(l&&"cimode"===l.toLowerCase()){if(h){var f=n.nsSeparator||this.options.nsSeparator;return c+f+a}return a}var d=this.resolve(t,n),v=d&&d.res,y=d&&d.usedKey||a,m=d&&d.exactUsedKey||a,b=Object.prototype.toString.apply(v),w=["[object Number]","[object Function]","[object RegExp]"],E=void 0!==n.joinArrays?n.joinArrays:this.options.joinArrays,I=!this.i18nFormat||this.i18nFormat.handleAsObject,_="string"!=typeof v&&"boolean"!=typeof v&&"number"!=typeof v;if(I&&v&&_&&w.indexOf(b)<0&&("string"!=typeof E||"[object Array]"!==b)){if(!n.returnObjects&&!this.options.returnObjects)return this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(y,v,n):"key '".concat(a," (").concat(this.language,")' returned an object instead of string.");if(o){var S="[object Array]"===b,T=S?[]:{},k=S?m:y;for(var x in v)if(Object.prototype.hasOwnProperty.call(v,x)){var N="".concat(k).concat(o).concat(x);T[x]=this.translate(N,g({},n,{joinArrays:!1,ns:u})),T[x]===N&&(T[x]=v[x])}v=T}}else if(I&&"string"==typeof E&&"[object Array]"===b)(v=v.join(E))&&(v=this.extendTranslation(v,t,n,r));else{var A=!1,D=!1,C=void 0!==n.count&&"string"!=typeof n.count,O=e.hasDefaultValue(n),L=C?this.pluralResolver.getSuffix(l,n.count):"",R=n["defaultValue".concat(L)]||n.defaultValue;!this.isValidLookup(v)&&O&&(A=!0,v=R),this.isValidLookup(v)||(D=!0,v=a);var P=O&&R!==v&&this.options.updateMissing;if(D||A||P){if(this.logger.log(P?"updateKey":"missingKey",l,c,a,P?R:v),o){var M=this.resolve(a,g({},n,{keySeparator:!1}));M&&M.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var F=[],U=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&U&&U[0])for(var j=0;j<U.length;j++)F.push(U[j]);else"all"===this.options.saveMissingTo?F=this.languageUtils.toResolveHierarchy(n.lng||this.language):F.push(n.lng||this.language);var V=function(t,e,r){i.options.missingKeyHandler?i.options.missingKeyHandler(t,c,e,P?r:v,P,n):i.backendConnector&&i.backendConnector.saveMissing&&i.backendConnector.saveMissing(t,c,e,P?r:v,P,n),i.emit("missingKey",t,c,e,v)};this.options.saveMissing&&(this.options.saveMissingPlurals&&C?F.forEach((function(t){i.pluralResolver.getSuffixes(t).forEach((function(e){V([t],a+e,n["defaultValue".concat(e)]||R)}))})):V(F,a,R))}v=this.extendTranslation(v,t,n,d,r),D&&v===a&&this.options.appendNamespaceToMissingKey&&(v="".concat(c,":").concat(a)),D&&this.options.parseMissingKeyHandler&&(v=this.options.parseMissingKeyHandler(v))}return v}},{key:"extendTranslation",value:function(t,e,n,r,i){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,n,r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(g({},n,{interpolation:g({},this.options.interpolation,n.interpolation)}));var s,a=n.interpolation&&n.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;if(a){var u=t.match(this.interpolator.nestingRegexp);s=u&&u.length}var c=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(c=g({},this.options.interpolation.defaultVariables,c)),t=this.interpolator.interpolate(t,c,n.lng||this.language,n),a){var l=t.match(this.interpolator.nestingRegexp);s<(l&&l.length)&&(n.nest=!1)}!1!==n.nest&&(t=this.interpolator.nest(t,(function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return i&&i[0]===r[0]&&!n.context?(o.logger.warn("It seems you are nesting recursively key: ".concat(r[0]," in key: ").concat(e[0])),null):o.translate.apply(o,r.concat([e]))}),n)),n.interpolation&&this.interpolator.reset()}var h=n.postProcess||this.options.postProcess,f="string"==typeof h?[h]:h;return null!=t&&f&&f.length&&!1!==n.applyPostProcessor&&(t=q.handle(f,t,e,this.options&&this.options.postProcessPassResolved?g({i18nResolved:r},n):n,this)),t}},{key:"resolve",value:function(t){var e,n,r,i,o,s=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof t&&(t=[t]),t.forEach((function(t){if(!s.isValidLookup(e)){var u=s.extractFromKey(t,a),c=u.key;n=c;var l=u.namespaces;s.options.fallbackNS&&(l=l.concat(s.options.fallbackNS));var h=void 0!==a.count&&"string"!=typeof a.count,f=void 0!==a.context&&"string"==typeof a.context&&""!==a.context,p=a.lngs?a.lngs:s.languageUtils.toResolveHierarchy(a.lng||s.language,a.fallbackLng);l.forEach((function(t){s.isValidLookup(e)||(o=t,!B["".concat(p[0],"-").concat(t)]&&s.utils&&s.utils.hasLoadedNamespace&&!s.utils.hasLoadedNamespace(o)&&(B["".concat(p[0],"-").concat(t)]=!0,s.logger.warn('key "'.concat(n,'" for languages "').concat(p.join(", "),'" won\'t get resolved as namespace "').concat(o,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach((function(n){if(!s.isValidLookup(e)){i=n;var o,u,l=c,p=[l];for(s.i18nFormat&&s.i18nFormat.addLookupKeys?s.i18nFormat.addLookupKeys(p,c,n,t,a):(h&&(o=s.pluralResolver.getSuffix(n,a.count)),h&&f&&p.push(l+o),f&&p.push(l+="".concat(s.options.contextSeparator).concat(a.context)),h&&p.push(l+=o));u=p.pop();)s.isValidLookup(e)||(r=u,e=s.getResource(n,t,u,a))}})))}))}})),{res:e,usedKey:n,exactUsedKey:r,usedLng:i,usedNS:o}}},{key:"isValidLookup",value:function(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}},{key:"getResource",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,e,n,r):this.resourceStore.getResource(t,e,n,r)}}],[{key:"hasDefaultValue",value:function(t){var e="defaultValue";for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e===n.substring(0,e.length)&&void 0!==t[n])return!0;return!1}}]),e}(k);function z(t){return t.charAt(0).toUpperCase()+t.slice(1)}var G=function(){function t(e){v(this,t),this.options=e,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=T.create("languageUtils")}return m(t,[{key:"getScriptPartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return null;var e=t.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase()?null:this.formatLanguageCode(e.join("-")))}},{key:"getLanguagePartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return t;var e=t.split("-");return this.formatLanguageCode(e[0])}},{key:"formatLanguageCode",value:function(t){if("string"==typeof t&&t.indexOf("-")>-1){var e=["hans","hant","latn","cyrl","cans","mong","arab"],n=t.split("-");return this.options.lowerCaseLng?n=n.map((function(t){return t.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),e.indexOf(n[1].toLowerCase())>-1&&(n[1]=z(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),e.indexOf(n[1].toLowerCase())>-1&&(n[1]=z(n[1].toLowerCase())),e.indexOf(n[2].toLowerCase())>-1&&(n[2]=z(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}},{key:"isWhitelisted",value:function(t){return this.logger.deprecate("languageUtils.isWhitelisted",'function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it\'s usage asap.'),this.isSupportedCode(t)}},{key:"isSupportedCode",value:function(t){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}},{key:"getBestMatchFromCodes",value:function(t){var e,n=this;return t?(t.forEach((function(t){if(!e){var r=n.formatLanguageCode(t);n.options.supportedLngs&&!n.isSupportedCode(r)||(e=r)}})),!e&&this.options.supportedLngs&&t.forEach((function(t){if(!e){var r=n.getLanguagePartFromCode(t);if(n.isSupportedCode(r))return e=r;e=n.options.supportedLngs.find((function(t){if(0===t.indexOf(r))return t}))}})),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e):null}},{key:"getFallbackCodes",value:function(t,e){if(!t)return[];if("function"==typeof t&&(t=t(e)),"string"==typeof t&&(t=[t]),"[object Array]"===Object.prototype.toString.apply(t))return t;if(!e)return t.default||[];var n=t[e];return n||(n=t[this.getScriptPartFromCode(e)]),n||(n=t[this.formatLanguageCode(e)]),n||(n=t[this.getLanguagePartFromCode(e)]),n||(n=t.default),n||[]}},{key:"toResolveHierarchy",value:function(t,e){var n=this,r=this.getFallbackCodes(e||this.options.fallbackLng||[],t),i=[],o=function(t){t&&(n.isSupportedCode(t)?i.push(t):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(t)))};return"string"==typeof t&&t.indexOf("-")>-1?("languageOnly"!==this.options.load&&o(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&o(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&o(this.getLanguagePartFromCode(t))):"string"==typeof t&&o(this.formatLanguageCode(t)),r.forEach((function(t){i.indexOf(t)<0&&o(n.formatLanguageCode(t))})),i}}]),t}(),H=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],W={1:function(t){return Number(t>1)},2:function(t){return Number(1!=t)},3:function(t){return 0},4:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},5:function(t){return Number(0==t?0:1==t?1:2==t?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5)},6:function(t){return Number(1==t?0:t>=2&&t<=4?1:2)},7:function(t){return Number(1==t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},8:function(t){return Number(1==t?0:2==t?1:8!=t&&11!=t?2:3)},9:function(t){return Number(t>=2)},10:function(t){return Number(1==t?0:2==t?1:t<7?2:t<11?3:4)},11:function(t){return Number(1==t||11==t?0:2==t||12==t?1:t>2&&t<20?2:3)},12:function(t){return Number(t%10!=1||t%100==11)},13:function(t){return Number(0!==t)},14:function(t){return Number(1==t?0:2==t?1:3==t?2:3)},15:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2)},16:function(t){return Number(t%10==1&&t%100!=11?0:0!==t?1:2)},17:function(t){return Number(1==t||t%10==1&&t%100!=11?0:1)},18:function(t){return Number(0==t?0:1==t?1:2)},19:function(t){return Number(1==t?0:0==t||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3)},20:function(t){return Number(1==t?0:0==t||t%100>0&&t%100<20?1:2)},21:function(t){return Number(t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0)},22:function(t){return Number(1==t?0:2==t?1:(t<0||t>10)&&t%10==0?2:3)}};function Q(){var t={};return H.forEach((function(e){e.lngs.forEach((function(n){t[n]={numbers:e.nr,plurals:W[e.fc]}}))})),t}var $=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(this,t),this.languageUtils=e,this.options=n,this.logger=T.create("pluralResolver"),this.rules=Q()}return m(t,[{key:"addRule",value:function(t,e){this.rules[t]=e}},{key:"getRule",value:function(t){return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}},{key:"needsPlural",value:function(t){var e=this.getRule(t);return e&&e.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(t,e){return this.getSuffixes(t).map((function(t){return e+t}))}},{key:"getSuffixes",value:function(t){var e=this,n=this.getRule(t);return n?n.numbers.map((function(n){return e.getSuffix(t,n)})):[]}},{key:"getSuffix",value:function(t,e){var n=this,r=this.getRule(t);if(r){var i=r.noAbs?r.plurals(e):r.plurals(Math.abs(e)),o=r.numbers[i];this.options.simplifyPluralSuffix&&2===r.numbers.length&&1===r.numbers[0]&&(2===o?o="plural":1===o&&(o=""));var s=function(){return n.options.prepend&&o.toString()?n.options.prepend+o.toString():o.toString()};return"v1"===this.options.compatibilityJSON?1===o?"":"number"==typeof o?"_plural_".concat(o.toString()):s():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===r.numbers.length&&1===r.numbers[0]?s():this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}return this.logger.warn("no plural rule found for: ".concat(t)),""}}]),t}(),Y=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,t),this.logger=T.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||function(t){return t},this.init(e)}return m(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});var e=t.interpolation;this.escape=void 0!==e.escape?e.escape:F,this.escapeValue=void 0===e.escapeValue||e.escapeValue,this.useRawValueToEscape=void 0!==e.useRawValueToEscape&&e.useRawValueToEscape,this.prefix=e.prefix?P(e.prefix):e.prefixEscaped||"{{",this.suffix=e.suffix?P(e.suffix):e.suffixEscaped||"}}",this.formatSeparator=e.formatSeparator?e.formatSeparator:e.formatSeparator||",",this.unescapePrefix=e.unescapeSuffix?"":e.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":e.unescapeSuffix||"",this.nestingPrefix=e.nestingPrefix?P(e.nestingPrefix):e.nestingPrefixEscaped||P("$t("),this.nestingSuffix=e.nestingSuffix?P(e.nestingSuffix):e.nestingSuffixEscaped||P(")"),this.nestingOptionsSeparator=e.nestingOptionsSeparator?e.nestingOptionsSeparator:e.nestingOptionsSeparator||",",this.maxReplaces=e.maxReplaces?e.maxReplaces:1e3,this.alwaysFormat=void 0!==e.alwaysFormat&&e.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var t="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(t,"g");var e="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(e,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(t,e,n,r){var i,o,s,a=this,u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function c(t){return t.replace(/\$/g,"$$$$")}var l=function(t){if(t.indexOf(a.formatSeparator)<0){var i=L(e,u,t);return a.alwaysFormat?a.format(i,void 0,n,g({},r,e,{interpolationkey:t})):i}var o=t.split(a.formatSeparator),s=o.shift().trim(),c=o.join(a.formatSeparator).trim();return a.format(L(e,u,s),c,n,g({},r,e,{interpolationkey:s}))};this.resetRegExp();var h=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,f=r&&r.interpolation&&r.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(t){return c(t)}},{regex:this.regexp,safeValue:function(t){return a.escapeValue?c(a.escape(t)):c(t)}}].forEach((function(e){for(s=0;i=e.regex.exec(t);){if(void 0===(o=l(i[1].trim())))if("function"==typeof h){var n=h(t,i,r);o="string"==typeof n?n:""}else{if(f){o=i[0];continue}a.logger.warn("missed to pass in variable ".concat(i[1]," for interpolating ").concat(t)),o=""}else"string"==typeof o||a.useRawValueToEscape||(o=N(o));if(t=t.replace(i[0],e.safeValue(o)),e.regex.lastIndex=0,++s>=a.maxReplaces)break}})),t}},{key:"nest",value:function(t,e){var n,r,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=g({},o);function a(t,e){var n=this.nestingOptionsSeparator;if(t.indexOf(n)<0)return t;var r=t.split(new RegExp("".concat(n,"[ ]*{"))),i="{".concat(r[1]);t=r[0],i=(i=this.interpolate(i,s)).replace(/'/g,'"');try{s=JSON.parse(i),e&&(s=g({},e,s))}catch(e){return this.logger.warn("failed parsing options string in nesting for key ".concat(t),e),"".concat(t).concat(n).concat(i)}return delete s.defaultValue,t}for(s.applyPostProcessor=!1,delete s.defaultValue;n=this.nestingRegexp.exec(t);){var u=[],c=!1;if(n[0].includes(this.formatSeparator)&&!/{.*}/.test(n[1])){var l=n[1].split(this.formatSeparator).map((function(t){return t.trim()}));n[1]=l.shift(),u=l,c=!0}if((r=e(a.call(this,n[1].trim(),s),s))&&n[0]===t&&"string"!=typeof r)return r;"string"!=typeof r&&(r=N(r)),r||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(t)),r=""),c&&(r=u.reduce((function(t,e){return i.format(t,e,o.lng,g({},o,{interpolationkey:n[1].trim()}))}),r.trim())),t=t.replace(n[0],r),this.regexp.lastIndex=0}return t}}]),t}(),J=function(t){function e(t,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return v(this,e),i=w(this,E(e).call(this)),U&&k.call(b(i)),i.backend=t,i.store=n,i.services=r,i.languageUtils=r.languageUtils,i.options=o,i.logger=T.create("backendConnector"),i.state={},i.queue=[],i.backend&&i.backend.init&&i.backend.init(r,o.backend,o),i}return _(e,t),m(e,[{key:"queueLoad",value:function(t,e,n,r){var i=this,o=[],s=[],a=[],u=[];return t.forEach((function(t){var r=!0;e.forEach((function(e){var a="".concat(t,"|").concat(e);!n.reload&&i.store.hasResourceBundle(t,e)?i.state[a]=2:i.state[a]<0||(1===i.state[a]?s.indexOf(a)<0&&s.push(a):(i.state[a]=1,r=!1,s.indexOf(a)<0&&s.push(a),o.indexOf(a)<0&&o.push(a),u.indexOf(e)<0&&u.push(e)))})),r||a.push(t)})),(o.length||s.length)&&this.queue.push({pending:s,loaded:{},errors:[],callback:r}),{toLoad:o,pending:s,toLoadLanguages:a,toLoadNamespaces:u}}},{key:"loaded",value:function(t,e,n){var r=t.split("|"),i=r[0],o=r[1];e&&this.emit("failedLoading",i,o,e),n&&this.store.addResourceBundle(i,o,n),this.state[t]=e?-1:2;var s={};this.queue.forEach((function(n){!function(t,e,n,r){var i=D(t,e,Object),o=i.obj,s=i.k;o[s]=o[s]||[],o[s].push(n)}(n.loaded,[i],o),function(t,e){for(var n=t.indexOf(e);-1!==n;)t.splice(n,1),n=t.indexOf(e)}(n.pending,t),e&&n.errors.push(e),0!==n.pending.length||n.done||(Object.keys(n.loaded).forEach((function(t){s[t]||(s[t]=[]),n.loaded[t].length&&n.loaded[t].forEach((function(e){s[t].indexOf(e)<0&&s[t].push(e)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",s),this.queue=this.queue.filter((function(t){return!t.done}))}},{key:"read",value:function(t,e,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:350,s=arguments.length>5?arguments[5]:void 0;return t.length?this.backend[n](t,e,(function(a,u){a&&u&&i<5?setTimeout((function(){r.read.call(r,t,e,n,i+1,2*o,s)}),o):s(a,u)})):s(null,{})}},{key:"prepareLoading",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();"string"==typeof t&&(t=this.languageUtils.toResolveHierarchy(t)),"string"==typeof e&&(e=[e]);var o=this.queueLoad(t,e,r,i);if(!o.toLoad.length)return o.pending.length||i(),null;o.toLoad.forEach((function(t){n.loadOne(t)}))}},{key:"load",value:function(t,e,n){this.prepareLoading(t,e,{},n)}},{key:"reload",value:function(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}},{key:"loadOne",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=t.split("|"),i=r[0],o=r[1];this.read(i,o,"read",void 0,void 0,(function(r,s){r&&e.logger.warn("".concat(n,"loading namespace ").concat(o," for language ").concat(i," failed"),r),!r&&s&&e.logger.log("".concat(n,"loaded namespace ").concat(o," for language ").concat(i),s),e.loaded(t,r,s)}))}},{key:"saveMissing",value:function(t,e,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(e,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(t,e,n,r,null,g({},o,{isUpdate:i})),t&&t[0]&&this.store.addResource(t[0],e,n,r))}}]),e}(k);function X(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){var e={};if("object"===p(t[1])&&(e=t[1]),"string"==typeof t[1]&&(e.defaultValue=t[1]),"string"==typeof t[2]&&(e.tDescription=t[2]),"object"===p(t[2])||"object"===p(t[3])){var n=t[3]||t[2];Object.keys(n).forEach((function(t){e[t]=n[t]}))}return e},interpolation:{escapeValue:!0,format:function(t,e,n,r){return t},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}}}function Z(t){return"string"==typeof t.ns&&(t.ns=[t.ns]),"string"==typeof t.fallbackLng&&(t.fallbackLng=[t.fallbackLng]),"string"==typeof t.fallbackNS&&(t.fallbackNS=[t.fallbackNS]),t.whitelist&&(t.whitelist&&t.whitelist.indexOf("cimode")<0&&(t.whitelist=t.whitelist.concat(["cimode"])),t.supportedLngs=t.whitelist),t.nonExplicitWhitelist&&(t.nonExplicitSupportedLngs=t.nonExplicitWhitelist),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function tt(){}const et=new(function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(v(this,e),t=w(this,E(e).call(this)),U&&k.call(b(t)),t.options=Z(n),t.services={},t.logger=T,t.modules={external:[]},r&&!t.isInitialized&&!n.isClone){if(!t.options.initImmediate)return t.init(n,r),w(t,b(t));setTimeout((function(){t.init(n,r)}),0)}return t}return _(e,t),m(e,[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;function r(t){return t?"function"==typeof t?new t:t:null}if("function"==typeof e&&(n=e,e={}),e.whitelist&&!e.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),e.nonExplicitWhitelist&&!e.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=g({},X(),this.options,Z(e)),this.format=this.options.interpolation.format,n||(n=tt),!this.options.isClone){this.modules.logger?T.init(r(this.modules.logger),this.options):T.init(null,this.options);var i=new G(this.options);this.store=new V(this.options.resources,this.options);var o=this.services;o.logger=T,o.resourceStore=this.store,o.languageUtils=i,o.pluralResolver=new $(i,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),o.interpolator=new Y(this.options),o.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},o.backendConnector=new J(r(this.modules.backend),o.resourceStore,o,this.options),o.backendConnector.on("*",(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit.apply(t,[e].concat(r))})),this.modules.languageDetector&&(o.languageDetector=r(this.modules.languageDetector),o.languageDetector.init(o,this.options.detection,this.options)),this.modules.i18nFormat&&(o.i18nFormat=r(this.modules.i18nFormat),o.i18nFormat.init&&o.i18nFormat.init(this)),this.translator=new K(this.services,this.options),this.translator.on("*",(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit.apply(t,[e].concat(r))})),this.modules.external.forEach((function(e){e.init&&e.init(t)}))}if(this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var s=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);s.length>0&&"dev"!==s[0]&&(this.options.lng=s[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");var a=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];a.forEach((function(e){t[e]=function(){var n;return(n=t.store)[e].apply(n,arguments)}}));var u=["addResource","addResources","addResourceBundle","removeResourceBundle"];u.forEach((function(e){t[e]=function(){var n;return(n=t.store)[e].apply(n,arguments),t}}));var c=x(),l=function(){var e=function(e,r){t.isInitialized&&t.logger.warn("init: i18next is already initialized. You should call init just once!"),t.isInitialized=!0,t.options.isClone||t.logger.log("initialized",t.options),t.emit("initialized",t.options),c.resolve(r),n(e,r)};if(t.languages&&"v1"!==t.options.compatibilityAPI&&!t.isInitialized)return e(null,t.t.bind(t));t.changeLanguage(t.options.lng,e)};return this.options.resources||!this.options.initImmediate?l():setTimeout(l,0),c}},{key:"loadResources",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tt,r=n,i="string"==typeof t?t:this.language;if("function"==typeof t&&(r=t),!this.options.resources||this.options.partialBundledLanguages){if(i&&"cimode"===i.toLowerCase())return r();var o=[],s=function(t){t&&e.services.languageUtils.toResolveHierarchy(t).forEach((function(t){o.indexOf(t)<0&&o.push(t)}))};if(i)s(i);else{var a=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);a.forEach((function(t){return s(t)}))}this.options.preload&&this.options.preload.forEach((function(t){return s(t)})),this.services.backendConnector.load(o,this.options.ns,r)}else r(null)}},{key:"reloadResources",value:function(t,e,n){var r=x();return t||(t=this.languages),e||(e=this.options.ns),n||(n=tt),this.services.backendConnector.reload(t,e,(function(t){r.resolve(),n(t)})),r}},{key:"use",value:function(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&q.addPostProcessor(t),"3rdParty"===t.type&&this.modules.external.push(t),this}},{key:"changeLanguage",value:function(t,e){var n=this;this.isLanguageChangingTo=t;var r=x();this.emit("languageChanging",t);var i=function(t){var i="string"==typeof t?t:n.services.languageUtils.getBestMatchFromCodes(t);i&&(n.language||(n.language=i,n.languages=n.services.languageUtils.toResolveHierarchy(i)),n.translator.language||n.translator.changeLanguage(i),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(i)),n.loadResources(i,(function(t){!function(t,i){i?(n.language=i,n.languages=n.services.languageUtils.toResolveHierarchy(i),n.translator.changeLanguage(i),n.isLanguageChangingTo=void 0,n.emit("languageChanged",i),n.logger.log("languageChanged",i)):n.isLanguageChangingTo=void 0,r.resolve((function(){return n.t.apply(n,arguments)})),e&&e(t,(function(){return n.t.apply(n,arguments)}))}(t,i)}))};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(i):i(t):i(this.services.languageDetector.detect()),r}},{key:"getFixedT",value:function(t,e){var n=this,r=function t(e,r){var i;if("object"!==p(r)){for(var o=arguments.length,s=new Array(o>2?o-2:0),a=2;a<o;a++)s[a-2]=arguments[a];i=n.options.overloadTranslationOptionHandler([e,r].concat(s))}else i=g({},r);return i.lng=i.lng||t.lng,i.lngs=i.lngs||t.lngs,i.ns=i.ns||t.ns,n.t(e,i)};return"string"==typeof t?r.lng=t:r.lngs=t,r.ns=e,r}},{key:"t",value:function(){var t;return this.translator&&(t=this.translator).translate.apply(t,arguments)}},{key:"exists",value:function(){var t;return this.translator&&(t=this.translator).exists.apply(t,arguments)}},{key:"setDefaultNamespace",value:function(t){this.options.defaultNS=t}},{key:"hasLoadedNamespace",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var r=this.languages[0],i=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;var s=function(t,n){var r=e.services.backendConnector.state["".concat(t,"|").concat(n)];return-1===r||2===r};if(n.precheck){var a=n.precheck(this,s);if(void 0!==a)return a}return!!this.hasResourceBundle(r,t)||!this.services.backendConnector.backend||!(!s(r,t)||i&&!s(o,t))}},{key:"loadNamespaces",value:function(t,e){var n=this,r=x();return this.options.ns?("string"==typeof t&&(t=[t]),t.forEach((function(t){n.options.ns.indexOf(t)<0&&n.options.ns.push(t)})),this.loadResources((function(t){r.resolve(),e&&e(t)})),r):(e&&e(),Promise.resolve())}},{key:"loadLanguages",value:function(t,e){var n=x();"string"==typeof t&&(t=[t]);var r=this.options.preload||[],i=t.filter((function(t){return r.indexOf(t)<0}));return i.length?(this.options.preload=r.concat(i),this.loadResources((function(t){n.resolve(),e&&e(t)})),n):(e&&e(),Promise.resolve())}},{key:"dir",value:function(t){return t||(t=this.languages&&this.languages.length>0?this.languages[0]:this.language),t?["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(t))>=0?"rtl":"ltr":"rtl"}},{key:"createInstance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new e(t,n)}},{key:"cloneInstance",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tt,i=g({},this.options,n,{isClone:!0}),o=new e(i),s=["store","services","language"];return s.forEach((function(e){o[e]=t[e]})),o.services=g({},this.services),o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o.translator=new K(o.services,o.options),o.translator.on("*",(function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];o.emit.apply(o,[t].concat(n))})),o.init(i,r),o.translator.options=o.options,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}}]),e}(k)),nt={NavBarItem:{view:t=>{const n=e().route.get()==t.attrs.path;return e()("a.navbar-item",{class:n?"is-active":"",onclick:n=>{e().route.set(t.attrs.path)}},t.children)}},NavBar:{oninit:t=>{t.state.menuActive=!1},view:t=>e()("nav.navbar.is-primary",[e()(".navbar-brand",[e()(e().route.Link,{href:"/main",class:"navbar-item"},et.t("appName")),e()(".navbar-item.data-title",t.attrs.title),e()("a.navbar-burger[role=button][aria-label=menu][aria-expanded=false]",{class:t.state.menuActive?"is-active":"",onclick:e=>{t.state.menuActive=!t.state.menuActive}},[e()("span[aria-hidden=true]"),e()("span[aria-hidden=true]"),e()("span[aria-hidden=true]")])]),e()(".navbar-menu",{class:t.state.menuActive?"is-active":""},[e()(".navbar-start",[e()(nt.NavBarItem,{path:"/main"},et.t("menuView")),e()(nt.NavBarItem,{path:"/history"},et.t("menuHistory")),e()(nt.NavBarItem,{path:"/setup"},et.t("menuSetup"))])])])}},rt=nt;class it{constructor(t,e=0){this.altitude=t.altitude?t.altitude:0,this.height=t.height?t.height:0,this.temperature=t.temperature?t.temperature:0,this.windHeading=t.windheading?t.windheading:0,this.windSpeed=t.windspeed?t.windspeed:0,this.magDeclination=e}getAltitude(){let t=this.altitude;switch(l.getMslUnit()){case i.AltitudeUnitEnum.M:t=i.conv_ft_to_m(this.altitude)}return t}getHeight(){let t=this.height;switch(l.getAglUnit()){case i.AltitudeUnitEnum.M:t=i.conv_ft_to_m(this.height)}return t}getTemperature(){return this.temperature}getWindHeading(){let t=this.windHeading;switch(l.getMagDeclination()){case a.MAG:t+=this.magDeclination}return l.getWindDirection()==o.FROM&&(t-=180,t<0&&(t+=360)),t}getWindSpeed(){let t=this.windSpeed;switch(l.getWindspeedUnit()){case i.WindspeedUnitEnum.KT:t=i.conv_m_s_to_kt(this.windSpeed);break;case i.WindspeedUnitEnum.KM_PER_HOUR:t=i.conv_m_s_to_km_h(this.windSpeed)}return t}}class ot{constructor(t,e){this.id=t,this.init(),e&&this.setData(e)}init(){this.lat=0,this.lng=0,this.magDeclination=0,this.measuredAt=new Date,this._records=[]}setData(t){this.lat=t.lat?t.lat:this.lat,this.lng=t.lng?t.lng:this.lng,this.magDeclination=t.mag_dec?t.mag_dec:this.magDeclination,this.measuredAt=t.measured_at?t.measured_at.toDate():this.measuredAt,this._records=t.values.map((t=>new it(t)))}getDate(){return this.measuredAt.toLocaleDateString()}getTime(){return console.log(this.measuredAt),f().sprintf("%02d:%02d",this.measuredAt.getHours(),this.measuredAt.getMinutes())}records(){return this._records}}var st=function(){return(st=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.create,Object.create;var at=function(t,e){return(at=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};Object.create,Object.create;function ut(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=ut(t[n],e[n]));return t}var ct=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function lt(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function ht(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}var ft=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,pt.prototype.create),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}at(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(Error),pt=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?dt(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new ft(i,a,r);return u},t}();function dt(t,e){return t.replace(gt,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var gt=/\{\$([^}]+)}/g;function vt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function yt(t,e){var n=new mt(t,e);return n.subscribe.bind(n)}!function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=l^u&(c^l),s=1518500249):(o=u^c^l,s=1859775393):r<60?(o=u&c|l&(u|c),s=2400959708):(o=u^c^l,s=3395469782),i=(a<<5|a>>>27)+o+h+s+n[r]&4294967295,h=l,l=c,c=4294967295&(u<<30|u>>>2),u=a,a=i;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t}}();var mt=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=bt),void 0===r.error&&(r.error=bt),void 0===r.complete&&(r.complete=bt);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function bt(){}var wt=function(){return(wt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Et(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function It(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}Object.create,Object.create;var _t,St=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),Tt="[DEFAULT]",kt=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=Tt);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new ct;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=wt({identifier:Tt,optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);try{var o=this.getOrInitializeService({instanceIdentifier:i});if(!o){if(r)return null;throw Error("Service "+this.name+" is not available")}return o}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:Tt})}catch(t){}try{for(var r=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=Et(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService({instanceIdentifier:u});a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=Tt),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}(this,void 0,void 0,(function(){var t;return function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(It(It([],Et(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),Et(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=Tt),this.instances.has(t)},t.prototype.initialize=function(t){void 0===t&&(t={});var e=t.instanceIdentifier,n=void 0===e?Tt:e,r=t.options,i=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(n);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");return this.getOrInitializeService({instanceIdentifier:o,options:i})},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);return!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===Tt?void 0:e),options:i}),this.instances.set(n,o)),o||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:Tt:t},t}(),xt=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new kt(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();function Nt(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var At,Dt=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(At||(At={}));var Ct,Ot={debug:At.DEBUG,verbose:At.VERBOSE,info:At.INFO,warn:At.WARN,error:At.ERROR,silent:At.SILENT},Lt=At.INFO,Rt=((_t={})[At.DEBUG]="log",_t[At.VERBOSE]="log",_t[At.INFO]="info",_t[At.WARN]="warn",_t[At.ERROR]="error",_t),Pt=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=Rt[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,Nt(["["+i+"]  "+t.name+":"],n))}},Mt=function(){function t(t){this.name=t,this._logLevel=Lt,this._logHandler=Pt,this._userLogHandler=null,Dt.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in At))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?Ot[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Nt([this,At.DEBUG],t)),this._logHandler.apply(this,Nt([this,At.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Nt([this,At.VERBOSE],t)),this._logHandler.apply(this,Nt([this,At.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Nt([this,At.INFO],t)),this._logHandler.apply(this,Nt([this,At.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Nt([this,At.WARN],t)),this._logHandler.apply(this,Nt([this,At.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Nt([this,At.ERROR],t)),this._logHandler.apply(this,Nt([this,At.ERROR],t))},t}();function Ft(t){Dt.forEach((function(e){e.setLogLevel(t)}))}var Ut,jt=((Ct={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Ct["bad-app-name"]="Illegal App name: '{$appName}",Ct["duplicate-app"]="Firebase App named '{$appName}' already exists",Ct["app-deleted"]="Firebase App named '{$appName}' already deleted",Ct["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Ct["invalid-log-argument"]="First argument to `onLog` must be null or a function.",Ct),Vt=new pt("app","Firebase",jt),qt="@firebase/app",Bt="[DEFAULT]",Kt=((Ut={})[qt]="fire-core",Ut["@firebase/analytics"]="fire-analytics",Ut["@firebase/auth"]="fire-auth",Ut["@firebase/database"]="fire-rtdb",Ut["@firebase/functions"]="fire-fn",Ut["@firebase/installations"]="fire-iid",Ut["@firebase/messaging"]="fire-fcm",Ut["@firebase/performance"]="fire-perf",Ut["@firebase/remote-config"]="fire-rc",Ut["@firebase/storage"]="fire-gcs",Ut["@firebase/firestore"]="fire-fst",Ut["fire-js"]="fire-js",Ut["firebase-wrapper"]="fire-js-all",Ut),zt=new Mt("@firebase/app"),Gt=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=ut(void 0,t),this.container=new xt(e.name),this._addComponent(new St("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e=Bt),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=Bt),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){zt.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Vt.create("app-deleted",{appName:this.name_})},t}();Gt.prototype.name&&Gt.prototype.options||Gt.prototype.delete||console.log("dc");var Ht=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=Bt);var s=o.name;if("string"!=typeof s||!s)throw Vt.create("bad-app-name",{appName:String(s)});if(vt(e,s))throw Vt.create("duplicate-app",{appName:s});var a=new t(n,o,r);return e[s]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=Kt[t])&&void 0!==r?r:t;n&&(i+="-"+n);var s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return s&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),s&&a&&u.push("and"),a&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void zt.warn(u.join(" "))}o(new St(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:Ft,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw Vt.create("invalid-log-argument");!function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=Ot[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:At[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=Dt;r<i.length;r++)n(i[r])}(t,e)},apps:null,SDK_VERSION:"8.3.1",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(!vt(e,t=t||Bt))throw Vt.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return zt.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var a=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw Vt.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&ut(a,o.serviceProps),r[s]=a,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,s).apply(this,o.multipleInstances?t:[])}}for(var u=0,c=Object.keys(e);u<c.length;u++){var l=c[u];e[l]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(Gt);return e.INTERNAL=st(st({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){ut(e,t)},createSubscribe:yt,ErrorFactory:pt,deepExtend:ut}),e}(),Wt=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if("object"==typeof self&&self.self===self&&void 0!==self.firebase){zt.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Qt=self.firebase.SDK_VERSION;Qt&&Qt.indexOf("LITE")>=0&&zt.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var $t=Ht.initializeApp;Ht.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ht()&&zt.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),$t.apply(void 0,t)};var Yt=Ht;!function(t,e){t.INTERNAL.registerComponent(new St("platform-logger",(function(t){return new Wt(t)}),"PRIVATE")),t.registerVersion(qt,"0.6.17",void 0),t.registerVersion("fire-js","")}(Yt);const Jt=Yt;Jt.registerVersion("firebase","8.3.1","app");var Xt=function(t,e){return(Xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Zt(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var te,ee="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},ne=ne||{},re=ee||self;function ie(){}function oe(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function se(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var ae="closure_uid_"+(1e9*Math.random()>>>0),ue=0;function ce(t,e,n){return t.call.apply(t.bind,arguments)}function le(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function he(t,e,n){return(he=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ce:le).apply(null,arguments)}function fe(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function pe(){return Date.now()}function de(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function ge(){this.j=this.j,this.i=this.i}ge.prototype.j=!1,ge.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,ae)&&t[ae]||(t[ae]=++ue)}(this)},ge.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var ve=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},ye=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function me(t){return Array.prototype.concat.apply([],arguments)}function be(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function we(t){return/^[\s\xa0]*$/.test(t)}var Ee,Ie=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function _e(t,e){return-1!=t.indexOf(e)}function Se(t,e){return t<e?-1:t>e?1:0}t:{var Te=re.navigator;if(Te){var ke=Te.userAgent;if(ke){Ee=ke;break t}}Ee=""}function xe(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Ne(t){var e={};for(var n in t)e[n]=t[n];return e}var Ae="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function De(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Ae.length;o++)n=Ae[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ce(t){return Ce[" "](t),t}Ce[" "]=ie;var Oe,Le,Re=_e(Ee,"Opera"),Pe=_e(Ee,"Trident")||_e(Ee,"MSIE"),Me=_e(Ee,"Edge"),Fe=Me||Pe,Ue=_e(Ee,"Gecko")&&!(_e(Ee.toLowerCase(),"webkit")&&!_e(Ee,"Edge"))&&!(_e(Ee,"Trident")||_e(Ee,"MSIE"))&&!_e(Ee,"Edge"),je=_e(Ee.toLowerCase(),"webkit")&&!_e(Ee,"Edge");function Ve(){var t=re.document;return t?t.documentMode:void 0}t:{var qe="",Be=(Le=Ee,Ue?/rv:([^\);]+)(\)|;)/.exec(Le):Me?/Edge\/([\d\.]+)/.exec(Le):Pe?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Le):je?/WebKit\/(\S+)/.exec(Le):Re?/(?:Version)[ \/]?(\S+)/.exec(Le):void 0);if(Be&&(qe=Be?Be[1]:""),Pe){var Ke=Ve();if(null!=Ke&&Ke>parseFloat(qe)){Oe=String(Ke);break t}}Oe=qe}var ze,Ge={};function He(t){return function(t,e){var n=Ge;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=Ie(String(Oe)).split("."),r=Ie(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=Se(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||Se(0==s[2].length,0==a[2].length)||Se(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}re.document&&Pe?ze=Ve()||parseInt(Oe,10)||void 0:ze=void 0;var We=ze,Qe=!Pe||9<=Number(We),$e=Pe&&!He("9"),Ye=function(){if(!re.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{re.addEventListener("test",ie,e),re.removeEventListener("test",ie,e)}catch(t){}return t}();function Je(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Xe(t,e){if(Je.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Ue){t:{try{Ce(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ze[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Je.prototype.b=function(){this.defaultPrevented=!0},de(Xe,Je);var Ze={2:"touch",3:"pen",4:"mouse"};Xe.prototype.b=function(){Xe.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,$e)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var tn="closure_listenable_"+(1e6*Math.random()|0),en=0;function nn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++en,this.Y=this.Z=!1}function rn(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function on(t){this.src=t,this.a={},this.b=0}function sn(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=ve(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(rn(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function an(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}on.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=an(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new nn(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var un="closure_lm_"+(1e6*Math.random()|0),cn={};function ln(t,e,n,r,i){if(r&&r.once)return fn(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)ln(t,e[o],n,r,i);return null}return n=wn(n),t&&t[tn]?t.va(e,n,se(r)?!!r.capture:!!r,i):hn(t,e,n,!1,r,i)}function hn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=se(i)?!!i.capture:!!i;if(s&&!Qe)return null;var a=mn(t);if(a||(t[un]=a=new on(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=yn,e=Qe?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Ye||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(gn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function fn(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)fn(t,e[o],n,r,i);return null}return n=wn(n),t&&t[tn]?t.wa(e,n,se(r)?!!r.capture:!!r,i):hn(t,e,n,!0,r,i)}function pn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)pn(t,e[o],n,r,i);else r=se(r)?!!r.capture:!!r,n=wn(n),t&&t[tn]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=an(o=t.a[e],n,r,i))&&(rn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=mn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=an(e,n,r,i)),(n=-1<t?e[t]:null)&&dn(n))}function dn(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[tn])sn(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(gn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=mn(e))?(sn(n,t),0==n.b&&(n.src=null,e[un]=null)):rn(t)}}}function gn(t){return t in cn?cn[t]:cn[t]="on"+t}function vn(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&dn(t),n.call(r,e)}function yn(t,e){if(t.Y)return!0;if(!Qe){if(!e)t:{e=["window","event"];for(var n=re,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return vn(t,e=new Xe(e,this))}return vn(t,new Xe(e,this))}function mn(t){return(t=t[un])instanceof on?t:null}var bn="__closure_events_fn_"+(1e9*Math.random()>>>0);function wn(t){return"function"==typeof t?t:(t[bn]||(t[bn]=function(e){return t.handleEvent(e)}),t[bn])}function En(){ge.call(this),this.c=new on(this),this.J=this,this.C=null}function In(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new Je(e,t);else if(e instanceof Je)e.target=e.target||t;else{var i=e;De(e=new Je(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=_n(s,r,!0,e)&&i}if(i=_n(s=e.a=t,r,!0,e)&&i,i=_n(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=_n(s=e.a=n[o],r,!1,e)&&i}function _n(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.ca||s.src;s.Z&&sn(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}de(En,ge),En.prototype[tn]=!0,(te=En.prototype).addEventListener=function(t,e,n,r){ln(this,t,e,n,r)},te.removeEventListener=function(t,e,n,r){pn(this,t,e,n,r)},te.G=function(){if(En.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)rn(n[r]);delete e.a[t],e.b--}}this.C=null},te.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},te.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Sn=re.JSON.stringify;function Tn(){this.b=this.a=null}var kn,xn=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new An}),(function(t){t.reset()}));function Nn(){var t=Ln,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function An(){this.next=this.b=this.a=null}function Dn(t){re.setTimeout((function(){throw t}),0)}function Cn(t,e){kn||function(){var t=re.Promise.resolve(void 0);kn=function(){t.then(Rn)}}(),On||(kn(),On=!0),Ln.add(t,e)}Tn.prototype.add=function(t,e){var n=xn.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},An.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},An.prototype.reset=function(){this.next=this.b=this.a=null};var On=!1,Ln=new Tn;function Rn(){for(var t;t=Nn();){try{t.a.call(t.b)}catch(t){Dn(t)}var e=xn;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}On=!1}function Pn(t,e){En.call(this),this.b=t||1,this.a=e||re,this.f=he(this.Za,this),this.g=pe()}function Mn(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Fn(t,e,n){if("function"==typeof t)n&&(t=he(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=he(t.handleEvent,t)}return 2147483647<Number(e)?-1:re.setTimeout(t,e||0)}function Un(t){t.a=Fn((function(){t.a=null,t.c&&(t.c=!1,Un(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}de(Pn,En),(te=Pn.prototype).aa=!1,te.M=null,te.Za=function(){if(this.aa){var t=pe()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),In(this,"tick"),this.aa&&(Mn(this),this.start()))}},te.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=pe())},te.G=function(){Pn.X.G.call(this),Mn(this),delete this.a};var jn=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}Xt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Un(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(re.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(ge);function Vn(t){ge.call(this),this.b=t,this.a={}}de(Vn,ge);var qn=[];function Bn(t,e,n,r){Array.isArray(n)||(n&&(qn[0]=n.toString()),n=qn);for(var i=0;i<n.length;i++){var o=ln(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Kn(t){xe(t.a,(function(t,e){this.a.hasOwnProperty(e)&&dn(t)}),t),t.a={}}function zn(){this.a=!0}function Gn(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Sn(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}Vn.prototype.G=function(){Vn.X.G.call(this),Kn(this)},Vn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},zn.prototype.info=function(){};var Hn={},Wn=null;function Qn(){return Wn=Wn||new En}function $n(t){Je.call(this,Hn.Fa,t)}function Yn(t){var e=Qn();In(e,new $n(e,t))}function Jn(t,e){Je.call(this,Hn.STAT_EVENT,t),this.stat=e}function Xn(t){var e=Qn();In(e,new Jn(e,t))}function Zn(t){Je.call(this,Hn.Ga,t)}function tr(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return re.setTimeout((function(){t()}),e)}Hn.Fa="serverreachability",de($n,Je),Hn.STAT_EVENT="statevent",de(Jn,Je),Hn.Ga="timingevent",de(Zn,Je);var er={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},nr={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function rr(){}function ir(t){var e;return(e=t.a)||(e=t.a={}),e}function or(){}rr.prototype.a=null;var sr,ar={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function ur(){Je.call(this,"d")}function cr(){Je.call(this,"c")}function lr(){}function hr(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Vn(this),this.P=fr,t=Fe?125:void 0,this.R=new Pn(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}de(ur,Je),de(cr,Je),de(lr,rr),sr=new lr;var fr=45e3,pr={},dr={};function gr(t,e,n){t.H=1,t.i=Fr(Cr(e)),t.j=n,t.I=!0,vr(t,null)}function vr(t,e){t.u=pe(),br(t),t.l=Cr(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),Yr(n.b,"t",r),t.D=0,t.a=zi(t.g,t.g.C?e:null),0<t.O&&(t.F=new jn(he(t.Ca,t,t.a),t.O)),Bn(t.J,t.a,"readystatechange",t.Xa),e=t.B?Ne(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Yn(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");s=2<=h.length&&"type"==h[1]?s+(l+"=")+c+"&":s+(l+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function yr(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=mr(t,n);if(i==dr){4==e&&(t.h=4,Xn(14),r=!1),Gn(t.c,t.f,null,"[Incomplete Response]");break}if(i==pr){t.h=4,Xn(15),Gn(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Gn(t.c,t.f,i,null),Sr(t,i)}4==e&&0==n.length&&(t.h=1,Xn(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Mi(e),e.F=!0,Xn(11))):(Gn(t.c,t.f,n,"[Invalid Chunked Response]"),_r(t),Ir(t))}function mr(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?dr:(n=Number(e.substring(n,r)),isNaN(n)?pr:(r+=1)+n>e.length?dr:(e=e.substr(r,n),t.D=r+n,e))}function br(t){t.T=pe()+t.P,wr(t,t.P)}function wr(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=tr(he(t.Va,t),e)}function Er(t){t.o&&(re.clearTimeout(t.o),t.o=null)}function Ir(t){0==t.g.v||t.A||ji(t.g,t)}function _r(t){Er(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Mn(t.R),Kn(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Sr(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||ri(n.b,t)))if(n.I=t.N,!t.C&&ri(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Ui(n),xi(n)}Pi(n),Xn(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=tr(he(n.Sa,n),6e3));if(1>=ni(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else qi(n,11)}else if((t.C||n.a==t)&&Ui(n),!we(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var l=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=u.b;!h.a&&(_e(l,"spdy")||_e(l,"quic")||_e(l,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(ii(h,h.b),h.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,Mr(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=pe()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((u=n).la=Ki(u,u.C?u.ga:null,u.fa),p.C){oi(u.b,p);var d=p,g=u.D;g&&d.setTimeout(g),d.o&&(Er(d),br(d)),u.a=p}else Ri(u);0<n.g.length&&Di(n)}else"stop"!=i[0]&&"close"!=i[0]||qi(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?qi(n,7):ki(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Yn(4)}catch(t){}}function Tr(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(oe(t)||"string"==typeof t)ye(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(oe(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(oe(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function kr(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof kr)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function xr(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Nr(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Nr(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Nr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(te=hr.prototype).setTimeout=function(t){this.P=t},te.Xa=function(t){t=t.target;var e=this.F;e&&3==Ii(t)?e.f():this.Ca(t)},te.Ca=function(t){try{if(t==this.a)t:{var e=Ii(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!Fe&&!this.a.$())){this.A||4!=e||7==n||Yn(8==n||0>=r?3:2),Er(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!we(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,Xn(12),_r(this),Ir(this);break t}Gn(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Sr(this,u)}this.I?(yr(this,e,o),Fe&&this.b&&3==e&&(Bn(this.J,this.R,"tick",this.Wa),this.R.start())):(Gn(this.c,this.f,o,null),Sr(this,o)),4==e&&_r(this),this.b&&!this.A&&(4==e?ji(this.g,this):(this.b=!1,br(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Xn(12)):(this.h=0,Xn(13)),_r(this),Ir(this)}}}catch(t){}},te.Wa=function(){if(this.a){var t=Ii(this.a),e=this.a.$();this.D<e.length&&(Er(this),yr(this,t,e),this.b&&4!=t&&br(this))}},te.cancel=function(){this.A=!0,_r(this)},te.Va=function(){this.o=null;var t=pe();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(Yn(3),Xn(17)),_r(this),this.h=2,Ir(this)):wr(this,this.T-t)},(te=kr.prototype).K=function(){xr(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},te.L=function(){return xr(this),this.a.concat()},te.get=function(t,e){return Nr(this.b,t)?this.b[t]:e},te.set=function(t,e){Nr(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},te.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ar=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Dr(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Dr){this.a=void 0!==e?e:t.a,Or(this,t.f),this.j=t.j,Lr(this,t.c),Rr(this,t.h),this.g=t.g,e=t.b;var n=new Hr;n.c=e.c,e.a&&(n.a=new kr(e.a),n.b=e.b),Pr(this,n),this.i=t.i}else t&&(n=String(t).match(Ar))?(this.a=!!e,Or(this,n[1]||"",!0),this.j=Ur(n[2]||""),Lr(this,n[3]||"",!0),Rr(this,n[4]),this.g=Ur(n[5]||"",!0),Pr(this,n[6]||"",!0),this.i=Ur(n[7]||"")):(this.a=!!e,this.b=new Hr(null,this.a))}function Cr(t){return new Dr(t)}function Or(t,e,n){t.f=n?Ur(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Lr(t,e,n){t.c=n?Ur(e,!0):e}function Rr(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Pr(t,e,n){e instanceof Hr?(t.b=e,function(t,e){e&&!t.f&&(Wr(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Qr(this,e),Yr(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=jr(e,zr)),t.b=new Hr(e,t.a))}function Mr(t,e,n){t.b.set(e,n)}function Fr(t){return Mr(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^pe()).toString(36)),t}function Ur(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function jr(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Vr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Vr(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Dr.prototype.toString=function(){var t=[],e=this.f;e&&t.push(jr(e,qr,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(jr(e,qr,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(jr(n,"/"==n.charAt(0)?Kr:Br,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",jr(n,Gr)),t.join("")};var qr=/[#\/\?@]/g,Br=/[#\?:]/g,Kr=/[#\?]/g,zr=/[#\?@]/g,Gr=/#/g;function Hr(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Wr(t){t.a||(t.a=new kr,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Qr(t,e){Wr(t),e=Jr(t,e),Nr(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Nr((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&xr(t)))}function $r(t,e){return Wr(t),e=Jr(t,e),Nr(t.a.b,e)}function Yr(t,e,n){Qr(t,e),0<n.length&&(t.c=null,t.a.set(Jr(t,e),be(n)),t.b+=n.length)}function Jr(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(te=Hr.prototype).add=function(t,e){Wr(this),this.c=null,t=Jr(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},te.forEach=function(t,e){Wr(this),this.a.forEach((function(n,r){ye(n,(function(n){t.call(e,n,r,this)}),this)}),this)},te.L=function(){Wr(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},te.K=function(t){Wr(this);var e=[];if("string"==typeof t)$r(this,t)&&(e=me(e,this.a.get(Jr(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=me(e,t[n])}return e},te.set=function(t,e){return Wr(this),this.c=null,$r(this,t=Jr(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},te.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},te.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Xr=function(t,e){this.b=t,this.a=e};function Zr(t){this.g=t||ti,t=re.PerformanceNavigationTiming?0<(t=re.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(re.ia&&re.ia.ya&&re.ia.ya()&&re.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var ti=10;function ei(t){return!!t.b||!!t.a&&t.a.size>=t.f}function ni(t){return t.b?1:t.a?t.a.size:0}function ri(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function ii(t,e){t.a?t.a.add(e):t.b=e}function oi(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function si(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=Zt(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return be(t.c)}function ai(){}function ui(){this.a=new ai}function ci(t,e,n){var r=n||"";try{Tr(t,(function(t,n){var i=t;se(t)&&(i=Sn(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function li(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Zr.prototype.cancel=function(){var t,e;if(this.c=si(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=Zt(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},ai.prototype.stringify=function(t){return re.JSON.stringify(t,void 0)},ai.prototype.parse=function(t){return re.JSON.parse(t,void 0)};var hi=re.JSON.parse;function fi(t){En.call(this),this.headers=new kr,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=pi,this.D=this.F=!1}de(fi,En);var pi="",di=/^https?$/i,gi=["POST","PUT"];function vi(t){return"content-type"==t.toLowerCase()}function yi(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,mi(t),wi(t)}function mi(t){t.u||(t.u=!0,In(t,"complete"),In(t,"error"))}function bi(t){if(t.b&&void 0!==ne&&(!t.s[1]||4!=Ii(t)||2!=t.W()))if(t.l&&4==Ii(t))Fn(t.za,0,t);else if(In(t,"readystatechange"),4==Ii(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Ar)[1]||null;if(!o&&re.self&&re.self.location){var s=re.self.location.protocol;o=s.substr(0,s.length-1)}i=!di.test(o?o.toLowerCase():"")}e=i}if(e)In(t,"complete"),In(t,"success");else{t.h=6;try{var a=2<Ii(t)?t.a.statusText:""}catch(n){a=""}t.f=a+" ["+t.W()+"]",mi(t)}}finally{wi(t)}}}function wi(t,e){if(t.a){Ei(t);var n=t.a,r=t.s[0]?ie:null;t.a=null,t.s=null,e||In(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Ei(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(re.clearTimeout(t.m),t.m=null)}function Ii(t){return t.a?t.a.readyState:0}function _i(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return xe(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Mr(t,e,n))}function Si(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ti(t){this.pa=0,this.g=[],this.c=new zn,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Si("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Si("baseRetryDelayMs",5e3,t),this.Ra=Si("retryDelaySeedMs",1e4,t),this.Ma=Si("forwardChannelMaxRetries",2,t),this.ma=Si("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Zr(t&&t.concurrentRequestLimit),this.ka=new ui,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function ki(t){if(Ni(t),3==t.v){var e=t.R++,n=Cr(t.B);Mr(n,"SID",t.J),Mr(n,"RID",e),Mr(n,"TYPE","terminate"),Oi(t,n),(e=new hr(t,t.c,e,void 0)).H=2,e.i=Fr(Cr(n)),n=!1,re.navigator&&re.navigator.sendBeacon&&(n=re.navigator.sendBeacon(e.i.toString(),"")),!n&&re.Image&&((new Image).src=e.i,n=!0),n||(e.a=zi(e.g,null),e.a.ba(e.i)),e.u=pe(),br(e)}Bi(t)}function xi(t){t.a&&(Mi(t),t.a.cancel(),t.a=null)}function Ni(t){xi(t),t.j&&(re.clearTimeout(t.j),t.j=null),Ui(t),t.b.cancel(),t.h&&("number"==typeof t.h&&re.clearTimeout(t.h),t.h=null)}function Ai(t,e){t.g.push(new Xr(t.Oa++,e)),3==t.v&&Di(t)}function Di(t){ei(t.b)||t.h||(t.h=!0,Cn(t.Ba,t),t.u=0)}function Ci(t,e){var n;n=e?e.f:t.R++;var r=Cr(t.B);Mr(r,"SID",t.J),Mr(r,"RID",n),Mr(r,"AID",t.P),Oi(t,r),t.i&&t.l&&_i(r,t.i,t.l),n=new hr(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Li(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),ii(t.b,n),gr(n,r,e)}function Oi(t,e){t.f&&Tr({},(function(t,n){Mr(e,n,t)}))}function Li(t,e,n){n=Math.min(t.g.length,n);var r=t.f?he(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{ci(l,s,"req"+c+"_")}catch(t){r&&r(l)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Ri(t){t.a||t.j||(t.T=1,Cn(t.Aa,t),t.o=0)}function Pi(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=tr(he(t.Aa,t),Vi(t,t.o)),t.o++,0))}function Mi(t){null!=t.s&&(re.clearTimeout(t.s),t.s=null)}function Fi(t){t.a=new hr(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Cr(t.la);Mr(e,"RID","rpc"),Mr(e,"SID",t.J),Mr(e,"CI",t.H?"0":"1"),Mr(e,"AID",t.P),Oi(t,e),Mr(e,"TYPE","xmlhttp"),t.i&&t.l&&_i(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Fr(Cr(e)),n.j=null,n.I=!0,vr(n,t)}function Ui(t){null!=t.m&&(re.clearTimeout(t.m),t.m=null)}function ji(t,e){var n=null;if(t.a==e){Ui(t),Mi(t),t.a=null;var r=2}else{if(!ri(t.b,e))return;n=e.s,oi(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=pe()-e.u;var i=t.u;In(r=Qn(),new Zn(r,n,e,i)),Di(t)}else Ri(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(ni(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=tr(he(t.Ba,t,e),Vi(t,t.u)),t.u++,0)))}(t,e)||2==r&&Pi(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:qi(t,5);break;case 4:qi(t,10);break;case 3:qi(t,6);break;default:qi(t,2)}}function Vi(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function qi(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=he(t.Ya,t);n||(n=new Dr("//www.google.com/images/cleardot.gif"),re.location&&"http"==re.location.protocol||Or(n,"https"),Fr(n)),function(t,e){var n=new zn;if(re.Image){var r=new Image;r.onload=fe(li,n,r,"TestLoadImage: loaded",!0,e),r.onerror=fe(li,n,r,"TestLoadImage: error",!1,e),r.onabort=fe(li,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=fe(li,n,r,"TestLoadImage: timeout",!1,e),re.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Xn(2);t.v=0,t.f&&t.f.ra(e),Bi(t),Ni(t)}function Bi(t){t.v=0,t.I=-1,t.f&&(0==si(t.b).length&&0==t.g.length||(t.b.c.length=0,be(t.g),t.g.length=0),t.f.qa())}function Ki(t,e,n){var r=function(t){return t instanceof Dr?Cr(t):new Dr(t,void 0)}(n);if(""!=r.c)e&&Lr(r,e+"."+r.c),Rr(r,r.h);else{var i=re.location;r=function(t,e,n,r){var i=new Dr(null,void 0);return t&&Or(i,t),e&&Lr(i,e),n&&Rr(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&xe(t.V,(function(t,e){Mr(r,e,t)})),e=t.A,n=t.na,e&&n&&Mr(r,e,n),Mr(r,"VER",t.ha),Oi(t,r),r}function zi(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new fi(t.Na)).F=t.C,e}function Gi(){}function Hi(){if(Pe&&!(10<=Number(We)))throw Error("Environmental error: no available transport.")}function Wi(t,e){En.call(this),this.a=new Ti(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!we(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!we(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Yi(this)}function Qi(t){ur.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function $i(){cr.call(this),this.status=1}function Yi(t){this.a=t}(te=fi.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?ir(this.H):ir(sr),this.a.onreadystatechange=he(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void yi(this,t)}t=n||"";var i=new kr(this.headers);r&&Tr(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=vi,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=re.FormData&&t instanceof re.FormData,!(0<=ve(gi,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Ei(this),0<this.o&&((this.D=function(t){return Pe&&He(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=he(this.xa,this)):this.m=Fn(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){yi(this,t)}},te.xa=function(){void 0!==ne&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,In(this,"timeout"),this.abort(8))},te.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,In(this,"complete"),In(this,"abort"),wi(this))},te.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),wi(this,!0)),fi.X.G.call(this)},te.za=function(){this.j||(this.A||this.l||this.g?bi(this):this.Ua())},te.Ua=function(){bi(this)},te.W=function(){try{return 2<Ii(this)?this.a.status:-1}catch(t){return-1}},te.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},te.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),hi(e)}},te.ua=function(){return this.h},te.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(te=Ti.prototype).ha=8,te.v=1,te.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new hr(this,this.c,t,void 0),r=this.l;if(this.O&&(r?De(r=Ne(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Li(this,n,e),Mr(i=Cr(this.B),"RID",t),Mr(i,"CVER",22),this.A&&Mr(i,"X-HTTP-Session-Id",this.A),Oi(this,i),this.i&&r&&_i(i,this.i,r),ii(this.b,n),this.Ia&&Mr(i,"TYPE","init"),this.da?(Mr(i,"$req",e),Mr(i,"SID","null"),n.U=!0,gr(n,i,null)):gr(n,i,e),this.v=2}}else 3==this.v&&(t?Ci(this,t):0==this.g.length||ei(this.b)||Ci(this))},te.Aa=function(){if(this.j=null,Fi(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=tr(he(this.Ta,this),t)}},te.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Xn(10),xi(this),Fi(this))},te.Sa=function(){null!=this.m&&(this.m=null,xi(this),Pi(this),Xn(19))},te.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Xn(2)):(this.c.info("Failed to ping google.com"),Xn(1))},(te=Gi.prototype).ta=function(){},te.sa=function(){},te.ra=function(){},te.qa=function(){},te.Ja=function(){},Hi.prototype.a=function(t,e){return new Wi(t,e)},de(Wi,En),Wi.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Xn(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=Ki(t,null,t.fa),Di(t)},Wi.prototype.close=function(){ki(this.a)},Wi.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Ai(this.a,e)}else this.l?((e={}).__data__=Sn(t),Ai(this.a,e)):Ai(this.a,t)},Wi.prototype.G=function(){this.a.f=null,delete this.f,ki(this.a),delete this.a,Wi.X.G.call(this)},de(Qi,ur),de($i,cr),de(Yi,Gi),Yi.prototype.ta=function(){In(this.a,"a")},Yi.prototype.sa=function(t){In(this.a,new Qi(t))},Yi.prototype.ra=function(t){In(this.a,new $i(t))},Yi.prototype.qa=function(){In(this.a,"b")},Hi.prototype.createWebChannel=Hi.prototype.a,Wi.prototype.send=Wi.prototype.h,Wi.prototype.open=Wi.prototype.g,Wi.prototype.close=Wi.prototype.close,er.NO_ERROR=0,er.TIMEOUT=8,er.HTTP_ERROR=6,nr.COMPLETE="complete",or.EventType=ar,ar.OPEN="a",ar.CLOSE="b",ar.ERROR="c",ar.MESSAGE="d",En.prototype.listen=En.prototype.va,fi.prototype.listenOnce=fi.prototype.wa,fi.prototype.getLastError=fi.prototype.Qa,fi.prototype.getLastErrorCode=fi.prototype.ua,fi.prototype.getStatus=fi.prototype.W,fi.prototype.getResponseJson=fi.prototype.Pa,fi.prototype.getResponseText=fi.prototype.$,fi.prototype.send=fi.prototype.ba;var Ji=er,Xi=nr,Zi=Hn,to=10,eo=11,no=or,ro=fi,io=function(t,e){return(io=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function oo(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}io(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function so(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function ao(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function uo(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}Object.create,Object.create;var co=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();co.o=-1;var lo=new Mt("@firebase/firestore");function ho(){return lo.logLevel}function fo(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(lo.logLevel<=At.DEBUG){var r=e.map(vo);lo.debug.apply(lo,uo(["Firestore (8.3.1): "+t],r))}}function po(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(lo.logLevel<=At.ERROR){var r=e.map(vo);lo.error.apply(lo,uo(["Firestore (8.3.1): "+t],r))}}function go(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(lo.logLevel<=At.WARN){var r=e.map(vo);lo.warn.apply(lo,uo(["Firestore (8.3.1): "+t],r))}}function vo(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function yo(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.3.1) INTERNAL ASSERTION FAILED: "+t;throw po(e),new Error(e)}function mo(t,e){t||yo()}function bo(t,e){return t}function wo(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Eo=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=wo(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Io(t,e){return t<e?-1:t>e?1:0}function _o(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function So(t){return t+"\0"}function To(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ko(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function xo(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function No(t){return null==t}function Ao(t){return 0===t&&1/t==-1/0}function Do(t){return"number"==typeof t&&Number.isInteger(t)&&!Ao(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Co={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Oo=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return oo(e,t),e}(Error),Lo=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&yo(),void 0===n?n=t.length-e:n>t.length-e&&yo(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Ro=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oo(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Oo(Co.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(Lo),Po=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Mo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oo(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Po.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Oo(Co.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new Oo(Co.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Oo(Co.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Oo(Co.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(Lo),Fo=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(Ro.fromString(e))},t.fromName=function(e){return new t(Ro.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Ro.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return Ro.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new Ro(e.slice()))},t}(),Uo=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Io(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Uo.EMPTY_BYTE_STRING=new Uo("");var jo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vo(t){if(mo(!!t),"string"==typeof t){var e=0,n=jo.exec(t);if(mo(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:qo(t.seconds),nanos:qo(t.nanos)}}function qo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Bo(t){return"string"==typeof t?Uo.fromBase64String(t):Uo.fromUint8Array(t)}var Ko=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Oo(Co.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Oo(Co.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Oo(Co.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Oo(Co.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Io(this.nanoseconds,t.nanoseconds):Io(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}();function zo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Go(t){var e=t.mapValue.fields.__previous_value__;return zo(e)?Go(e):e}function Ho(t){var e=Vo(t.mapValue.fields.__local_write_time__.timestampValue);return new Ko(e.seconds,e.nanos)}function Wo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?zo(t)?4:10:yo()}function Qo(t,e){var n=Wo(t);if(n!==Wo(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ho(t).isEqual(Ho(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Vo(t.timestampValue),r=Vo(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Bo(t.bytesValue).isEqual(Bo(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return qo(t.geoPointValue.latitude)===qo(e.geoPointValue.latitude)&&qo(t.geoPointValue.longitude)===qo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return qo(t.integerValue)===qo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=qo(t.doubleValue),r=qo(e.doubleValue);return n===r?Ao(n)===Ao(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return _o(t.arrayValue.values||[],e.arrayValue.values||[],Qo);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(To(n)!==To(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Qo(n[i],r[i])))return!1;return!0}(t,e);default:return yo()}}function $o(t,e){return void 0!==(t.values||[]).find((function(t){return Qo(t,e)}))}function Yo(t,e){var n=Wo(t),r=Wo(e);if(n!==r)return Io(n,r);switch(n){case 0:return 0;case 1:return Io(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=qo(t.integerValue||t.doubleValue),r=qo(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return Jo(t.timestampValue,e.timestampValue);case 4:return Jo(Ho(t),Ho(e));case 5:return Io(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Bo(t),r=Bo(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Io(n[i],r[i]);if(0!==o)return o}return Io(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Io(qo(t.latitude),qo(e.latitude));return 0!==n?n:Io(qo(t.longitude),qo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Yo(n[i],r[i]);if(o)return o}return Io(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Io(r[s],o[s]);if(0!==a)return a;var u=Yo(n[r[s]],i[o[s]]);if(0!==u)return u}return Io(r.length,o.length)}(t.mapValue,e.mapValue);default:throw yo()}}function Jo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Io(t,e);var n=Vo(t),r=Vo(e),i=Io(n.seconds,r.seconds);return 0!==i?i:Io(n.nanos,r.nanos)}function Xo(t){return Zo(t)}function Zo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Vo(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Bo(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Fo.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Zo(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Zo(t.fields[o])}return e+"}"}(t.mapValue):yo();var e,n}function ts(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function es(t){return!!t&&"integerValue"in t}function ns(t){return!!t&&"arrayValue"in t}function rs(t){return!!t&&"nullValue"in t}function is(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function os(t){return!!t&&"mapValue"in t}var ss=function(t,e){this.key=t,this.version=e},as=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).objectValue=r,o.hasLocalMutations=!!i.hasLocalMutations,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return oo(e,t),e.prototype.field=function(t){return this.objectValue.field(t)},e.prototype.data=function(){return this.objectValue},e.prototype.toProto=function(){return this.objectValue.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.hasLocalMutations===t.hasLocalMutations&&this.hasCommittedMutations===t.hasCommittedMutations&&this.objectValue.isEqual(t.objectValue)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.objectValue.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(ss),us=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return oo(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(ss),cs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oo(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(ss),ls=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function hs(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ls(t,e,n,r,i,o,s)}function fs(t){var e=bo(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+Xo(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),No(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Ts(e.startAt)),e.endAt&&(n+="|ub:",n+=Ts(e.endAt)),e.h=n}return e.h}function ps(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!xs(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Qo(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!As(t.startAt,e.startAt)&&As(t.endAt,e.endAt)}function ds(t){return Fo.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var gs=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return oo(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new vs(t,n,r):"array-contains"===n?new ws(t,r):"in"===n?new Es(t,r):"not-in"===n?new Is(t,r):"array-contains-any"===n?new _s(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new ys(t,n):new ms(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.m(Yo(e,this.value)):null!==e&&Wo(this.value)===Wo(e)&&this.m(Yo(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return yo()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),vs=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Fo.fromName(r.referenceValue),i}return oo(e,t),e.prototype.matches=function(t){var e=Fo.comparator(t.key,this.key);return this.m(e)},e}(gs),ys=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=bs(0,n),r}return oo(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(gs),ms=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=bs(0,n),r}return oo(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(gs);function bs(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Fo.fromName(t.referenceValue)}))}var ws=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return oo(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return ns(e)&&$o(e.arrayValue,this.value)},e}(gs),Es=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return oo(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&$o(this.value.arrayValue,e)},e}(gs),Is=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return oo(e,t),e.prototype.matches=function(t){if($o(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!$o(this.value.arrayValue,e)},e}(gs),_s=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return oo(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ns(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return $o(e.value.arrayValue,t)}))},e}(gs),Ss=function(t,e){this.position=t,this.before=e};function Ts(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Xo(t)})).join(",")}var ks=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function xs(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Ns(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.isKeyField()?Fo.comparator(Fo.fromName(s.referenceValue),n.key):Yo(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function As(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Qo(t.position[n],e.position[n]))return!1;return!0}var Ds=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function Cs(t,e,n,r,i,o,s,a){return new Ds(t,e,n,r,i,o,s,a)}function Os(t){return new Ds(t)}function Ls(t){return!No(t.limit)&&"F"===t.limitType}function Rs(t){return!No(t.limit)&&"L"===t.limitType}function Ps(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Ms(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Fs(t){return null!==t.collectionGroup}function Us(t){var e=bo(t);if(null===e.p){e.p=[];var n=Ms(e),r=Ps(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new ks(n)),e.p.push(new ks(Mo.keyField(),"asc"));else{for(var i=!1,o=0,s=e.explicitOrderBy;o<s.length;o++){var a=s[o];e.p.push(a),a.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new ks(Mo.keyField(),u))}}}return e.p}function js(t){var e=bo(t);if(!e.T)if("F"===e.limitType)e.T=hs(e.path,e.collectionGroup,Us(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Us(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ks(o.field,s))}var a=e.endAt?new Ss(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Ss(e.startAt.position,!e.startAt.before):null;e.T=hs(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.T}function Vs(t,e,n){return new Ds(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function qs(t,e){return ps(js(t),js(e))&&t.limitType===e.limitType}function Bs(t){return fs(js(t))+"|lt:"+t.limitType}function Ks(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+Xo(e.value);var e})).join(", ")+"]"),No(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Ts(t.startAt)),t.endAt&&(e+=", endAt: "+Ts(t.endAt)),"Target("+e+")"}(js(t))+"; limitType="+t.limitType+")"}function zs(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Fo.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Ns(t.startAt,Us(t),e)||t.endAt&&Ns(t.endAt,Us(t),e))}(t,e)}function Gs(t){return function(e,n){for(var r=!1,i=0,o=Us(t);i<o.length;i++){var s=o[i],a=Hs(s,e,n);if(0!==a)return a;r=r||s.field.isKeyField()}return 0}}function Hs(t,e,n){var r=t.field.isKeyField()?Fo.comparator(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Yo(r,i):yo()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return yo()}}var Ws=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Ko(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}(),Qs=function(){function t(t){this.fields=t,t.sort(Mo.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return _o(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),$s=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!os(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.isEqual=function(t){return Qo(this.proto,t.proto)},t}(),Ys=function(){function t(t){void 0===t&&(t=$s.empty()),this.I=t,this.A=new Map}return t.prototype.set=function(t,e){return this.R(t,e),this},t.prototype.delete=function(t){return this.R(t,null),this},t.prototype.R=function(t,e){for(var n=this.A,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Wo(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.lastSegment(),e)},t.prototype.v=function(){var t=this.P(Mo.emptyPath(),this.A);return null!=t?new $s(t):this.I},t.prototype.P=function(t,e){var n=this,r=!1,i=this.I.field(t),o=os(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.P(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function Js(t){var e=[];return ko(t.fields||{},(function(t,n){var r=new Mo([t]);if(os(n)){var i=Js(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new Qs(e)}function Xs(t,e){if(t.V){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ao(e)?"-0":e}}function Zs(t){return{integerValue:""+t}}function ta(t,e){return Do(e)?Zs(e):Xs(t,e)}var ea=function(){this._=void 0};function na(t,e,n){return t instanceof oa?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof sa?aa(t,e):t instanceof ua?ca(t,e):function(t,e){var n=ia(t,e),r=ha(n)+ha(t.S);return es(n)&&es(t.S)?Zs(r):Xs(t.D,r)}(t,e)}function ra(t,e,n){return t instanceof sa?aa(t,e):t instanceof ua?ca(t,e):n}function ia(t,e){return t instanceof la?es(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var oa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oo(e,t),e}(ea),sa=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return oo(e,t),e}(ea);function aa(t,e){for(var n=fa(e),r=function(t){n.some((function(e){return Qo(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ua=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return oo(e,t),e}(ea);function ca(t,e){for(var n=fa(e),r=function(t){n=n.filter((function(e){return!Qo(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var la=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).D=e,r.S=n,r}return oo(e,t),e}(ea);function ha(t){return qo(t.integerValue||t.doubleValue)}function fa(t){return ns(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var pa=function(t,e){this.field=t,this.transform=e},da=function(t,e){this.version=t,this.transformResults=e},ga=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function va(t,e){return void 0!==t.updateTime?e instanceof as&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof as}var ya=function(){};function ma(t,e,n){return t instanceof _a?function(t,e,n){var r=t.value,i=ka(t.fieldTransforms,e,n.transformResults);return r=Na(t.fieldTransforms,r,i),new as(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Sa?function(t,e,n){if(!va(t.precondition,e))return new cs(t.key,n.version);var r=Ta(t,e,ka(t.fieldTransforms,e,n.transformResults));return new as(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new us(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function ba(t,e,n){return t instanceof _a?function(t,e,n){if(!va(t.precondition,e))return e;var r=t.value,i=xa(t.fieldTransforms,n,e);r=Na(t.fieldTransforms,r,i);var o=Ia(e);return new as(t.key,o,r,{hasLocalMutations:!0})}(t,e,n):t instanceof Sa?function(t,e,n){if(!va(t.precondition,e))return e;var r=Ia(e),i=Ta(t,e,xa(t.fieldTransforms,n,e));return new as(t.key,r,i,{hasLocalMutations:!0})}(t,e,n):function(t,e){return va(t.precondition,e)?new us(t.key,Ws.min()):e}(t,e)}function wa(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof as?e.field(o.field):void 0,a=ia(o.transform,s||null);null!=a&&(n=null==n?(new Ys).set(o.field,a):n.set(o.field,a))}return n?n.v():null}(t.fieldTransforms,e)}function Ea(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&_o(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof sa&&e instanceof sa||t instanceof ua&&e instanceof ua?_o(t.elements,e.elements,Qo):t instanceof la&&e instanceof la?Qo(t.S,e.S):t instanceof oa&&e instanceof oa}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Ia(t){return t instanceof as?t.version:Ws.min()}var _a=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return oo(e,t),e}(ya),Sa=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.fieldMask=r,s.precondition=i,s.fieldTransforms=o,s.type=1,s}return oo(e,t),e}(ya);function Ta(t,e,n){var r;return r=function(t,e){var n=new Ys(e);return t.fieldMask.fields.forEach((function(e){if(!e.isEmpty()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.v()}(t,r=e instanceof as?e.data():$s.empty()),Na(t.fieldTransforms,r,n)}function ka(t,e,n){var r=[];mo(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=null;e instanceof as&&(a=e.field(o.field)),r.push(ra(s,a,n[i]))}return r}function xa(t,e,n){for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=null;n instanceof as&&(u=n.field(s.field)),r.push(na(a,u,e))}return r}function Na(t,e,n){for(var r=new Ys(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.v()}var Aa,Da,Ca=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return oo(e,t),e}(ya),Oa=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return oo(e,t),e}(ya),La=function(t){this.count=t};function Ra(t){switch(t){case Co.OK:return yo();case Co.CANCELLED:case Co.UNKNOWN:case Co.DEADLINE_EXCEEDED:case Co.RESOURCE_EXHAUSTED:case Co.INTERNAL:case Co.UNAVAILABLE:case Co.UNAUTHENTICATED:return!1;case Co.INVALID_ARGUMENT:case Co.NOT_FOUND:case Co.ALREADY_EXISTS:case Co.PERMISSION_DENIED:case Co.FAILED_PRECONDITION:case Co.ABORTED:case Co.OUT_OF_RANGE:case Co.UNIMPLEMENTED:case Co.DATA_LOSS:return!0;default:return yo()}}function Pa(t){if(void 0===t)return po("GRPC error has no .code"),Co.UNKNOWN;switch(t){case Aa.OK:return Co.OK;case Aa.CANCELLED:return Co.CANCELLED;case Aa.UNKNOWN:return Co.UNKNOWN;case Aa.DEADLINE_EXCEEDED:return Co.DEADLINE_EXCEEDED;case Aa.RESOURCE_EXHAUSTED:return Co.RESOURCE_EXHAUSTED;case Aa.INTERNAL:return Co.INTERNAL;case Aa.UNAVAILABLE:return Co.UNAVAILABLE;case Aa.UNAUTHENTICATED:return Co.UNAUTHENTICATED;case Aa.INVALID_ARGUMENT:return Co.INVALID_ARGUMENT;case Aa.NOT_FOUND:return Co.NOT_FOUND;case Aa.ALREADY_EXISTS:return Co.ALREADY_EXISTS;case Aa.PERMISSION_DENIED:return Co.PERMISSION_DENIED;case Aa.FAILED_PRECONDITION:return Co.FAILED_PRECONDITION;case Aa.ABORTED:return Co.ABORTED;case Aa.OUT_OF_RANGE:return Co.OUT_OF_RANGE;case Aa.UNIMPLEMENTED:return Co.UNIMPLEMENTED;case Aa.DATA_LOSS:return Co.DATA_LOSS;default:return yo()}}(Da=Aa||(Aa={}))[Da.OK=0]="OK",Da[Da.CANCELLED=1]="CANCELLED",Da[Da.UNKNOWN=2]="UNKNOWN",Da[Da.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Da[Da.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Da[Da.NOT_FOUND=5]="NOT_FOUND",Da[Da.ALREADY_EXISTS=6]="ALREADY_EXISTS",Da[Da.PERMISSION_DENIED=7]="PERMISSION_DENIED",Da[Da.UNAUTHENTICATED=16]="UNAUTHENTICATED",Da[Da.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Da[Da.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Da[Da.ABORTED=10]="ABORTED",Da[Da.OUT_OF_RANGE=11]="OUT_OF_RANGE",Da[Da.UNIMPLEMENTED=12]="UNIMPLEMENTED",Da[Da.INTERNAL=13]="INTERNAL",Da[Da.UNAVAILABLE=14]="UNAVAILABLE",Da[Da.DATA_LOSS=15]="DATA_LOSS";var Ma=function(){function t(t,e){this.comparator=t,this.root=e||Ua.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ua.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ua.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Fa(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Fa(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Fa(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Fa(this.root,t,this.comparator,!0)},t}(),Fa=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Ua=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw yo();if(this.right.isRed())throw yo();var t=this.left.check();if(t!==this.right.check())throw yo();return t+(this.isRed()?0:1)},t}();Ua.EMPTY=null,Ua.RED=!0,Ua.BLACK=!1,Ua.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw yo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw yo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw yo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw yo()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw yo()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Ua(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var ja=function(){function t(t){this.comparator=t,this.data=new Ma(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Va(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Va(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Va=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),qa=new Ma(Fo.comparator);function Ba(){return qa}function Ka(){return Ba()}var za=new Ma(Fo.comparator);function Ga(){return za}var Ha=new Ma(Fo.comparator);function Wa(){return Ha}var Qa=new ja(Fo.comparator);function $a(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Qa,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ya=new ja(Io);function Ja(){return Ya}var Xa=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Za.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(Ws.min(),r,Ja(),Ba(),$a())},t}(),Za=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Uo.EMPTY_BYTE_STRING,n,$a(),$a(),$a())},t}(),tu=function(t,e,n,r){this.C=t,this.removedTargetIds=e,this.key=n,this.N=r},eu=function(t,e){this.targetId=t,this.$=e},nu=function(t,e,n,r){void 0===n&&(n=Uo.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ru=function(){function t(){this.F=0,this.O=su(),this.k=Uo.EMPTY_BYTE_STRING,this.M=!1,this.L=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.M},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.k},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"B",{get:function(){return 0!==this.F},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"q",{get:function(){return this.L},enumerable:!1,configurable:!0}),t.prototype.U=function(t){t.approximateByteSize()>0&&(this.L=!0,this.k=t)},t.prototype.K=function(){var t=$a(),e=$a(),n=$a();return this.O.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:yo()}})),new Za(this.k,this.M,t,e,n)},t.prototype.W=function(){this.L=!1,this.O=su()},t.prototype.j=function(t,e){this.L=!0,this.O=this.O.insert(t,e)},t.prototype.G=function(t){this.L=!0,this.O=this.O.remove(t)},t.prototype.H=function(){this.F+=1},t.prototype.J=function(){this.F-=1},t.prototype.Y=function(){this.L=!0,this.M=!0},t}(),iu=function(){function t(t){this.X=t,this.Z=new Map,this.tt=Ba(),this.et=ou(),this.nt=new ja(Io)}return t.prototype.st=function(t){for(var e=0,n=t.C;e<n.length;e++){var r=n[e];t.N instanceof as?this.it(r,t.N):t.N instanceof us&&this.rt(r,t.key,t.N)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.rt(r,t.key,t.N)},t.prototype.ot=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.ct(n);switch(t.state){case 0:e.at(n)&&r.U(t.resumeToken);break;case 1:r.J(),r.B||r.W(),r.U(t.resumeToken);break;case 2:r.J(),r.B||e.removeTarget(n);break;case 3:e.at(n)&&(r.Y(),r.U(t.resumeToken));break;case 4:e.at(n)&&(e.ut(n),r.U(t.resumeToken));break;default:yo()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Z.forEach((function(t,r){n.at(r)&&e(r)}))},t.prototype.ht=function(t){var e=t.targetId,n=t.$.count,r=this.lt(e);if(r){var i=r.target;if(ds(i))if(0===n){var o=new Fo(i.path);this.rt(e,o,new us(o,Ws.min()))}else mo(1===n);else this.ft(e)!==n&&(this.ut(e),this.nt=this.nt.add(e))}},t.prototype.dt=function(t){var e=this,n=new Map;this.Z.forEach((function(r,i){var o=e.lt(i);if(o){if(r.current&&ds(o.target)){var s=new Fo(o.target.path);null!==e.tt.get(s)||e.wt(i,s)||e.rt(i,s,new us(s,t))}r.q&&(n.set(i,r.K()),r.W())}}));var r=$a();this.et.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.lt(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Xa(t,n,this.nt,this.tt,r);return this.tt=Ba(),this.et=ou(),this.nt=new ja(Io),i},t.prototype.it=function(t,e){if(this.at(t)){var n=this.wt(t,e.key)?2:0;this.ct(t).j(e.key,n),this.tt=this.tt.insert(e.key,e),this.et=this.et.insert(e.key,this._t(e.key).add(t))}},t.prototype.rt=function(t,e,n){if(this.at(t)){var r=this.ct(t);this.wt(t,e)?r.j(e,1):r.G(e),this.et=this.et.insert(e,this._t(e).delete(t)),n&&(this.tt=this.tt.insert(e,n))}},t.prototype.removeTarget=function(t){this.Z.delete(t)},t.prototype.ft=function(t){var e=this.ct(t).K();return this.X.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.H=function(t){this.ct(t).H()},t.prototype.ct=function(t){var e=this.Z.get(t);return e||(e=new ru,this.Z.set(t,e)),e},t.prototype._t=function(t){var e=this.et.get(t);return e||(e=new ja(Io),this.et=this.et.insert(t,e)),e},t.prototype.at=function(t){var e=null!==this.lt(t);return e||fo("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.lt=function(t){var e=this.Z.get(t);return e&&e.B?null:this.X.yt(t)},t.prototype.ut=function(t){var e=this;this.Z.set(t,new ru),this.X.getRemoteKeysForTarget(t).forEach((function(n){e.rt(t,n,null)}))},t.prototype.wt=function(t,e){return this.X.getRemoteKeysForTarget(t).has(e)},t}();function ou(){return new Ma(Fo.comparator)}function su(){return new Ma(Fo.comparator)}var au={asc:"ASCENDING",desc:"DESCENDING"},uu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cu=function(t,e){this.databaseId=t,this.V=e};function lu(t,e){return t.V?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function hu(t,e){return t.V?e.toBase64():e.toUint8Array()}function fu(t,e){return lu(t,e.toTimestamp())}function pu(t){return mo(!!t),Ws.fromTimestamp(function(t){var e=Vo(t);return new Ko(e.seconds,e.nanos)}(t))}function du(t,e){return function(t){return new Ro(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function gu(t){var e=Ro.fromString(t);return mo(ju(e)),e}function vu(t,e){return du(t.databaseId,e.path)}function yu(t,e){var n=gu(e);if(n.get(1)!==t.databaseId.projectId)throw new Oo(Co.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Oo(Co.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Fo(Eu(n))}function mu(t,e){return du(t.databaseId,e)}function bu(t){var e=gu(t);return 4===e.length?Ro.emptyPath():Eu(e)}function wu(t){return new Ro(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Eu(t){return mo(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Iu(t,e,n){return{name:vu(t,e),fields:n.proto.mapValue.fields}}function _u(t,e,n){var r=yu(t,e.name),i=pu(e.updateTime),o=new $s({mapValue:{fields:e.fields}});return new as(r,i,o,{hasCommittedMutations:!!n})}function Su(t,e){var n;if(e instanceof _a)n={update:Iu(t,e.key,e.value)};else if(e instanceof Ca)n={delete:vu(t,e.key)};else if(e instanceof Sa)n={update:Iu(t,e.key,e.data),updateMask:Uu(e.fieldMask)};else{if(!(e instanceof Oa))return yo();n={verify:vu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof oa)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof sa)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof ua)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof la)return{fieldPath:e.field.canonicalString(),increment:n.S};throw yo()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:fu(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:yo()}(t,e.precondition)),n}function Tu(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?ga.updateTime(pu(t.updateTime)):void 0!==t.exists?ga.exists(t.exists):ga.none()}(e.currentDocument):ga.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)mo("REQUEST_TIME"===e.setToServerValue),n=new oa;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new sa(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new ua(i)}else"increment"in e?n=new la(t,e.increment):yo();var o=Mo.fromServerFormat(e.fieldPath);return new pa(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=yu(t,e.update.name),o=new $s({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new Qs(e.map((function(t){return Mo.fromServerFormat(t)})))}(e.updateMask);return new Sa(i,o,s,n,r)}return new _a(i,o,n,r)}if(e.delete){var a=yu(t,e.delete);return new Ca(a,n)}if(e.verify){var u=yu(t,e.verify);return new Oa(u,n)}return yo()}function ku(t,e){return{documents:[mu(t,e.path)]}}function xu(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=mu(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=mu(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(is(t.value))return{unaryFilter:{field:Ru(t.field),op:"IS_NAN"}};if(rs(t.value))return{unaryFilter:{field:Ru(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(is(t.value))return{unaryFilter:{field:Ru(t.field),op:"IS_NOT_NAN"}};if(rs(t.value))return{unaryFilter:{field:Ru(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ru(t.field),op:Lu(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Ru(t.field),direction:Ou(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.V||No(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Du(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Du(e.endAt)),n}function Nu(t){var e=bu(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){mo(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Au(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new ks(Pu(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return No(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Cu(n.startAt));var l=null;return n.endAt&&(l=Cu(n.endAt)),Cs(e,i,a,s,u,"F",c,l)}function Au(t){return t?void 0!==t.unaryFilter?[Fu(t)]:void 0!==t.fieldFilter?[Mu(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Au(t)})).reduce((function(t,e){return t.concat(e)})):yo():[]}function Du(t){return{before:t.before,values:t.position}}function Cu(t){var e=!!t.before,n=t.values||[];return new Ss(n,e)}function Ou(t){return au[t]}function Lu(t){return uu[t]}function Ru(t){return{fieldPath:t.canonicalString()}}function Pu(t){return Mo.fromServerFormat(t.fieldPath)}function Mu(t){return gs.create(Pu(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return yo()}}(t.fieldFilter.op),t.fieldFilter.value)}function Fu(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Pu(t.unaryFilter.field);return gs.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Pu(t.unaryFilter.field);return gs.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Pu(t.unaryFilter.field);return gs.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Pu(t.unaryFilter.field);return gs.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return yo()}}function Uu(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function ju(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Vu(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Bu(e)),e=qu(t.get(n),e);return Bu(e)}function qu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Bu(t){return t+""}function Ku(t){var e=t.length;if(mo(e>=2),2===e)return mo(""===t.charAt(0)&&""===t.charAt(1)),Ro.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&yo(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:yo()}o=s+2}return new Ro(r)}var zu=function(t,e){this.seconds=t,this.nanoseconds=e},Gu=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Gu.store="owner",Gu.key="owner";var Hu=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Hu.store="mutationQueues",Hu.keyPath="userId";var Wu=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Wu.store="mutations",Wu.keyPath="batchId",Wu.userMutationsIndex="userMutationsIndex",Wu.userMutationsKeyPath=["userId","batchId"];var Qu=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Vu(e)]},t.key=function(t,e,n){return[t,Vu(e),n]},t}();Qu.store="documentMutations",Qu.PLACEHOLDER=new Qu;var $u=function(t,e){this.path=t,this.readTime=e},Yu=function(t,e){this.path=t,this.version=e},Ju=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ju.store="remoteDocuments",Ju.readTimeIndex="readTimeIndex",Ju.readTimeIndexPath="readTime",Ju.collectionReadTimeIndex="collectionReadTimeIndex",Ju.collectionReadTimeIndexPath=["parentPath","readTime"];var Xu=function(t){this.byteSize=t};Xu.store="remoteDocumentGlobal",Xu.key="remoteDocumentGlobalKey";var Zu=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Zu.store="targets",Zu.keyPath="targetId",Zu.queryTargetsIndexName="queryTargetsIndex",Zu.queryTargetsKeyPath=["canonicalId","targetId"];var tc=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};tc.store="targetDocuments",tc.keyPath=["targetId","path"],tc.documentTargetsIndex="documentTargetsIndex",tc.documentTargetsKeyPath=["path","targetId"];var ec=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ec.key="targetGlobalKey",ec.store="targetGlobal";var nc=function(t,e){this.collectionId=t,this.parent=e};nc.store="collectionParents",nc.keyPath=["collectionId","parent"];var rc=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};rc.store="clientMetadata",rc.keyPath="clientId";var ic=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};ic.store="bundles",ic.keyPath="bundleId";var oc=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};oc.store="namedQueries",oc.keyPath="name";var sc=uo(uo([],uo(uo([],uo(uo([],uo(uo([],[Hu.store,Wu.store,Qu.store,Ju.store,Zu.store,Gu.store,ec.store,tc.store]),[rc.store])),[Xu.store])),[nc.store])),[ic.store,oc.store]),ac="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",uc=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),cc=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},lc=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&yo(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),hc=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.gt=new cc,this.transaction.oncomplete=function(){n.gt.resolve()},this.transaction.onabort=function(){e.error?n.gt.reject(new dc(t,e.error)):n.gt.resolve()},this.transaction.onerror=function(e){var r=bc(e.target.error);n.gt.reject(new dc(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new dc(n,e)}},Object.defineProperty(t.prototype,"Et",{get:function(){return this.gt.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.gt.reject(t),this.aborted||(fo("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new vc(e)},t}(),fc=function(){function t(e,n,r){this.name=e,this.version=n,this.Tt=r,12.2===t.It(lt())&&po("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return fo("SimpleDb","Removing database:",t),yc(window.indexedDB.deleteDatabase(t)).toPromise()},t.At=function(){if("undefined"==typeof indexedDB)return!1;if(t.Rt())return!0;var e=lt(),n=t.It(e),r=0<n&&n<10,i=t.bt(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Rt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.vt)},t.Pt=function(t,e){return t.store(e)},t.It=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.bt=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Vt=function(t){return so(this,void 0,void 0,(function(){var e,n=this;return ao(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(fo("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new dc(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Oo(Co.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new dc(t,n))},i.onupgradeneeded=function(t){fo("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Tt.St(e,i.transaction,t.oldVersion,n.version).next((function(){fo("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Dt&&(this.db.onversionchange=function(t){return n.Dt(t)}),this.db)]}}))}))},t.prototype.Ct=function(t){this.Dt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return so(this,void 0,void 0,(function(){var i,o,s,a,u;return ao(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,l;return ao(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,a.Vt(t)];case 2:return a.db=h.sent(),e=hc.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),lc.reject(t)})).toPromise(),u={},s.catch((function(){})),[4,e.Et];case 3:return[2,(u.value=(h.sent(),s),u)];case 4:return c=h.sent(),l="FirebaseError"!==c.name&&o<3,fo("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),a.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),pc=function(){function t(t){this.xt=t,this.Nt=!1,this.$t=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Nt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ft",{get:function(){return this.$t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.xt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Nt=!0},t.prototype.Ot=function(t){this.$t=t},t.prototype.delete=function(){return yc(this.xt.delete())},t}(),dc=function(t){function e(e,n){var r=this;return(r=t.call(this,Co.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return oo(e,t),e}(Oo);function gc(t){return"IndexedDbTransactionError"===t.name}var vc=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(fo("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(fo("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),yc(n)},t.prototype.add=function(t){return fo("SimpleDb","ADD",this.store.name,t,t),yc(this.store.add(t))},t.prototype.get=function(t){var e=this;return yc(this.store.get(t)).next((function(n){return void 0===n&&(n=null),fo("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return fo("SimpleDb","DELETE",this.store.name,t),yc(this.store.delete(t))},t.prototype.count=function(){return fo("SimpleDb","COUNT",this.store.name),yc(this.store.count())},t.prototype.kt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Mt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Lt=function(t,e){fo("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Bt=!1;var r=this.cursor(n);return this.Mt(r,(function(t,e,n){return n.delete()}))},t.prototype.qt=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Mt(r,e)},t.prototype.Ut=function(t){var e=this.cursor({});return new lc((function(n,r){e.onerror=function(t){var e=bc(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.Mt=function(t,e){var n=[];return new lc((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new pc(i),s=e(i.primaryKey,i.value,o);if(s instanceof lc){var a=s.catch((function(t){return o.done(),lc.reject(t)}));n.push(a)}o.isDone?r():null===o.Ft?i.continue():i.continue(o.Ft)}else r()}})).next((function(){return lc.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Bt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function yc(t){return new lc((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=bc(t.target.error);n(e)}}))}var mc=!1;function bc(t){var e=fc.It(lt());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Oo("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return mc||(mc=!0,setTimeout((function(){throw r}),0)),r}}return t}var wc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qt=e,r.currentSequenceNumber=n,r}return oo(e,t),e}(uc);function Ec(t,e){var n=bo(t);return fc.Pt(n.Qt,e)}var Ic=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e,n){for(var r=n.mutationResults,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ma(o,e,r[i]))}return e},t.prototype.applyToLocalView=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=ba(s,e,this.localWriteTime));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=ba(s,e,this.localWriteTime))}return e},t.prototype.applyToLocalDocumentSet=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.applyToLocalView(r.key,t.get(r.key));i&&(n=n.insert(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),$a())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&_o(this.mutations,t.mutations,(function(t,e){return Ea(t,e)}))&&_o(this.baseMutations,t.baseMutations,(function(t,e){return Ea(t,e)}))},t}(),_c=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){mo(e.mutations.length===r.length);for(var i=Wa(),o=e.mutations,s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Sc=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=Ws.min()),void 0===o&&(o=Ws.min()),void 0===s&&(s=Uo.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Tc=function(t){this.Kt=t};function kc(t,e){if(e.document)return _u(t.Kt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Fo.fromSegments(e.noDocument.path),r=Cc(e.noDocument.readTime);return new us(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Fo.fromSegments(e.unknownDocument.path);return r=Cc(e.unknownDocument.version),new cs(i,r)}return yo()}function xc(t,e,n){var r=Nc(n),i=e.key.path.popLast().toArray();if(e instanceof as){var o=function(t,e){return{name:vu(t,e.key),fields:e.toProto().mapValue.fields,updateTime:lu(t,e.version.toTimestamp())}}(t.Kt,e),s=e.hasCommittedMutations;return new Ju(null,null,o,s,r,i)}if(e instanceof us){var a=e.key.path.toArray(),u=Dc(e.version);return s=e.hasCommittedMutations,new Ju(null,new $u(a,u),null,s,r,i)}if(e instanceof cs){var c=e.key.path.toArray(),l=Dc(e.version);return new Ju(new Yu(c,l),null,null,!0,r,i)}return yo()}function Nc(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ac(t){var e=new Ko(t[0],t[1]);return Ws.fromTimestamp(e)}function Dc(t){var e=t.toTimestamp();return new zu(e.seconds,e.nanoseconds)}function Cc(t){var e=new Ko(t.seconds,t.nanoseconds);return Ws.fromTimestamp(e)}function Oc(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Tu(t.Kt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return Tu(t.Kt,e)})),a=Ko.fromMillis(e.localWriteTimeMs);return new Ic(e.batchId,a,n,s)}function Lc(t){var e,n,r=Cc(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Cc(t.lastLimboFreeSnapshotVersion):Ws.min();return void 0!==t.query.documents?(mo(1===(n=t.query).documents.length),e=js(Os(bu(n.documents[0])))):e=function(t){return js(Nu(t))}(t.query),new Sc(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Uo.fromBase64String(t.resumeToken))}function Rc(t,e){var n,r=Dc(e.snapshotVersion),i=Dc(e.lastLimboFreeSnapshotVersion);n=ds(e.target)?ku(t.Kt,e.target):xu(t.Kt,e.target);var o=e.resumeToken.toBase64();return new Zu(e.targetId,fs(e.target),r,o,e.sequenceNumber,i,n)}function Pc(t){var e=Nu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Vs(e,e.limit,"L"):e}var Mc=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Fc(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Cc(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Fc(t).put({bundleId:(n=e).id,createTime:Dc(pu(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return Uc(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Pc(e.bundledQuery),readTime:Cc(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return Uc(t).put(function(t){return{name:t.name,readTime:Dc(pu(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Fc(t){return Ec(t,ic.store)}function Uc(t){return Ec(t,oc.store)}var jc=function(){function t(){this.Wt=new Vc}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Wt.add(e),lc.resolve()},t.prototype.getCollectionParents=function(t,e){return lc.resolve(this.Wt.getEntries(e))},t}(),Vc=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new ja(Ro.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new ja(Ro.comparator)).toArray()},t}(),qc=function(){function t(){this.jt=new Vc}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.jt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.jt.add(e)}));var o={collectionId:r,parent:Vu(i)};return Bc(t).put(o)}return lc.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[So(e),""],!1,!0);return Bc(t).kt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Ku(o.parent))}return n}))},t}();function Bc(t){return Ec(t,nc.store)}var Kc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},zc=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function Gc(t,e,n){var r=t.store(Wu.store),i=t.store(Qu.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.qt({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){mo(1===a)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],p=Qu.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return lc.waitFor(o).next((function(){return c}))}function Hc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw yo();e=t.noDocument}return JSON.stringify(e).length}zc.DEFAULT_COLLECTION_PERCENTILE=10,zc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zc.DEFAULT=new zc(41943040,zc.DEFAULT_COLLECTION_PERCENTILE,zc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zc.DISABLED=new zc(-1,0,0);var Wc=function(){function t(t,e,n,r){this.userId=t,this.D=e,this.Gt=n,this.referenceDelegate=r,this.zt={}}return t.Ht=function(e,n,r,i){return mo(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return $c(t).qt({index:Wu.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Yc(t),s=$c(t);return s.add({}).next((function(a){mo("number"==typeof a);for(var u=new Ic(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Su(t.Kt,e)})),i=n.mutations.map((function(e){return Su(t.Kt,e)}));return new Wu(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.D,i.userId,u),l=[],h=new ja((function(t,e){return Io(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],g=Qu.key(i.userId,d.key.path,a);h=h.add(d.key.path.popLast()),l.push(s.put(c)),l.push(o.put(g,Qu.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Gt.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.zt[a]=u.keys()})),lc.waitFor(l).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return $c(t).get(e).next((function(t){return t?(mo(t.userId===n.userId),Oc(n.D,t)):null}))},t.prototype.Jt=function(t,e){var n=this;return this.zt[e]?lc.resolve(this.zt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.zt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return $c(t).qt({index:Wu.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(mo(e.batchId>=r),o=Oc(n.D,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return $c(t).qt({index:Wu.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return $c(t).kt(Wu.userMutationsIndex,n).next((function(t){return t.map((function(t){return Oc(e.D,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Qu.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Yc(t).qt({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],l=Ku(u);if(a===n.userId&&e.path.isEqual(l))return $c(t).get(c).next((function(t){if(!t)throw yo();mo(t.userId===n.userId),o.push(Oc(n.D,t))}));s.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new ja(Io),i=[];return e.forEach((function(e){var o=Qu.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Yc(t).qt({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=Ku(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),lc.waitFor(i).next((function(){return n.Yt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Qu.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new ja(Io);return Yc(t).qt({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],l=Ku(u);s===n.userId&&r.isPrefixOf(l)?l.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Yt(t,a)}))},t.prototype.Yt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push($c(t).get(e).next((function(t){if(null===t)throw yo();mo(t.userId===n.userId),r.push(Oc(n.D,t))})))})),lc.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return Gc(t.Qt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Xt(e.batchId)})),lc.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Xt=function(t){delete this.zt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return lc.resolve();var r=IDBKeyRange.lowerBound(Qu.prefixForUser(e.userId)),i=[];return Yc(t).qt({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Ku(t[1]);i.push(o)}else r.done()})).next((function(){mo(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return Qc(t,this.userId,e)},t.prototype.Zt=function(t){var e=this;return Jc(t).get(this.userId).next((function(t){return t||new Hu(e.userId,-1,"")}))},t}();function Qc(t,e,n){var r=Qu.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Yc(t).qt({range:o,Bt:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function $c(t){return Ec(t,Wu.store)}function Yc(t){return Ec(t,Qu.store)}function Jc(t){return Ec(t,Hu.store)}var Xc=function(){function t(t){this.te=t}return t.prototype.next=function(){return this.te+=2,this.te},t.ee=function(){return new t(0)},t.ne=function(){return new t(-1)},t}(),Zc=function(){function t(t,e){this.referenceDelegate=t,this.D=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.se(t).next((function(n){var r=new Xc(n.highestTargetId);return n.highestTargetId=r.next(),e.ie(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.se(t).next((function(t){return Ws.fromTimestamp(new Ko(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.se(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.se(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.ie(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.re(t,e).next((function(){return n.se(t).next((function(r){return r.targetCount+=1,n.oe(e,r),n.ie(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.re(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return tl(t).delete(e.targetId)})).next((function(){return n.se(t)})).next((function(e){return mo(e.targetCount>0),e.targetCount-=1,n.ie(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return tl(t).qt((function(s,a){var u=Lc(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return lc.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return tl(t).qt((function(t,n){var r=Lc(n);e(r)}))},t.prototype.se=function(t){return el(t).get(ec.key).next((function(t){return mo(null!==t),t}))},t.prototype.ie=function(t,e){return el(t).put(ec.key,e)},t.prototype.re=function(t,e){return tl(t).put(Rc(this.D,e))},t.prototype.oe=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.se(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=fs(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return tl(t).qt({range:r,index:Zu.queryTargetsIndexName},(function(t,n,r){var o=Lc(n);ps(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=nl(t);return e.forEach((function(e){var s=Vu(e.path);i.push(o.put(new tc(n,s))),i.push(r.referenceDelegate.addReference(t,n,e))})),lc.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=nl(t);return lc.forEach(e,(function(e){var o=Vu(e.path);return lc.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=nl(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=nl(t),i=$a();return r.qt({range:n,Bt:!0},(function(t,e,n){var r=Ku(t[1]),o=new Fo(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Vu(e.path),r=IDBKeyRange.bound([n],[So(n)],!1,!0),i=0;return nl(t).qt({index:tc.documentTargetsIndex,Bt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.yt=function(t,e){return tl(t).get(e).next((function(t){return t?Lc(t):null}))},t}();function tl(t){return Ec(t,Zu.store)}function el(t){return Ec(t,ec.store)}function nl(t){return Ec(t,tc.store)}function rl(t){return so(this,void 0,void 0,(function(){return ao(this,(function(e){if(t.code!==Co.FAILED_PRECONDITION||t.message!==ac)throw t;return fo("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function il(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Io(n,i);return 0===s?Io(r,o):s}var ol=function(){function t(t){this.ce=t,this.buffer=new ja(il),this.ae=0}return t.prototype.ue=function(){return++this.ae},t.prototype.he=function(t){var e=[t,this.ue()];if(this.buffer.size<this.ce)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();il(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),sl=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.le=!1,this.fe=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.de(t)},t.prototype.stop=function(){this.fe&&(this.fe.cancel(),this.fe=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.fe},enumerable:!1,configurable:!0}),t.prototype.de=function(t){var e=this,n=this.le?3e5:6e4;fo("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.fe=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return so(e,void 0,void 0,(function(){var e;return ao(this,(function(n){switch(n.label){case 0:this.fe=null,this.le=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return gc(e=n.sent())?(fo("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,rl(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.de(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),al=function(){function t(t,e){this.we=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.we._e(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return lc.resolve(co.o);var r=new ol(e);return this.we.forEachTarget(t,(function(t){return r.he(t.sequenceNumber)})).next((function(){return n.we.me(t,(function(t){return r.he(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.we.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.we.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(fo("LruGarbageCollector","Garbage collection skipped; disabled"),lc.resolve(Kc)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(fo("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Kc):n.ye(t,e)}))},t.prototype.getCacheSize=function(t){return this.we.getCacheSize(t)},t.prototype.ye=function(t,e){var n,r,i,o,s,a,u,c=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(fo("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),ho()<=At.DEBUG&&fo("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-l)+"ms"),lc.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),ul=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new al(t,e)}(this,e)}return t.prototype._e=function(t){var e=this.ge(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.ge=function(t){var e=0;return this.me(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.me=function(t,e){return this.pe(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return cl(t,n)},t.prototype.removeReference=function(t,e,n){return cl(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return cl(t,e)},t.prototype.Ee=function(t,e){return function(t,e){var n=!1;return Jc(t).Ut((function(r){return Qc(t,r,e).next((function(t){return t&&(n=!0),lc.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.pe(t,(function(s,a){if(a<=e){var u=n.Ee(t,s).next((function(e){if(!e)return o++,r.getEntry(t,s).next((function(){return r.removeEntry(s),nl(t).delete([0,Vu(s.path)])}))}));i.push(u)}})).next((function(){return lc.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return cl(t,e)},t.prototype.pe=function(t,e){var n,r=nl(t),i=co.o;return r.qt({index:tc.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),a=r.sequenceNumber;0===o?(i!==co.o&&e(new Fo(Ku(n)),i),i=a,n=s):i=co.o})).next((function(){i!==co.o&&e(new Fo(Ku(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function cl(t,e){return nl(t).put(function(t,e){return new tc(0,Vu(t.path),e)}(e,t.currentSequenceNumber))}var ll=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.equalsFn(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){ko(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.isEmpty=function(){return xo(this.inner)},t}(),hl=function(){function t(){this.changes=new ll((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:Ws.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{maybeDocument:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{maybeDocument:null,readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?lc.resolve(n.maybeDocument):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),fl=function(){function t(t,e){this.D=t,this.Gt=e}return t.prototype.addEntry=function(t,e,n){return gl(t).put(vl(e),n)},t.prototype.removeEntry=function(t,e){var n=gl(t),r=vl(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Te(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return gl(t).get(vl(e)).next((function(t){return n.Ie(t)}))},t.prototype.Ae=function(t,e){var n=this;return gl(t).get(vl(e)).next((function(t){var e=n.Ie(t);return e?{maybeDocument:e,size:Hc(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Ka();return this.Re(t,e,(function(t,e){var i=n.Ie(e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.be=function(t,e){var n=this,r=Ka(),i=new Ma(Fo.comparator);return this.Re(t,e,(function(t,e){var o=n.Ie(e);o?(r=r.insert(t,o),i=i.insert(t,Hc(e))):(r=r.insert(t,null),i=i.insert(t,0))})).next((function(){return{ve:r,Pe:i}}))},t.prototype.Re=function(t,e,n){if(e.isEmpty())return lc.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return gl(t).qt({range:r},(function(t,e,r){for(var s=Fo.fromSegments(t);o&&Fo.comparator(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ot(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Ga(),o=e.path.length+1,s={};if(n.isEqual(Ws.min())){var a=e.path.toArray();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.toArray(),c=Nc(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Ju.collectionReadTimeIndex}return gl(t).qt(s,(function(t,n,s){if(t.length===o){var a=kc(r.D,n);e.path.isPrefixOf(a.key.path)?a instanceof as&&zs(e,a)&&(i=i.insert(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new pl(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return dl(t).get(Xu.key).next((function(t){return mo(!!t),t}))},t.prototype.Te=function(t,e){return dl(t).put(Xu.key,e)},t.prototype.Ie=function(t){if(t){var e=kc(this.D,t);return e instanceof us&&e.version.isEqual(Ws.min())?null:e}return null},t}(),pl=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ve=e,r.trackRemovals=n,r.Se=new ll((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return oo(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new ja((function(t,e){return Io(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,s){var a=e.Se.get(o);if(s.maybeDocument){var u=xc(e.Ve.D,s.maybeDocument,e.getReadTime(o));i=i.add(o.path.popLast());var c=Hc(u);r+=c-a,n.push(e.Ve.addEntry(t,o,u))}else if(r-=a,e.trackRemovals){var l=xc(e.Ve.D,new us(o,Ws.min()),e.getReadTime(o));n.push(e.Ve.addEntry(t,o,l))}else n.push(e.Ve.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ve.Gt.addToCollectionParentIndex(t,r))})),n.push(this.Ve.updateMetadata(t,r)),lc.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ve.Ae(t,e).next((function(t){return null===t?(n.Se.set(e,0),null):(n.Se.set(e,t.size),t.maybeDocument)}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ve.be(t,e).next((function(t){var e=t.ve;return t.Pe.forEach((function(t,e){n.Se.set(t,e)})),e}))},e}(hl);function dl(t){return Ec(t,Xu.store)}function gl(t){return Ec(t,Ju.store)}function vl(t){return t.path.toArray()}var yl=function(){function t(t){this.D=t}return t.prototype.St=function(t,e,n,r){var i=this;mo(n<r&&n>=0&&r<=11);var o=new hc("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Gu.store)}(t),function(t){t.createObjectStore(Hu.store,{keyPath:Hu.keyPath}),t.createObjectStore(Wu.store,{keyPath:Wu.keyPath,autoIncrement:!0}).createIndex(Wu.userMutationsIndex,Wu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Qu.store)}(t),ml(t),function(t){t.createObjectStore(Ju.store)}(t));var s=lc.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(tc.store),t.deleteObjectStore(Zu.store),t.deleteObjectStore(ec.store)}(t),ml(t)),s=s.next((function(){return function(t){var e=t.store(ec.store),n=new ec(0,0,Ws.min().toTimestamp(),0);return e.put(ec.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Wu.store).kt().next((function(n){t.deleteObjectStore(Wu.store),t.createObjectStore(Wu.store,{keyPath:Wu.keyPath,autoIncrement:!0}).createIndex(Wu.userMutationsIndex,Wu.userMutationsKeyPath,{unique:!0});var r=e.store(Wu.store),i=n.map((function(t){return r.put(t)}));return lc.waitFor(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(rc.store,{keyPath:rc.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.De(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Xu.store)}(t),i.Ce(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.xe(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Ne(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ju.store);e.createIndex(Ju.readTimeIndex,Ju.readTimeIndexPath,{unique:!1}),e.createIndex(Ju.collectionReadTimeIndex,Ju.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.$e(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(ic.store,{keyPath:ic.keyPath})}(t),function(t){t.createObjectStore(oc.store,{keyPath:oc.keyPath})}(t)}))),s},t.prototype.Ce=function(t){var e=0;return t.store(Ju.store).qt((function(t,n){e+=Hc(n)})).next((function(){var n=new Xu(e);return t.store(Xu.store).put(Xu.key,n)}))},t.prototype.De=function(t){var e=this,n=t.store(Hu.store),r=t.store(Wu.store);return n.kt().next((function(n){return lc.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.kt(Wu.userMutationsIndex,i).next((function(r){return lc.forEach(r,(function(r){mo(r.userId===n.userId);var i=Oc(e.D,r);return Gc(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.xe=function(t){var e=t.store(tc.store),n=t.store(Ju.store);return t.store(ec.store).get(ec.key).next((function(t){var r=[];return n.qt((function(n,i){var o=new Ro(n),s=function(t){return[0,Vu(t)]}(o);r.push(e.get(s).next((function(n){return n?lc.resolve():function(n){return e.put(new tc(0,Vu(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return lc.waitFor(r)}))}))},t.prototype.Ne=function(t,e){t.createObjectStore(nc.store,{keyPath:nc.keyPath});var n=e.store(nc.store),r=new Vc,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Vu(i)})}};return e.store(Ju.store).qt({Bt:!0},(function(t,e){var n=new Ro(t);return i(n.popLast())})).next((function(){return e.store(Qu.store).qt({Bt:!0},(function(t,e){t[0];var n=t[1],r=(t[2],Ku(n));return i(r.popLast())}))}))},t.prototype.$e=function(t){var e=this,n=t.store(Zu.store);return n.qt((function(t,r){var i=Lc(r),o=Rc(e.D,i);return n.put(o)}))},t}();function ml(t){t.createObjectStore(tc.store,{keyPath:tc.keyPath}).createIndex(tc.documentTargetsIndex,tc.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Zu.store,{keyPath:Zu.keyPath}).createIndex(Zu.queryTargetsIndexName,Zu.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ec.store)}var bl="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",wl=function(){function t(e,n,r,i,o,s,a,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Fe=o,this.window=s,this.document=a,this.Oe=c,this.ke=l,this.Me=null,this.Le=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Be=null,this.inForeground=!1,this.qe=null,this.Ue=null,this.Qe=Number.NEGATIVE_INFINITY,this.Ke=function(t){return Promise.resolve()},!t.At())throw new Oo(Co.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ul(this,i),this.We=n+"main",this.D=new Tc(u),this.je=new fc(this.We,11,new yl(this.D)),this.Ge=new Zc(this.referenceDelegate,this.D),this.Gt=new qc,this.ze=function(t,e){return new fl(t,e)}(this.D,this.Gt),this.He=new Mc,this.window&&this.window.localStorage?this.Je=this.window.localStorage:(this.Je=null,!1===l&&po("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.Ye().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Oo(Co.FAILED_PRECONDITION,bl);return t.Xe(),t.Ze(),t.tn(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.Ge.getHighestSequenceNumber(e)}))})).then((function(e){t.Me=new co(e,t.Oe)})).then((function(){t.Le=!0})).catch((function(e){return t.je&&t.je.close(),Promise.reject(e)}))},t.prototype.en=function(t){var e=this;return this.Ke=function(n){return so(e,void 0,void 0,(function(){return ao(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.je.Ct((function(n){return so(e,void 0,void 0,(function(){return ao(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Fe.enqueueAndForget((function(){return so(e,void 0,void 0,(function(){return ao(this,(function(t){switch(t.label){case 0:return this.started?[4,this.Ye()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.Ye=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Il(e).put(new rc(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.nn(e).next((function(e){e||(t.isPrimary=!1,t.Fe.enqueueRetryable((function(){return t.Ke(!1)})))}))})).next((function(){return t.sn(e)})).next((function(n){return t.isPrimary&&!n?t.rn(e).next((function(){return!1})):!!n&&t.on(e).next((function(){return!0}))}))})).catch((function(e){if(gc(e))return fo("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return fo("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Fe.enqueueRetryable((function(){return t.Ke(e)})),t.isPrimary=e}))},t.prototype.nn=function(t){var e=this;return El(t).get(Gu.key).next((function(t){return lc.resolve(e.cn(t))}))},t.prototype.an=function(t){return Il(t).delete(this.clientId)},t.prototype.un=function(){return so(this,void 0,void 0,(function(){var t,e,n,r,i=this;return ao(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.hn(this.Qe,18e5)?[3,2]:(this.Qe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Ec(t,rc.store);return e.kt().next((function(t){var n=i.ln(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return lc.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Je)for(e=0,n=t;e<n.length;e++)r=n[e],this.Je.removeItem(this.fn(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.tn=function(){var t=this;this.Ue=this.Fe.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.Ye().then((function(){return t.un()})).then((function(){return t.tn()}))}))},t.prototype.cn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.sn=function(t){var e=this;return this.ke?lc.resolve(!0):El(t).get(Gu.key).next((function(n){if(null!==n&&e.hn(n.leaseTimestampMs,5e3)&&!e.dn(n.ownerId)){if(e.cn(n)&&e.networkEnabled)return!0;if(!e.cn(n)){if(!n.allowTabSynchronization)throw new Oo(Co.FAILED_PRECONDITION,bl);return!1}}return!(!e.networkEnabled||!e.inForeground)||Il(t).kt().next((function(t){return void 0===e.ln(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&fo("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return so(this,void 0,void 0,(function(){var t=this;return ao(this,(function(e){switch(e.label){case 0:return this.Le=!1,this.wn(),this.Ue&&(this.Ue.cancel(),this.Ue=null),this._n(),this.mn(),[4,this.je.runTransaction("shutdown","readwrite",[Gu.store,rc.store],(function(e){var n=new wc(e,co.o);return t.rn(n).next((function(){return t.an(n)}))}))];case 1:return e.sent(),this.je.close(),this.yn(),[2]}}))}))},t.prototype.ln=function(t,e){var n=this;return t.filter((function(t){return n.hn(t.updateTimeMs,e)&&!n.dn(t.clientId)}))},t.prototype.gn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Il(e).kt().next((function(e){return t.ln(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.Le},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Wc.Ht(t,this.D,this.Gt,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.Ge},t.prototype.getRemoteDocumentCache=function(){return this.ze},t.prototype.getIndexManager=function(){return this.Gt},t.prototype.getBundleCache=function(){return this.He},t.prototype.runTransaction=function(t,e,n){var r=this;fo("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.je.runTransaction(t,o,sc,(function(o){return i=new wc(o,r.Me?r.Me.next():co.o),"readwrite-primary"===e?r.nn(i).next((function(t){return!!t||r.sn(i)})).next((function(e){if(!e)throw po("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Fe.enqueueRetryable((function(){return r.Ke(!1)})),new Oo(Co.FAILED_PRECONDITION,ac);return n(i)})).next((function(t){return r.on(i).next((function(){return t}))})):r.pn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.pn=function(t){var e=this;return El(t).get(Gu.key).next((function(t){if(null!==t&&e.hn(t.leaseTimestampMs,5e3)&&!e.dn(t.ownerId)&&!e.cn(t)&&!(e.ke||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Oo(Co.FAILED_PRECONDITION,bl)}))},t.prototype.on=function(t){var e=new Gu(this.clientId,this.allowTabSynchronization,Date.now());return El(t).put(Gu.key,e)},t.At=function(){return fc.At()},t.prototype.rn=function(t){var e=this,n=El(t);return n.get(Gu.key).next((function(t){return e.cn(t)?(fo("IndexedDbPersistence","Releasing primary lease."),n.delete(Gu.key)):lc.resolve()}))},t.prototype.hn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(po("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Xe=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.qe=function(){t.Fe.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.Ye()}))},this.document.addEventListener("visibilitychange",this.qe),this.inForeground="visible"===this.document.visibilityState)},t.prototype._n=function(){this.qe&&(this.document.removeEventListener("visibilitychange",this.qe),this.qe=null)},t.prototype.Ze=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Be=function(){e.wn(),e.Fe.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("unload",this.Be))},t.prototype.mn=function(){this.Be&&(this.window.removeEventListener("unload",this.Be),this.Be=null)},t.prototype.dn=function(t){var e;try{var n=null!==(null===(e=this.Je)||void 0===e?void 0:e.getItem(this.fn(t)));return fo("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return po("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.wn=function(){if(this.Je)try{this.Je.setItem(this.fn(this.clientId),String(Date.now()))}catch(t){po("Failed to set zombie client id.",t)}},t.prototype.yn=function(){if(this.Je)try{this.Je.removeItem(this.fn(this.clientId))}catch(t){}},t.prototype.fn=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function El(t){return Ec(t,Gu.store)}function Il(t){return Ec(t,rc.store)}function _l(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Sl=function(t,e){this.progress=t,this.En=e},Tl=function(){function t(t,e,n){this.ze=t,this.Tn=e,this.Gt=n}return t.prototype.In=function(t,e){var n=this;return this.Tn.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.An(t,e,r)}))},t.prototype.An=function(t,e,n){return this.ze.getEntry(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].applyToLocalView(e,t);return t}))},t.prototype.Rn=function(t,e,n){var r=Ka();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].applyToLocalView(t,e);r=r.insert(t,e)})),r},t.prototype.bn=function(t,e){var n=this;return this.ze.getEntries(t,e).next((function(e){return n.vn(t,e)}))},t.prototype.vn=function(t,e){var n=this;return this.Tn.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(r){var i=n.Rn(t,e,r),o=Ba();return i.forEach((function(t,e){e||(e=new us(t,Ws.min())),o=o.insert(t,e)})),o}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Fo.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Pn(t,e.path):Fs(e)?this.Vn(t,e,n):this.Sn(t,e,n)},t.prototype.Pn=function(t,e){return this.In(t,new Fo(e)).next((function(t){var e=Ga();return t instanceof as&&(e=e.insert(t.key,t)),e}))},t.prototype.Vn=function(t,e,n){var r=this,i=e.collectionGroup,o=Ga();return this.Gt.getCollectionParents(t,i).next((function(s){return lc.forEach(s,(function(s){var a=function(t,e){return new Ds(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.Sn(t,a,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Sn=function(t,e,n){var r,i,o=this;return this.ze.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o.Tn.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Dn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,l=ba(u,r.get(c),o.localWriteTime);r=l instanceof as?r.insert(c,l):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){zs(e,n)||(r=r.remove(t))})),r}))},t.prototype.Dn=function(t,e,n){for(var r=$a(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Sa&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.ze.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof as&&(c=c.insert(t,e))})),c}))},t}(),kl=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.Cn=n,this.xn=r}return t.Nn=function(e,n){for(var r=$a(),i=$a(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),xl=function(){function t(){}return t.prototype.$n=function(t){this.Fn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(Ws.min())?this.On(t,e):this.Fn.bn(t,r).next((function(o){var s=i.kn(e,o);return(Ls(e)||Rs(e))&&i.Mn(e.limitType,s,r,n)?i.On(t,e):(ho()<=At.DEBUG&&fo("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ks(e)),i.Fn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.kn=function(t,e){var n=new ja(Gs(t));return e.forEach((function(e,r){r instanceof as&&zs(t,r)&&(n=n.add(r))})),n},t.prototype.Mn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.On=function(t,e){return ho()<=At.DEBUG&&fo("QueryEngine","Using full collection scan to execute query:",Ks(e)),this.Fn.getDocumentsMatchingQuery(t,e,Ws.min())},t}(),Nl=function(){function t(t,e,n,r){this.persistence=t,this.Ln=e,this.D=r,this.Bn=new Ma(Io),this.qn=new ll((function(t){return fs(t)}),ps),this.Un=Ws.min(),this.Tn=t.getMutationQueue(n),this.Qn=t.getRemoteDocumentCache(),this.Ge=t.getTargetCache(),this.Kn=new Tl(this.Qn,this.Tn,this.persistence.getIndexManager()),this.He=t.getBundleCache(),this.Ln.$n(this.Kn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Bn)}))},t}();function Al(t,e,n,r){return new Nl(t,e,n,r)}function Dl(t,e){return so(this,void 0,void 0,(function(){var n,r,i,o;return ao(this,(function(s){switch(s.label){case 0:return n=bo(t),r=n.Tn,i=n.Kn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.Tn.getAllMutationBatches(t).next((function(s){return o=s,r=n.persistence.getMutationQueue(e),i=new Tl(n.Qn,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],s=$a(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var g=d[p];r.push(g.batchId);for(var v=0,y=g.mutations;v<y.length;v++){var m=y[v];s=s.add(m.key)}}return i.bn(t,s).next((function(t){return{Wn:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=s.sent(),[2,(n.Tn=r,n.Kn=i,n.Ln.$n(n.Kn),o)]}}))}))}function Cl(t,e){var n=bo(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Qn.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=lc.resolve();return o.forEach((function(t){s=s.next((function(){return r.getEntry(e,t)})).next((function(e){var o=e,s=n.docVersions.get(t);mo(null!==s),(!o||o.version.compareTo(s)<0)&&(o=i.applyToRemoteDocument(t,o,n))&&r.addEntry(o,n.commitVersion)}))})),s.next((function(){return t.Tn.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.Tn.performConsistencyCheck(t)})).next((function(){return n.Kn.bn(t,r)}))}))}function Ol(t){var e=bo(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.Ge.getLastRemoteSnapshotVersion(t)}))}function Ll(t,e){var n=bo(t),r=e.snapshotVersion,i=n.Bn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Qn.newChangeBuffer({trackRemovals:!0});i=n.Bn;var s=[];e.targetChanges.forEach((function(e,o){var a=i.get(o);if(a){s.push(n.Ge.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.Ge.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=a.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return mo(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,c,e)&&s.push(n.Ge.updateTargetData(t,c))}}}));var a=Ba();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),s.push(Rl(t,o,e.documentUpdates,r,void 0).next((function(t){a=t}))),!r.isEqual(Ws.min())){var u=n.Ge.getLastRemoteSnapshotVersion(t).next((function(e){return n.Ge.setTargetsMetadata(t,t.currentSequenceNumber,r)}));s.push(u)}return lc.waitFor(s).next((function(){return o.apply(t)})).next((function(){return n.Kn.vn(t,a)}))})).then((function(t){return n.Bn=i,t}))}function Rl(t,e,n,r,i){var o=$a();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Ba();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s instanceof us&&s.version.isEqual(Ws.min())?(e.removeEntry(n,u),o=o.insert(n,s)):null==a||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(e.addEntry(s,u),o=o.insert(n,s)):fo("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}function Pl(t,e){var n=bo(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.Tn.getNextMutationBatchAfterBatchId(t,e)}))}function Ml(t,e){var n=bo(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.Ge.getTargetData(t,e).next((function(i){return i?(r=i,lc.resolve(r)):n.Ge.allocateTargetId(t).next((function(i){return r=new Sc(e,i,0,t.currentSequenceNumber),n.Ge.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Bn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Bn=n.Bn.insert(t.targetId,t),n.qn.set(e,t.targetId)),t}))}function Fl(t,e,n){return so(this,void 0,void 0,(function(){var r,i,o,s;return ao(this,(function(a){switch(a.label){case 0:r=bo(t),i=r.Bn.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!gc(s=a.sent()))throw s;return fo("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Bn=r.Bn.remove(e),r.qn.delete(i.target),[2]}}))}))}function Ul(t,e,n){var r=bo(t),i=Ws.min(),o=$a();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=bo(t),i=r.qn.get(n);return void 0!==i?lc.resolve(r.Bn.get(i)):r.Ge.getTargetData(e,n)}(r,t,js(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.Ge.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.Ln.getDocumentsMatchingQuery(t,e,n?i:Ws.min(),n?o:$a())})).next((function(t){return{documents:t,jn:o}}))}))}function jl(t,e){var n=bo(t),r=bo(n.Ge),i=n.Bn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.yt(t,e).next((function(t){return t?t.target:null}))}))}function Vl(t){var e=bo(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=bo(t),i=Ba(),o=Nc(n),s=gl(e),a=IDBKeyRange.lowerBound(o,!0);return s.qt({index:Ju.readTimeIndex,range:a},(function(t,e){var n=kc(r.D,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{En:i,readTime:Ac(o)}}))}(e.Qn,t,e.Un)})).then((function(t){var n=t.En,r=t.readTime;return e.Un=r,n}))}function ql(t){return so(this,void 0,void 0,(function(){var e;return ao(this,(function(n){return[2,(e=bo(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=gl(t),n=Ws.min();return e.qt({index:Ju.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Ac(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.Un=t}))]}))}))}function Bl(t,e,n,r){return so(this,void 0,void 0,(function(){var i,o,s,a,u,c,l,h,f,p;return ao(this,(function(d){switch(d.label){case 0:for(i=bo(t),o=$a(),s=Ba(),a=Wa(),u=0,c=n;u<c.length;u++)l=c[u],h=e.Gn(l.metadata.name),l.document&&(o=o.add(h)),s=s.insert(h,e.zn(l)),a=a.insert(h,e.Hn(l.metadata.readTime));return f=i.Qn.newChangeBuffer({trackRemovals:!0}),[4,Ml(i,function(t){return js(Os(Ro.fromString("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return Rl(t,f,s,Ws.min(),a).next((function(e){return f.apply(t),e})).next((function(e){return i.Ge.removeMatchingKeysForTargetId(t,p.targetId).next((function(){return i.Ge.addMatchingKeys(t,o,p.targetId)})).next((function(){return i.Kn.vn(t,e)}))}))}))]}}))}))}function Kl(t,e,n){return void 0===n&&(n=$a()),so(this,void 0,void 0,(function(){var r,i;return ao(this,(function(o){switch(o.label){case 0:return[4,Ml(t,js(Pc(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=bo(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=pu(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.He.saveNamedQuery(t,e);var s=r.withResumeToken(Uo.EMPTY_BYTE_STRING,o);return i.Bn=i.Bn.insert(s.targetId,s),i.Ge.updateTargetData(t,s).next((function(){return i.Ge.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return i.Ge.addMatchingKeys(t,n,r.targetId)})).next((function(){return i.He.saveNamedQuery(t,e)}))}))]}}))}))}var zl=function(){function t(t){this.D=t,this.Jn=new Map,this.Yn=new Map}return t.prototype.getBundleMetadata=function(t,e){return lc.resolve(this.Jn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Jn.set(e.id,{id:(n=e).id,version:n.version,createTime:pu(n.createTime)}),lc.resolve()},t.prototype.getNamedQuery=function(t,e){return lc.resolve(this.Yn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.Yn.set(e.name,function(t){return{name:t.name,query:Pc(t.bundledQuery),readTime:pu(t.readTime)}}(e)),lc.resolve()},t}(),Gl=function(){function t(){this.Xn=new ja(Hl.Zn),this.ts=new ja(Hl.es)}return t.prototype.isEmpty=function(){return this.Xn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Hl(t,e);this.Xn=this.Xn.add(n),this.ts=this.ts.add(n)},t.prototype.ns=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.ss(new Hl(t,e))},t.prototype.rs=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.os=function(t){var e=this,n=new Fo(new Ro([])),r=new Hl(n,t),i=new Hl(n,t+1),o=[];return this.ts.forEachInRange([r,i],(function(t){e.ss(t),o.push(t.key)})),o},t.prototype.cs=function(){var t=this;this.Xn.forEach((function(e){return t.ss(e)}))},t.prototype.ss=function(t){this.Xn=this.Xn.delete(t),this.ts=this.ts.delete(t)},t.prototype.us=function(t){var e=new Fo(new Ro([])),n=new Hl(e,t),r=new Hl(e,t+1),i=$a();return this.ts.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Hl(t,0),n=this.Xn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Hl=function(){function t(t,e){this.key=t,this.hs=e}return t.Zn=function(t,e){return Fo.comparator(t.key,e.key)||Io(t.hs,e.hs)},t.es=function(t,e){return Io(t.hs,e.hs)||Fo.comparator(t.key,e.key)},t}(),Wl=function(){function t(t,e){this.Gt=t,this.referenceDelegate=e,this.Tn=[],this.ls=1,this.fs=new ja(Hl.Zn)}return t.prototype.checkEmpty=function(t){return lc.resolve(0===this.Tn.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ls;this.ls++,this.Tn.length>0&&this.Tn[this.Tn.length-1];var o=new Ic(i,e,n,r);this.Tn.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.fs=this.fs.add(new Hl(u.key,i)),this.Gt.addToCollectionParentIndex(t,u.key.path.popLast())}return lc.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return lc.resolve(this.ds(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.ws(n),i=r<0?0:r;return lc.resolve(this.Tn.length>i?this.Tn[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return lc.resolve(0===this.Tn.length?-1:this.ls-1)},t.prototype.getAllMutationBatches=function(t){return lc.resolve(this.Tn.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Hl(e,0),i=new Hl(e,Number.POSITIVE_INFINITY),o=[];return this.fs.forEachInRange([r,i],(function(t){var e=n.ds(t.hs);o.push(e)})),lc.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new ja(Io);return e.forEach((function(t){var e=new Hl(t,0),i=new Hl(t,Number.POSITIVE_INFINITY);n.fs.forEachInRange([e,i],(function(t){r=r.add(t.hs)}))})),lc.resolve(this._s(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Fo.isDocumentKey(i)||(i=i.child(""));var o=new Hl(new Fo(i),0),s=new ja(Io);return this.fs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(s=s.add(t.hs)),!0)}),o),lc.resolve(this._s(s))},t.prototype._s=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.ds(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;mo(0===this.ys(e.batchId,"removed")),this.Tn.shift();var r=this.fs;return lc.forEach(e.mutations,(function(i){var o=new Hl(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.fs=r}))},t.prototype.Xt=function(t){},t.prototype.containsKey=function(t,e){var n=new Hl(e,0),r=this.fs.firstAfterOrEqual(n);return lc.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this.Tn.length,lc.resolve()},t.prototype.ys=function(t,e){return this.ws(t)},t.prototype.ws=function(t){return 0===this.Tn.length?0:t-this.Tn[0].batchId},t.prototype.ds=function(t){var e=this.ws(t);return e<0||e>=this.Tn.length?null:this.Tn[e]},t}(),Ql=function(){function t(t,e){this.Gt=t,this.gs=e,this.docs=new Ma(Fo.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.gs(e);return this.docs=this.docs.insert(r,{maybeDocument:e,size:s,readTime:n}),this.size+=s-o,this.Gt.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return lc.resolve(n?n.maybeDocument:null)},t.prototype.getEntries=function(t,e){var n=this,r=Ka();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.maybeDocument:null)})),lc.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Ga(),i=new Fo(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,c=u.maybeDocument,l=u.readTime;if(!e.path.isPrefixOf(a.path))break;l.compareTo(n)<=0||c instanceof as&&zs(e,c)&&(r=r.insert(c.key,c))}return lc.resolve(r)},t.prototype.ps=function(t,e){return lc.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new $l(this)},t.prototype.getSize=function(t){return lc.resolve(this.size)},t}(),$l=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ve=e,n}return oo(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i&&i.maybeDocument?n.push(e.Ve.addEntry(t,i.maybeDocument,e.getReadTime(r))):e.Ve.removeEntry(r)})),lc.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ve.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ve.getEntries(t,e)},e}(hl),Yl=function(){function t(t){this.persistence=t,this.Es=new ll((function(t){return fs(t)}),ps),this.lastRemoteSnapshotVersion=Ws.min(),this.highestTargetId=0,this.Ts=0,this.Is=new Gl,this.targetCount=0,this.As=Xc.ee()}return t.prototype.forEachTarget=function(t,e){return this.Es.forEach((function(t,n){return e(n)})),lc.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return lc.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return lc.resolve(this.Ts)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.As.next(),lc.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ts&&(this.Ts=e),lc.resolve()},t.prototype.re=function(t){this.Es.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.As=new Xc(e),this.highestTargetId=e),t.sequenceNumber>this.Ts&&(this.Ts=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.re(e),this.targetCount+=1,lc.resolve()},t.prototype.updateTargetData=function(t,e){return this.re(e),lc.resolve()},t.prototype.removeTargetData=function(t,e){return this.Es.delete(e.target),this.Is.os(e.targetId),this.targetCount-=1,lc.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.Es.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.Es.delete(s),o.push(r.removeMatchingKeysForTargetId(t,a.targetId)),i++)})),lc.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return lc.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.Es.get(e)||null;return lc.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this.Is.ns(e,n),lc.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this.Is.rs(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),lc.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.Is.os(e),lc.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.Is.us(e);return lc.resolve(n)},t.prototype.containsKey=function(t,e){return lc.resolve(this.Is.containsKey(e))},t}(),Jl=function(){function t(t,e){var n=this;this.Rs={},this.Me=new co(0),this.Le=!1,this.Le=!0,this.referenceDelegate=t(this),this.Ge=new Yl(this),this.Gt=new jc,this.ze=function(t,e){return new Ql(t,(function(t){return n.referenceDelegate.bs(t)}))}(this.Gt),this.D=new Tc(e),this.He=new zl(this.D)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.Le=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.Le},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Gt},t.prototype.getMutationQueue=function(t){var e=this.Rs[t.toKey()];return e||(e=new Wl(this.Gt,this.referenceDelegate),this.Rs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.Ge},t.prototype.getRemoteDocumentCache=function(){return this.ze},t.prototype.getBundleCache=function(){return this.He},t.prototype.runTransaction=function(t,e,n){var r=this;fo("MemoryPersistence","Starting transaction:",t);var i=new Xl(this.Me.next());return this.referenceDelegate.vs(),n(i).next((function(t){return r.referenceDelegate.Ps(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Vs=function(t,e){return lc.or(Object.values(this.Rs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),Xl=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return oo(e,t),e}(uc),Zl=function(){function t(t){this.persistence=t,this.Ss=new Gl,this.Ds=null}return t.Cs=function(e){return new t(e)},Object.defineProperty(t.prototype,"xs",{get:function(){if(this.Ds)return this.Ds;throw yo()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.Ss.addReference(n,e),this.xs.delete(n.toString()),lc.resolve()},t.prototype.removeReference=function(t,e,n){return this.Ss.removeReference(n,e),this.xs.add(n.toString()),lc.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.xs.add(e.toString()),lc.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.Ss.os(e.targetId).forEach((function(t){return n.xs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.xs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.vs=function(){this.Ds=new Set},t.prototype.Ps=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return lc.forEach(this.xs,(function(r){var i=Fo.fromPath(r);return e.Ns(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Ds=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ns(t,e).next((function(t){t?n.xs.delete(e.toString()):n.xs.add(e.toString())}))},t.prototype.bs=function(t){return 0},t.prototype.Ns=function(t,e){var n=this;return lc.or([function(){return lc.resolve(n.Ss.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Vs(t,e)}])},t}(),th=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function eh(t,e){return"firestore_clients_"+t+"_"+e}function nh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function rh(t,e){return"firestore_targets_"+t+"_"+e}th.UNAUTHENTICATED=new th(null),th.GOOGLE_CREDENTIALS=new th("google-credentials-uid"),th.FIRST_PARTY=new th("first-party-uid");var ih=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.$s=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Oo(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(po("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Fs=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),oh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.$s=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Oo(i.error.code,i.error.message)),o?new t(e,i.state,r):(po("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Fs=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),sh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.$s=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ja(),s=0;i&&s<r.activeTargetIds.length;++s)i=Do(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(po("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),ah=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.$s=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(po("SharedClientState","Failed to parse online state: "+e),null)},t}(),uh=function(){function t(){this.activeTargetIds=Ja()}return t.prototype.Os=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.ks=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Fs=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),ch=function(){function t(t,e,n,r,i){this.window=t,this.Fe=e,this.persistenceKey=n,this.Ms=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ls=this.Bs.bind(this),this.qs=new Ma(Io),this.started=!1,this.Us=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Qs=eh(this.persistenceKey,this.Ms),this.Ks=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.qs=this.qs.insert(this.Ms,new uh),this.Ws=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.js=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Gs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.zs=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Hs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.Ls)}return t.At=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return so(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,l,h=this;return ao(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.gn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ms&&(i=this.getItem(eh(this.persistenceKey,r)))&&(o=sh.$s(r,i))&&(this.qs=this.qs.insert(o.clientId,o));for(this.Js(),(s=this.storage.getItem(this.zs))&&(a=this.Ys(s))&&this.Xs(a),u=0,c=this.Us;u<c.length;u++)l=c[u],this.Bs(l);return this.Us=[],this.window.addEventListener("unload",(function(){return h.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ks,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Zs(this.qs)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.qs.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.ti(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.ti(t,e,n),this.ei(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(rh(this.persistenceKey,t));if(n){var r=oh.$s(t,n);r&&(e=r.state)}}return this.ni.Os(t),this.Js(),e},t.prototype.removeLocalQueryTarget=function(t){this.ni.ks(t),this.Js()},t.prototype.isLocalQueryTarget=function(t){return this.ni.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(rh(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.si(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.ei(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.ii(t)},t.prototype.notifyBundleLoaded=function(){this.ri()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.Ls),this.removeItem(this.Qs),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return fo("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){fo("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){fo("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Bs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(fo("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Qs)return void po("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Fe.enqueueRetryable((function(){return so(e,void 0,void 0,(function(){var t,e,r,i,o,s;return ao(this,(function(a){if(this.started){if(null!==n.key)if(this.Ws.test(n.key)){if(null==n.newValue)return t=this.oi(n.key),[2,this.ci(t,null)];if(e=this.ai(n.key,n.newValue))return[2,this.ci(e.clientId,e)]}else if(this.js.test(n.key)){if(null!==n.newValue&&(r=this.ui(n.key,n.newValue)))return[2,this.hi(r)]}else if(this.Gs.test(n.key)){if(null!==n.newValue&&(i=this.li(n.key,n.newValue)))return[2,this.fi(i)]}else if(n.key===this.zs){if(null!==n.newValue&&(o=this.Ys(n.newValue)))return[2,this.Xs(o)]}else if(n.key===this.Ks)(s=function(t){var e=co.o;if(null!=t)try{var n=JSON.parse(t);mo("number"==typeof n),e=n}catch(t){po("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==co.o&&this.sequenceNumberHandler(s);else if(n.key===this.Hs)return[2,this.syncEngine.di()]}else this.Us.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"ni",{get:function(){return this.qs.get(this.Ms)},enumerable:!1,configurable:!0}),t.prototype.Js=function(){this.setItem(this.Qs,this.ni.Fs())},t.prototype.ti=function(t,e,n){var r=new ih(this.currentUser,t,e,n),i=nh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Fs())},t.prototype.ei=function(t){var e=nh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.ii=function(t){var e={clientId:this.Ms,onlineState:t};this.storage.setItem(this.zs,JSON.stringify(e))},t.prototype.si=function(t,e,n){var r=rh(this.persistenceKey,t),i=new oh(t,e,n);this.setItem(r,i.Fs())},t.prototype.ri=function(){this.setItem(this.Hs,"value-not-used")},t.prototype.oi=function(t){var e=this.Ws.exec(t);return e?e[1]:null},t.prototype.ai=function(t,e){var n=this.oi(t);return sh.$s(n,e)},t.prototype.ui=function(t,e){var n=this.js.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return ih.$s(new th(i),r,e)},t.prototype.li=function(t,e){var n=this.Gs.exec(t),r=Number(n[1]);return oh.$s(r,e)},t.prototype.Ys=function(t){return ah.$s(t)},t.prototype.hi=function(t){return so(this,void 0,void 0,(function(){return ao(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.wi(t.batchId,t.state,t.error)]:(fo("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.fi=function(t){return this.syncEngine._i(t.targetId,t.state,t.error)},t.prototype.ci=function(t,e){var n=this,r=e?this.qs.insert(t,e):this.qs.remove(t),i=this.Zs(this.qs),o=this.Zs(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this.syncEngine.mi(s,a).then((function(){n.qs=r}))},t.prototype.Xs=function(t){this.qs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Zs=function(t){var e=Ja();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),lh=function(){function t(){this.yi=new uh,this.gi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.yi.Os(t),this.gi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.gi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.yi.ks(t)},t.prototype.isLocalQueryTarget=function(t){return this.yi.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.gi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.yi.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.yi.activeTargetIds.has(t)},t.prototype.start=function(){return this.yi=new uh,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),hh=function(){function t(){}return t.prototype.pi=function(t){},t.prototype.shutdown=function(){},t}(),fh=function(){function t(){var t=this;this.Ei=function(){return t.Ti()},this.Ii=function(){return t.Ai()},this.Ri=[],this.bi()}return t.prototype.pi=function(t){this.Ri.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.Ei),window.removeEventListener("offline",this.Ii)},t.prototype.bi=function(){window.addEventListener("online",this.Ei),window.addEventListener("offline",this.Ii)},t.prototype.Ti=function(){fo("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ri;t<e.length;t++)(0,e[t])(0)},t.prototype.Ai=function(){fo("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ri;t<e.length;t++)(0,e[t])(1)},t.At=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),ph={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},dh=function(){function t(t){this.vi=t.vi,this.Pi=t.Pi}return t.prototype.Vi=function(t){this.Si=t},t.prototype.Di=function(t){this.Ci=t},t.prototype.onMessage=function(t){this.xi=t},t.prototype.close=function(){this.Pi()},t.prototype.send=function(t){this.vi(t)},t.prototype.Ni=function(){this.Si()},t.prototype.$i=function(t){this.Ci(t)},t.prototype.Fi=function(t){this.xi(t)},t}(),gh=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n}return oo(e,t),e.prototype.qi=function(t,e,n,r){return new Promise((function(i,o){var s=new ro;s.listenOnce(Xi.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Ji.NO_ERROR:var e=s.getResponseJson();fo("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Ji.TIMEOUT:fo("Connection",'RPC "'+t+'" timed out'),o(new Oo(Co.DEADLINE_EXCEEDED,"Request time out"));break;case Ji.HTTP_ERROR:var n=s.getStatus();if(fo("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Co).indexOf(e)>=0?e:Co.UNKNOWN}(r.status);o(new Oo(a,r.message))}else o(new Oo(Co.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Oo(Co.UNAVAILABLE,"Connection failed."));break;default:yo()}}finally{fo("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Qi=function(t,e){var n,r=[this.Oi,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new Hi,o=Qn(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.Bi(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(lt())||"object"==typeof navigator&&"ReactNative"===navigator.product||lt().indexOf("Electron/")>=0||function(){var t=lt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||lt().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");fo("Connection","Creating WebChannel: "+a,s);var u=i.createWebChannel(a,s),c=!1,l=!1,h=new dh({vi:function(t){l?fo("Connection","Not sending because WebChannel is closed:",t):(c||(fo("Connection","Opening WebChannel transport."),u.open(),c=!0),fo("Connection","WebChannel sending:",t),u.send(t))},Pi:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,no.EventType.OPEN,(function(){l||fo("Connection","WebChannel transport opened.")})),f(u,no.EventType.CLOSE,(function(){l||(l=!0,fo("Connection","WebChannel transport closed"),h.$i())})),f(u,no.EventType.ERROR,(function(t){l||(l=!0,go("Connection","WebChannel transport errored:",t),h.$i(new Oo(Co.UNAVAILABLE,"The operation could not be completed")))})),f(u,no.EventType.MESSAGE,(function(t){var e;if(!l){var n=t.data[0];mo(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){fo("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=Aa[t];if(void 0!==e)return Pa(e)}(o),a=i.message;void 0===s&&(s=Co.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),l=!0,h.$i(new Oo(s,a)),u.close()}else fo("Connection","WebChannel received:",n),h.Fi(n)}})),f(o,Zi.STAT_EVENT,(function(t){t.stat===to?fo("Connection","Detected buffering proxy"):t.stat===eo&&fo("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Ni()}),0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Oi=e+"://"+t.host,this.ki="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Mi=function(t,e,n,r){var i=this.Li(t,e);fo("RestConnection","Sending: ",i,n);var o={};return this.Bi(o,r),this.qi(t,i,o,n).then((function(t){return fo("RestConnection","Received: ",t),t}),(function(e){throw go("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Ui=function(t,e,n,r){return this.Mi(t,e,n,r)},t.prototype.Bi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.3.1",t["Content-Type"]="text/plain",e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.Li=function(t,e){var n=ph[t];return this.Oi+"/v1/"+e+":"+n},t}());function vh(){return"undefined"!=typeof window?window:null}function yh(){return"undefined"!=typeof document?document:null}function mh(t){return new cu(t,!0)}var bh=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Fe=t,this.timerId=e,this.Ki=n,this.Wi=r,this.ji=i,this.Gi=0,this.zi=null,this.Hi=Date.now(),this.reset()}return t.prototype.reset=function(){this.Gi=0},t.prototype.Ji=function(){this.Gi=this.ji},t.prototype.Yi=function(t){var e=this;this.cancel();var n=Math.floor(this.Gi+this.Xi()),r=Math.max(0,Date.now()-this.Hi),i=Math.max(0,n-r);i>0&&fo("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Gi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.zi=this.Fe.enqueueAfterDelay(this.timerId,i,(function(){return e.Hi=Date.now(),t()})),this.Gi*=this.Wi,this.Gi<this.Ki&&(this.Gi=this.Ki),this.Gi>this.ji&&(this.Gi=this.ji)},t.prototype.Zi=function(){null!==this.zi&&(this.zi.skipDelay(),this.zi=null)},t.prototype.cancel=function(){null!==this.zi&&(this.zi.cancel(),this.zi=null)},t.prototype.Xi=function(){return(Math.random()-.5)*this.Gi},t}(),wh=function(){function t(t,e,n,r,i,o){this.Fe=t,this.tr=n,this.er=r,this.nr=i,this.listener=o,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new bh(t,e)}return t.prototype.cr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.ar=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.ur()},t.prototype.stop=function(){return so(this,void 0,void 0,(function(){return ao(this,(function(t){switch(t.label){case 0:return this.cr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.hr=function(){this.state=0,this.rr.reset()},t.prototype.lr=function(){var t=this;this.ar()&&null===this.ir&&(this.ir=this.Fe.enqueueAfterDelay(this.tr,6e4,(function(){return t.dr()})))},t.prototype.wr=function(t){this._r(),this.stream.send(t)},t.prototype.dr=function(){return so(this,void 0,void 0,(function(){return ao(this,(function(t){return this.ar()?[2,this.close(0)]:[2]}))}))},t.prototype._r=function(){this.ir&&(this.ir.cancel(),this.ir=null)},t.prototype.close=function(t,e){return so(this,void 0,void 0,(function(){return ao(this,(function(n){switch(n.label){case 0:return this._r(),this.rr.cancel(),this.sr++,3!==t?this.rr.reset():e&&e.code===Co.RESOURCE_EXHAUSTED?(po(e.toString()),po("Using maximum backoff delay to prevent overloading the backend."),this.rr.Ji()):e&&e.code===Co.UNAUTHENTICATED&&this.nr.invalidateToken(),null!==this.stream&&(this.mr(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Di(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.mr=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.yr(this.sr),n=this.sr;this.nr.getToken().then((function(e){t.sr===n&&t.gr(e)}),(function(n){e((function(){var e=new Oo(Co.UNKNOWN,"Fetching auth token failed: "+n.message);return t.pr(e)}))}))},t.prototype.gr=function(t){var e=this,n=this.yr(this.sr);this.stream=this.Er(t),this.stream.Vi((function(){n((function(){return e.state=2,e.listener.Vi()}))})),this.stream.Di((function(t){n((function(){return e.pr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.ur=function(){var t=this;this.state=4,this.rr.Yi((function(){return so(t,void 0,void 0,(function(){return ao(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.pr=function(t){return fo("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.yr=function(t){var e=this;return function(n){e.Fe.enqueueAndForget((function(){return e.sr===t?n():(fo("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Eh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).D=i,s}return oo(e,t),e.prototype.Er=function(t){return this.er.Qi("Listen",t)},e.prototype.onMessage=function(t){this.rr.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:yo()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.V?(mo(void 0===e||"string"==typeof e),Uo.fromBase64String(e||"")):(mo(void 0===e||e instanceof Uint8Array),Uo.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?Co.UNKNOWN:Pa(t.code);return new Oo(e,t.message||"")}(a);n=new nu(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=yu(t,r.document.name),o=pu(r.document.updateTime);var a=new $s({mapValue:{fields:r.document.fields}}),u=(s=new as(i,o,a,{}),r.targetIds||[]),c=r.removedTargetIds||[];n=new tu(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=yu(t,r.document),o=r.readTime?pu(r.readTime):Ws.min(),a=new us(i,o),s=r.removedTargetIds||[],n=new tu([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=yu(t,r.document),o=r.removedTargetIds||[],n=new tu([],o,i,null);else{if(!("filter"in e))return yo();e.filter;var l=e.filter;l.targetId,r=l.count||0,i=new La(r),o=l.targetId,n=new eu(o,i)}return n}(this.D,t),n=function(t){if(!("targetChange"in t))return Ws.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Ws.min():e.readTime?pu(e.readTime):Ws.min()}(t);return this.listener.Tr(e,n)},e.prototype.Ir=function(t){var e={};e.database=wu(this.D),e.addTarget=function(t,e){var n,r=e.target;return(n=ds(r)?{documents:ku(t,r)}:{query:xu(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=hu(t,e.resumeToken):e.snapshotVersion.compareTo(Ws.min())>0&&(n.readTime=lu(t,e.snapshotVersion.toTimestamp())),n}(this.D,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return yo()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.D,t);n&&(e.labels=n),this.wr(e)},e.prototype.Ar=function(t){var e={};e.database=wu(this.D),e.removeTarget=t,this.wr(e)},e}(wh),Ih=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).D=i,s.Rr=!1,s}return oo(e,t),Object.defineProperty(e.prototype,"br",{get:function(){return this.Rr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.Rr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.mr=function(){this.Rr&&this.vr([])},e.prototype.Er=function(t){return this.er.Qi("Write",t)},e.prototype.onMessage=function(t){if(mo(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Rr){this.rr.reset();var e=function(t,e){return t&&t.length>0?(mo(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?pu(t.updateTime):pu(e);return n.isEqual(Ws.min())&&(n=pu(e)),new da(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=pu(t.commitTime);return this.listener.Pr(n,e)}return mo(!t.writeResults||0===t.writeResults.length),this.Rr=!0,this.listener.Vr()},e.prototype.Sr=function(){var t={};t.database=wu(this.D),this.wr(t)},e.prototype.vr=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Su(e.D,t)}))};this.wr(n)},e}(wh),_h=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.er=n,i.D=r,i.Dr=!1,i}return oo(e,t),e.prototype.Cr=function(){if(this.Dr)throw new Oo(Co.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Mi=function(t,e,n){var r=this;return this.Cr(),this.credentials.getToken().then((function(i){return r.er.Mi(t,e,n,i)})).catch((function(t){throw t.code===Co.UNAUTHENTICATED&&r.credentials.invalidateToken(),t}))},e.prototype.Ui=function(t,e,n){var r=this;return this.Cr(),this.credentials.getToken().then((function(i){return r.er.Ui(t,e,n,i)})).catch((function(t){throw t.code===Co.UNAUTHENTICATED&&r.credentials.invalidateToken(),t}))},e.prototype.terminate=function(){this.Dr=!1},e}((function(){})),Sh=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.Nr=0,this.$r=null,this.Fr=!0}return t.prototype.Or=function(){var t=this;0===this.Nr&&(this.kr("Unknown"),this.$r=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.$r=null,t.Mr("Backend didn't respond within 10 seconds."),t.kr("Offline"),Promise.resolve()})))},t.prototype.Lr=function(t){"Online"===this.state?this.kr("Unknown"):(this.Nr++,this.Nr>=1&&(this.Br(),this.Mr("Connection failed 1 times. Most recent error: "+t.toString()),this.kr("Offline")))},t.prototype.set=function(t){this.Br(),this.Nr=0,"Online"===t&&(this.Fr=!1),this.kr(t)},t.prototype.kr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Mr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Fr?(po(e),this.Fr=!1):fo("OnlineStateTracker",e)},t.prototype.Br=function(){null!==this.$r&&(this.$r.cancel(),this.$r=null)},t}(),Th=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.qr=[],this.Ur=new Map,this.Qr=new Set,this.Kr=[],this.Wr=i,this.Wr.pi((function(t){n.enqueueAndForget((function(){return so(o,void 0,void 0,(function(){return ao(this,(function(t){switch(t.label){case 0:return Rh(this)?(fo("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return so(this,void 0,void 0,(function(){var e;return ao(this,(function(n){switch(n.label){case 0:return(e=bo(t)).Qr.add(4),[4,xh(e)];case 1:return n.sent(),e.jr.set("Unknown"),e.Qr.delete(4),[4,kh(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.jr=new Sh(n,r)};function kh(t){return so(this,void 0,void 0,(function(){var e,n;return ao(this,(function(r){switch(r.label){case 0:if(!Rh(t))return[3,4];e=0,n=t.Kr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function xh(t){return so(this,void 0,void 0,(function(){var e,n;return ao(this,(function(r){switch(r.label){case 0:e=0,n=t.Kr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Nh(t,e){var n=bo(t);n.Ur.has(e.targetId)||(n.Ur.set(e.targetId,e),Lh(n)?Oh(n):$h(n).ar()&&Dh(n,e))}function Ah(t,e){var n=bo(t),r=$h(n);n.Ur.delete(e),r.ar()&&Ch(n,e),0===n.Ur.size&&(r.ar()?r.lr():Rh(n)&&n.jr.set("Unknown"))}function Dh(t,e){t.Gr.H(e.targetId),$h(t).Ir(e)}function Ch(t,e){t.Gr.H(e),$h(t).Ar(e)}function Oh(t){t.Gr=new iu({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},yt:function(e){return t.Ur.get(e)||null}}),$h(t).start(),t.jr.Or()}function Lh(t){return Rh(t)&&!$h(t).cr()&&t.Ur.size>0}function Rh(t){return 0===bo(t).Qr.size}function Ph(t){t.Gr=void 0}function Mh(t){return so(this,void 0,void 0,(function(){return ao(this,(function(e){return t.Ur.forEach((function(e,n){Dh(t,e)})),[2]}))}))}function Fh(t,e){return so(this,void 0,void 0,(function(){return ao(this,(function(n){return Ph(t),Lh(t)?(t.jr.Lr(e),Oh(t)):t.jr.set("Unknown"),[2]}))}))}function Uh(t,e,n){return so(this,void 0,void 0,(function(){var r,i,o;return ao(this,(function(s){switch(s.label){case 0:if(t.jr.set("Online"),!(e instanceof nu&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return so(this,void 0,void 0,(function(){var n,r,i,o;return ao(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.Ur.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.Ur.delete(o),t.Gr.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),fo("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,jh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof tu?t.Gr.st(e):e instanceof eu?t.Gr.ht(e):t.Gr.ot(e),n.isEqual(Ws.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Ol(t.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.Gr.dt(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.Ur.get(r);i&&t.Ur.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.Ur.get(e);if(n){t.Ur.set(e,n.withResumeToken(Uo.EMPTY_BYTE_STRING,n.snapshotVersion)),Ch(t,e);var r=new Sc(n.target,e,1,n.sequenceNumber);Dh(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return fo("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,jh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function jh(t,e,n){return so(this,void 0,void 0,(function(){var r=this;return ao(this,(function(i){switch(i.label){case 0:if(!gc(e))throw e;return t.Qr.add(1),[4,xh(t)];case 1:return i.sent(),t.jr.set("Offline"),n||(n=function(){return Ol(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return so(r,void 0,void 0,(function(){return ao(this,(function(e){switch(e.label){case 0:return fo("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Qr.delete(1),[4,kh(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Vh(t,e){return e().catch((function(n){return jh(t,n,e)}))}function qh(t){return so(this,void 0,void 0,(function(){var e,n,r,i,o;return ao(this,(function(s){switch(s.label){case 0:e=bo(t),n=Yh(e),r=e.qr.length>0?e.qr[e.qr.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Rh(t)&&t.qr.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,Pl(e.localStore,r)];case 3:return null===(i=s.sent())?(0===e.qr.length&&n.lr(),[3,7]):(r=i.batchId,function(t,e){t.qr.push(e);var n=Yh(t);n.ar()&&n.br&&n.vr(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,jh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Bh(e)&&Kh(e),[2]}}))}))}function Bh(t){return Rh(t)&&!Yh(t).cr()&&t.qr.length>0}function Kh(t){Yh(t).start()}function zh(t){return so(this,void 0,void 0,(function(){return ao(this,(function(e){return Yh(t).Sr(),[2]}))}))}function Gh(t){return so(this,void 0,void 0,(function(){var e,n,r,i;return ao(this,(function(o){for(e=Yh(t),n=0,r=t.qr;n<r.length;n++)i=r[n],e.vr(i.mutations);return[2]}))}))}function Hh(t,e,n){return so(this,void 0,void 0,(function(){var r,i;return ao(this,(function(o){switch(o.label){case 0:return r=t.qr.shift(),i=_c.from(r,e,n),[4,Vh(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,qh(t)];case 2:return o.sent(),[2]}}))}))}function Wh(t,e){return so(this,void 0,void 0,(function(){return ao(this,(function(n){switch(n.label){case 0:return e&&Yh(t).br?[4,function(t,e){return so(this,void 0,void 0,(function(){var n,r;return ao(this,(function(i){switch(i.label){case 0:return Ra(r=e.code)&&r!==Co.ABORTED?(n=t.qr.shift(),Yh(t).hr(),[4,Vh(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,qh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Bh(t)&&Kh(t),[2]}}))}))}function Qh(t,e){return so(this,void 0,void 0,(function(){var n;return ao(this,(function(r){switch(r.label){case 0:return n=bo(t),e?(n.Qr.delete(2),[4,kh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Qr.add(2),[4,xh(n)]);case 3:r.sent(),n.jr.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function $h(t){var e=this;return t.zr||(t.zr=function(t,e,n){var r=bo(t);return r.Cr(),new Eh(e,r.er,r.credentials,r.D,n)}(t.datastore,t.asyncQueue,{Vi:Mh.bind(null,t),Di:Fh.bind(null,t),Tr:Uh.bind(null,t)}),t.Kr.push((function(n){return so(e,void 0,void 0,(function(){return ao(this,(function(e){switch(e.label){case 0:return n?(t.zr.hr(),Lh(t)?Oh(t):t.jr.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.zr.stop()];case 2:e.sent(),Ph(t),e.label=3;case 3:return[2]}}))}))}))),t.zr}function Yh(t){var e=this;return t.Hr||(t.Hr=function(t,e,n){var r=bo(t);return r.Cr(),new Ih(e,r.er,r.credentials,r.D,n)}(t.datastore,t.asyncQueue,{Vi:zh.bind(null,t),Di:Wh.bind(null,t),Vr:Gh.bind(null,t),Pr:Hh.bind(null,t)}),t.Kr.push((function(n){return so(e,void 0,void 0,(function(){return ao(this,(function(e){switch(e.label){case 0:return n?(t.Hr.hr(),[4,qh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Hr.stop()];case 3:e.sent(),t.qr.length>0&&(fo("RemoteStore","Stopping write stream with "+t.qr.length+" pending writes"),t.qr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Hr}var Jh=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new cc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Oo(Co.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Xh(t,e){if(po("AsyncQueue",e+": "+t),gc(t))return new Oo(Co.UNAVAILABLE,e+": "+t);throw t}var Zh=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Fo.comparator(e.key,n.key)}:function(t,e){return Fo.comparator(t.key,e.key)},this.keyedMap=Ga(),this.sortedSet=new Ma(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),tf=function(){function t(){this.Jr=new Ma(Fo.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Jr.get(e);n?0!==t.type&&3===n.type?this.Jr=this.Jr.insert(e,t):3===t.type&&1!==n.type?this.Jr=this.Jr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Jr=this.Jr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Jr=this.Jr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Jr=this.Jr.remove(e):1===t.type&&2===n.type?this.Jr=this.Jr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Jr=this.Jr.insert(e,{type:2,doc:t.doc}):yo():this.Jr=this.Jr.insert(e,t)},t.prototype.Yr=function(){var t=[];return this.Jr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),ef=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Zh.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&qs(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),nf=function(){this.Xr=void 0,this.listeners=[]},rf=function(){this.queries=new ll((function(t){return Bs(t)}),qs),this.onlineState="Unknown",this.Zr=new Set};function of(t,e){return so(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return ao(this,(function(c){switch(c.label){case 0:if(n=bo(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new nf),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Xr=c.sent(),[3,4];case 3:return a=c.sent(),u=Xh(a,"Initialization of query '"+Ks(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.eo(n.onlineState),o.Xr&&e.no(o.Xr)&&cf(n),[2]}}))}))}function sf(t,e){return so(this,void 0,void 0,(function(){var n,r,i,o,s;return ao(this,(function(a){return n=bo(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function af(t,e){for(var n=bo(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,l=u.listeners;c<l.length;c++)l[c].no(s)&&(r=!0);u.Xr=s}}r&&cf(n)}function uf(t,e,n){var r=bo(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function cf(t){t.Zr.forEach((function(t){t.next()}))}var lf=function(){function t(t,e,n){this.query=t,this.so=e,this.io=!1,this.ro=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.no=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ef(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.io?this.oo(t)&&(this.so.next(t),o=!0):this.co(t,this.onlineState)&&(this.ao(t),o=!0),this.ro=t,o},t.prototype.onError=function(t){this.so.error(t)},t.prototype.eo=function(t){this.onlineState=t;var e=!1;return this.ro&&!this.io&&this.co(this.ro,t)&&(this.ao(this.ro),e=!0),e},t.prototype.co=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.uo&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.oo=function(t){if(t.docChanges.length>0)return!0;var e=this.ro&&this.ro.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.ao=function(t){t=ef.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.io=!0,this.so.next(t)},t}(),hf=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.ho=function(){return"metadata"in this.payload},t}(),ff=function(){function t(t){this.D=t}return t.prototype.Gn=function(t){return yu(this.D,t)},t.prototype.zn=function(t){return t.metadata.exists?_u(this.D,t.document,!1):new us(this.Gn(t.metadata.name),this.Hn(t.metadata.readTime))},t.prototype.Hn=function(t){return pu(t)},t}();!function(){function t(t,e,n){this.lo=t,this.localStore=e,this.D=n,this.queries=[],this.documents=[],this.progress=function(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(t)}t.prototype.fo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.wo=function(t){for(var e=new Map,n=new ff(this.D),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Gn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],l=(e.get(c)||$a()).add(s);e.set(c,l)}}return e},t.prototype.complete=function(){return so(this,void 0,void 0,(function(){var t,e,n,r,i;return ao(this,(function(o){switch(o.label){case 0:return[4,Bl(this.localStore,new ff(this.D),this.documents,this.lo.id)];case 1:t=o.sent(),e=this.wo(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,Kl(this.localStore,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Sl(Object.assign({},this.progress),t))]}}))}))}}();var pf=function(t){this.key=t},df=function(t){this.key=t},gf=function(){function t(t,e){this.query=t,this._o=e,this.mo=null,this.current=!1,this.yo=$a(),this.mutatedKeys=$a(),this.po=Gs(t),this.Eo=new Zh(this.po)}return Object.defineProperty(t.prototype,"To",{get:function(){return this._o},enumerable:!1,configurable:!0}),t.prototype.Io=function(t,e){var n=this,r=e?e.Ao:new tf,i=e?e.Eo:this.Eo,o=e?e.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=Ls(this.query)&&i.size===this.query.limit?i.last():null,c=Rs(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=e instanceof as?e:null;h&&(h=zs(n.query,h)?h:null);var f=!!l&&n.mutatedKeys.has(l.key),p=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),d=!1;l&&h?l.data().isEqual(h.data())?f!==p&&(r.track({type:3,doc:h}),d=!0):n.Ro(l,h)||(r.track({type:2,doc:h}),d=!0,(u&&n.po(h,u)>0||c&&n.po(h,c)<0)&&(a=!0)):!l&&h?(r.track({type:0,doc:h}),d=!0):l&&!h&&(r.track({type:1,doc:l}),d=!0,(u||c)&&(a=!0)),d&&(h?(s=s.add(h),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Ls(this.query)||Rs(this.query))for(;s.size>this.query.limit;){var l=Ls(this.query)?s.last():s.first();s=s.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{Eo:s,Ao:r,Mn:a,mutatedKeys:o}},t.prototype.Ro=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.Eo;this.Eo=t.Eo,this.mutatedKeys=t.mutatedKeys;var o=t.Ao.Yr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return yo()}};return n(t)-n(e)}(t.type,e.type)||r.po(t.doc,e.doc)})),this.bo(n);var s=e?this.vo():[],a=0===this.yo.size&&this.current?1:0,u=a!==this.mo;return this.mo=a,0!==o.length||u?{snapshot:new ef(this.query,t.Eo,i,o,t.mutatedKeys,0===a,u,!1),Po:s}:{Po:s}},t.prototype.eo=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Eo:this.Eo,Ao:new tf,mutatedKeys:this.mutatedKeys,Mn:!1},!1)):{Po:[]}},t.prototype.Vo=function(t){return!this._o.has(t)&&!!this.Eo.has(t)&&!this.Eo.get(t).hasLocalMutations},t.prototype.bo=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e._o=e._o.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e._o=e._o.delete(t)})),this.current=t.current)},t.prototype.vo=function(){var t=this;if(!this.current)return[];var e=this.yo;this.yo=$a(),this.Eo.forEach((function(e){t.Vo(e.key)&&(t.yo=t.yo.add(e.key))}));var n=[];return e.forEach((function(e){t.yo.has(e)||n.push(new df(e))})),this.yo.forEach((function(t){e.has(t)||n.push(new pf(t))})),n},t.prototype.So=function(t){this._o=t.jn,this.yo=$a();var e=this.Io(t.documents);return this.applyChanges(e,!0)},t.prototype.Do=function(){return ef.fromInitialDocuments(this.query,this.Eo,this.mutatedKeys,0===this.mo)},t}(),vf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},yf=function(t){this.key=t,this.Co=!1},mf=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.xo={},this.No=new ll((function(t){return Bs(t)}),qs),this.$o=new Map,this.Fo=new Set,this.Oo=new Ma(Fo.comparator),this.ko=new Map,this.Mo=new Gl,this.Lo={},this.Bo=new Map,this.qo=Xc.ne(),this.onlineState="Unknown",this.Uo=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.Uo},enumerable:!1,configurable:!0}),t}();function bf(t,e){return so(this,void 0,void 0,(function(){var n,r,i,o,s,a;return ao(this,(function(u){switch(u.label){case 0:return n=Qf(t),(o=n.No.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Do(),[3,4]):[3,1];case 1:return[4,Ml(n.localStore,js(e))];case 2:return s=u.sent(),a=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,wf(n,e,r,"current"===a)];case 3:i=u.sent(),n.isPrimaryClient&&Nh(n.remoteStore,s),u.label=4;case 4:return[2,i]}}))}))}function wf(t,e,n,r){return so(this,void 0,void 0,(function(){var i,o,s,a,u,c;return ao(this,(function(l){switch(l.label){case 0:return t.Qo=function(e,n,r){return function(t,e,n,r){return so(this,void 0,void 0,(function(){var i,o,s;return ao(this,(function(a){switch(a.label){case 0:return(i=e.view.Io(n)).Mn?[4,Ul(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view.Io(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),s=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(Lf(t,e.targetId,s.Po),s.snapshot)]}}))}))}(t,e,n,r)},[4,Ul(t.localStore,e,!0)];case 1:return i=l.sent(),o=new gf(e,i.jn),s=o.Io(i.documents),a=Za.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(s,t.isPrimaryClient,a),Lf(t,n,u.Po),c=new vf(e,n,o),[2,(t.No.set(e,c),t.$o.has(n)?t.$o.get(n).push(e):t.$o.set(n,[e]),u.snapshot)]}}))}))}function Ef(t,e){return so(this,void 0,void 0,(function(){var n,r,i;return ao(this,(function(o){switch(o.label){case 0:return n=bo(t),r=n.No.get(e),(i=n.$o.get(r.targetId)).length>1?[2,(n.$o.set(r.targetId,i.filter((function(t){return!qs(t,e)}))),void n.No.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Fl(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Ah(n.remoteStore,r.targetId),Cf(n,r.targetId)})).catch(rl)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Cf(n,r.targetId),[4,Fl(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function If(t,e,n){return so(this,void 0,void 0,(function(){var r,i,o,s;return ao(this,(function(a){switch(a.label){case 0:r=$f(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=bo(t),i=Ko.now(),o=e.reduce((function(t,e){return t.add(e.key)}),$a());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Kn.bn(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],l=wa(c,n.get(c.key));null!=l&&s.push(new Sa(c.key,l,Js(l.proto.mapValue),ga.exists(!0)))}return r.Tn.addMutationBatch(t,i,s,e)}))})).then((function(t){var e=t.applyToLocalDocumentSet(n);return{batchId:t.batchId,changes:e}}))}(r.localStore,e)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.Lo[t.currentUser.toKey()];r||(r=new Ma(Io)),r=r.insert(e,n),t.Lo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,Mf(r,i.changes)];case 3:return a.sent(),[4,qh(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Xh(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function _f(t,e){return so(this,void 0,void 0,(function(){var n,r;return ao(this,(function(i){switch(i.label){case 0:n=bo(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Ll(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.ko.get(e);r&&(mo(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.Co=!0:t.modifiedDocuments.size>0?mo(r.Co):t.removedDocuments.size>0&&(mo(r.Co),r.Co=!1))})),[4,Mf(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,rl(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Sf(t,e,n){var r=bo(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.No.forEach((function(t,n){var r=n.view.eo(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=bo(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].eo(e)&&(r=!0)})),r&&cf(n)}(r.eventManager,e),i.length&&r.xo.Tr(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Tf(t,e,n){return so(this,void 0,void 0,(function(){var r,i,o,s,a,u;return ao(this,(function(c){switch(c.label){case 0:return(r=bo(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.ko.get(e),(o=i&&i.key)?(s=(s=new Ma(Fo.comparator)).insert(o,new us(o,Ws.min())),a=$a().add(o),u=new Xa(Ws.min(),new Map,new ja(Io),s,a),[4,_f(r,u)]):[3,2];case 1:return c.sent(),r.Oo=r.Oo.remove(o),r.ko.delete(e),Pf(r),[3,4];case 2:return[4,Fl(r.localStore,e,!1).then((function(){return Cf(r,e,n)})).catch(rl)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function kf(t,e){return so(this,void 0,void 0,(function(){var n,r,i;return ao(this,(function(o){switch(o.label){case 0:n=bo(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Cl(n.localStore,e)];case 2:return i=o.sent(),Df(n,r,null),Af(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Mf(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,rl(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function xf(t,e,n){return so(this,void 0,void 0,(function(){var r,i;return ao(this,(function(o){switch(o.label){case 0:r=bo(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=bo(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.Tn.lookupMutationBatch(t,e).next((function(e){return mo(null!==e),r=e.keys(),n.Tn.removeMutationBatch(t,e)})).next((function(){return n.Tn.performConsistencyCheck(t)})).next((function(){return n.Kn.bn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),Df(r,e,n),Af(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Mf(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,rl(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Nf(t,e){return so(this,void 0,void 0,(function(){var n,r,i,o,s;return ao(this,(function(a){switch(a.label){case 0:Rh((n=bo(t)).remoteStore)||fo("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=bo(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.Tn.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Bo.get(r)||[]).push(e),n.Bo.set(r,i),[3,4]);case 3:return o=a.sent(),s=Xh(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function Af(t,e){(t.Bo.get(e)||[]).forEach((function(t){t.resolve()})),t.Bo.delete(e)}function Df(t,e,n){var r=bo(t),i=r.Lo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Lo[r.currentUser.toKey()]=i}}function Cf(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.$o.get(e);r<i.length;r++){var o=i[r];t.No.delete(o),n&&t.xo.Ko(o,n)}t.$o.delete(e),t.isPrimaryClient&&t.Mo.os(e).forEach((function(e){t.Mo.containsKey(e)||Of(t,e)}))}function Of(t,e){t.Fo.delete(e.path.canonicalString());var n=t.Oo.get(e);null!==n&&(Ah(t.remoteStore,n),t.Oo=t.Oo.remove(e),t.ko.delete(n),Pf(t))}function Lf(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof pf?(t.Mo.addReference(o.key,e),Rf(t,o)):o instanceof df?(fo("SyncEngine","Document no longer in limbo: "+o.key),t.Mo.removeReference(o.key,e),t.Mo.containsKey(o.key)||Of(t,o.key)):yo()}}function Rf(t,e){var n=e.key,r=n.path.canonicalString();t.Oo.get(n)||t.Fo.has(r)||(fo("SyncEngine","New document in limbo: "+n),t.Fo.add(r),Pf(t))}function Pf(t){for(;t.Fo.size>0&&t.Oo.size<t.maxConcurrentLimboResolutions;){var e=t.Fo.values().next().value;t.Fo.delete(e);var n=new Fo(Ro.fromString(e)),r=t.qo.next();t.ko.set(r,new yf(n)),t.Oo=t.Oo.insert(n,r),Nh(t.remoteStore,new Sc(js(Os(n.path)),r,2,co.o))}}function Mf(t,e,n){return so(this,void 0,void 0,(function(){var r,i,o,s;return ao(this,(function(a){switch(a.label){case 0:return r=bo(t),i=[],o=[],s=[],r.No.isEmpty()?[3,3]:(r.No.forEach((function(t,a){s.push(r.Qo(a,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=kl.Nn(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.xo.Tr(i),[4,function(t,e){return so(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l;return ao(this,(function(h){switch(h.label){case 0:n=bo(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return lc.forEach(e,(function(e){return lc.forEach(e.Cn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return lc.forEach(e.xn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return h.sent(),[3,4];case 3:if(!gc(r=h.sent()))throw r;return fo("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.Bn.get(a),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),n.Bn=n.Bn.insert(a,l));return[2]}}))}))}(r.localStore,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function Ff(t,e){return so(this,void 0,void 0,(function(){var n,r;return ao(this,(function(i){switch(i.label){case 0:return(n=bo(t)).currentUser.isEqual(e)?[3,3]:(fo("SyncEngine","User change. New user:",e.toKey()),[4,Dl(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Bo.forEach((function(t){t.forEach((function(t){t.reject(new Oo(Co.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Bo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Mf(n,r.Wn)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Uf(t,e){var n=bo(t),r=n.ko.get(e);if(r&&r.Co)return $a().add(r.key);var i=$a(),o=n.$o.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.No.get(u);i=i.unionWith(c.view.To)}return i}function jf(t,e){return so(this,void 0,void 0,(function(){var n,r,i;return ao(this,(function(o){switch(o.label){case 0:return[4,Ul((n=bo(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.So(r),[2,(n.isPrimaryClient&&Lf(n,e.targetId,i.Po),i)]}}))}))}function Vf(t){return so(this,void 0,void 0,(function(){var e;return ao(this,(function(n){return[2,Vl((e=bo(t)).localStore).then((function(t){return Mf(e,t)}))]}))}))}function qf(t,e,n,r){return so(this,void 0,void 0,(function(){var i,o;return ao(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=bo(t),r=bo(n.Tn);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.Jt(t,e).next((function(e){return e?n.Kn.bn(t,e):lc.resolve(null)}))}))}((i=bo(t)).localStore,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,qh(i.remoteStore)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Df(i,e,r||null),Af(i,e),function(t,e){bo(bo(t).Tn).Xt(e)}(i.localStore,e)):yo(),s.label=4;case 4:return[4,Mf(i,o)];case 5:return s.sent(),[3,7];case 6:fo("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function Bf(t,e){return so(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return ao(this,(function(l){switch(l.label){case 0:return Qf(n=bo(t)),$f(n),!0!==e||!0===n.Uo?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Kf(n,r.toArray())]);case 1:return i=l.sent(),n.Uo=!0,[4,Qh(n.remoteStore,!0)];case 2:for(l.sent(),o=0,s=i;o<s.length;o++)a=s[o],Nh(n.remoteStore,a);return[3,7];case 3:return!1!==e||!1===n.Uo?[3,7]:(u=[],c=Promise.resolve(),n.$o.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return Cf(n,e),Fl(n.localStore,e,!0)})),Ah(n.remoteStore,e)})),[4,c]);case 4:return l.sent(),[4,Kf(n,u)];case 5:return l.sent(),function(t){var e=bo(t);e.ko.forEach((function(t,n){Ah(e.remoteStore,n)})),e.Mo.cs(),e.ko=new Map,e.Oo=new Ma(Fo.comparator)}(n),n.Uo=!1,[4,Qh(n.remoteStore,!1)];case 6:l.sent(),l.label=7;case 7:return[2]}}))}))}function Kf(t,e,n){return so(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,l,h,f,p,d,g;return ao(this,(function(v){switch(v.label){case 0:n=bo(t),r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.$o.get(a))&&0!==c.length?[4,Ml(n.localStore,js(c[0]))]:[3,7]):[3,13];case 2:u=v.sent(),l=0,h=c,v.label=3;case 3:return l<h.length?(f=h[l],p=n.No.get(f),[4,jf(n,p)]):[3,6];case 4:(d=v.sent()).snapshot&&i.push(d.snapshot),v.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,jl(n.localStore,a)];case 8:return g=v.sent(),[4,Ml(n.localStore,g)];case 9:return u=v.sent(),[4,wf(n,zf(g),a,!1)];case 10:v.sent(),v.label=11;case 11:r.push(u),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.xo.Tr(i),r)]}}))}))}function zf(t){return Cs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Gf(t){var e=bo(t);return bo(bo(e.localStore).persistence).gn()}function Hf(t,e,n,r){return so(this,void 0,void 0,(function(){var i,o,s;return ao(this,(function(a){switch(a.label){case 0:return(i=bo(t)).Uo?(fo("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.$o.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Vl(i.localStore)];case 3:return o=a.sent(),s=Xa.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Mf(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,Fl(i.localStore,e,!0)];case 6:return a.sent(),Cf(i,e,r),[3,8];case 7:yo(),a.label=8;case 8:return[2]}}))}))}function Wf(t,e,n){return so(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,l,h,f;return ao(this,(function(p){switch(p.label){case 0:if(!(r=Qf(t)).Uo)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(s=o[i],r.$o.has(s)?(fo("SyncEngine","Adding an already active target "+s),[3,5]):[4,jl(r.localStore,s)]):[3,6];case 2:return a=p.sent(),[4,Ml(r.localStore,a)];case 3:return u=p.sent(),[4,wf(r,zf(a),u.targetId,!1)];case 4:p.sent(),Nh(r.remoteStore,u),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return ao(this,(function(e){switch(e.label){case 0:return r.$o.has(t)?[4,Fl(r.localStore,t,!1).then((function(){Ah(r.remoteStore,t),Cf(r,t)})).catch(rl)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,h=n,p.label=7;case 7:return l<h.length?(f=h[l],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function Qf(t){var e=bo(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=_f.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Uf.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Tf.bind(null,e),e.xo.Tr=af.bind(null,e.eventManager),e.xo.Ko=uf.bind(null,e.eventManager),e}function $f(t){var e=bo(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kf.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=xf.bind(null,e),e}var Yf=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return so(this,void 0,void 0,(function(){return ao(this,(function(e){switch(e.label){case 0:return this.D=mh(t.databaseInfo.databaseId),this.sharedClientState=this.jo(t),this.persistence=this.Go(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.zo(t),this.localStore=this.Ho(t),[2]}}))}))},t.prototype.zo=function(t){return null},t.prototype.Ho=function(t){return Al(this.persistence,new xl,t.initialUser,this.D)},t.prototype.Go=function(t){return new Jl(Zl.Cs,this.D)},t.prototype.jo=function(t){return new lh},t.prototype.terminate=function(){return so(this,void 0,void 0,(function(){return ao(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),Jf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Jo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return oo(e,t),e.prototype.initialize=function(e){return so(this,void 0,void 0,(function(){return ao(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,ql(this.localStore)];case 2:return n.sent(),[4,this.Jo.initialize(this,e)];case 3:return n.sent(),[4,$f(this.Jo.syncEngine)];case 4:return n.sent(),[4,qh(this.Jo.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Ho=function(t){return Al(this.persistence,new xl,t.initialUser,this.D)},e.prototype.zo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new sl(e,t.asyncQueue)},e.prototype.Go=function(t){var e=_l(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?zc.withCacheSize(this.cacheSizeBytes):zc.DEFAULT;return new wl(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,vh(),yh(),this.D,this.sharedClientState,!!this.forceOwnership)},e.prototype.jo=function(t){return new lh},e}(Yf),Xf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Jo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return oo(e,t),e.prototype.initialize=function(e){return so(this,void 0,void 0,(function(){var n,r=this;return ao(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Jo.syncEngine,this.sharedClientState instanceof ch?(this.sharedClientState.syncEngine={wi:qf.bind(null,n),_i:Hf.bind(null,n),mi:Wf.bind(null,n),gn:Gf.bind(null,n),di:Vf.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.en((function(t){return so(r,void 0,void 0,(function(){return ao(this,(function(e){switch(e.label){case 0:return[4,Bf(this.Jo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.jo=function(t){var e=vh();if(!ch.At(e))throw new Oo(Co.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=_l(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new ch(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(Jf),Zf=function(){function t(){}return t.prototype.initialize=function(t,e){return so(this,void 0,void 0,(function(){var n=this;return ao(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Sf(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Ff.bind(null,this.syncEngine),[4,Qh(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new rf},t.prototype.createDatastore=function(t){var e,n=mh(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new gh(e));return function(t,e,n){return new _h(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,s=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Sf(s.syncEngine,t,0)},o=fh.At()?new fh:new hh,new Th(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){var a=new mf(t,e,n,r,i,o);return s&&(a.Uo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return so(this,void 0,void 0,(function(){var e;return ao(this,(function(n){switch(n.label){case 0:return e=bo(t),fo("RemoteStore","RemoteStore shutting down."),e.Qr.add(5),[4,xh(e)];case 1:return n.sent(),e.Wr.shutdown(),e.jr.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}(),tp=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.Yo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.Yo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Xo=function(){this.muted=!0},t.prototype.Yo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),ep=(function(){function t(t,e){var n=this;this.Zo=t,this.D=e,this.metadata=new cc,this.buffer=new Uint8Array,this.tc=new TextDecoder("utf-8"),this.ec().then((function(t){t&&t.ho()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}t.prototype.close=function(){return this.Zo.cancel()},t.prototype.getMetadata=function(){return so(this,void 0,void 0,(function(){return ao(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Wo=function(){return so(this,void 0,void 0,(function(){return ao(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.ec())]}}))}))},t.prototype.ec=function(){return so(this,void 0,void 0,(function(){var t,e,n,r;return ao(this,(function(i){switch(i.label){case 0:return[4,this.nc()];case 1:return null===(t=i.sent())?[2,null]:(e=this.tc.decode(t),n=Number(e),isNaN(n)&&this.sc("length string ("+e+") is not valid number"),[4,this.ic(n)]);case 2:return r=i.sent(),[2,new hf(JSON.parse(r),t.length+n)]}}))}))},t.prototype.rc=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.nc=function(){return so(this,void 0,void 0,(function(){var t,e;return ao(this,(function(n){switch(n.label){case 0:return this.rc()<0?[4,this.oc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.rc())<0&&this.sc("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.ic=function(t){return so(this,void 0,void 0,(function(){var e;return ao(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.oc()]:[3,3];case 1:n.sent()&&this.sc("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.tc.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.sc=function(t){throw this.Zo.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.oc=function(){return so(this,void 0,void 0,(function(){var t,e;return ao(this,(function(n){switch(n.label){case 0:return[4,this.Zo.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))}}(),function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return so(this,void 0,void 0,(function(){var e,n=this;return ao(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Oo(Co.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return so(this,void 0,void 0,(function(){var n,r,i,o,s,a;return ao(this,(function(u){switch(u.label){case 0:return n=bo(t),r=wu(n.D)+"/documents",i={documents:e.map((function(t){return vu(n.D,t)}))},[4,n.Ui("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){mo(!!e.found),e.found.name,e.found.updateTime;var n=yu(t,e.found.name),r=pu(e.found.updateTime),i=new $s({mapValue:{fields:e.found.fields}});return new as(n,r,i,{})}(t,e):"missing"in e?function(t,e){mo(!!e.missing),mo(!!e.readTime);var n=yu(t,e.missing),r=pu(e.readTime);return new us(n,r)}(t,e):yo()}(n.D,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());mo(!!e),a.push(e)})),a)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof us||t instanceof as?n.recordVersion(t):yo()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new Ca(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return so(this,void 0,void 0,(function(){var t,e=this;return ao(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Fo.fromPath(n);e.mutations.push(new Oa(r,e.precondition(r)))})),[4,function(t,e){return so(this,void 0,void 0,(function(){var n,r,i;return ao(this,(function(o){switch(o.label){case 0:return n=bo(t),r=wu(n.D)+"/documents",i={writes:e.map((function(t){return Su(n.D,t)}))},[4,n.Mi("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t instanceof as)e=t.version;else{if(!(t instanceof us))throw yo();e=Ws.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Oo(Co.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?ga.updateTime(e):ga.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Ws.min()))throw new Oo(Co.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ga.updateTime(e)}return ga.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}()),np=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.cc=5,this.rr=new bh(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ac()},t.prototype.ac=function(){var t=this;this.rr.Yi((function(){return so(t,void 0,void 0,(function(){var t,e,n=this;return ao(this,(function(r){return t=new ep(this.datastore),(e=this.uc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.hc(t)}))}))})).catch((function(t){n.hc(t)})),[2]}))}))}))},t.prototype.uc=function(t){try{var e=this.updateFunction(t);return!No(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.hc=function(t){var e=this;this.cc>0&&this.lc(t)?(this.cc-=1,this.asyncQueue.enqueueAndForget((function(){return e.ac(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.lc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ra(e)}return!1},t}(),rp=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=th.UNAUTHENTICATED,this.clientId=Eo.u(),this.credentialListener=function(){},this.receivedInitialUser=new cc,this.credentials.setChangeListener((function(t){fo("FirestoreClient","Received user=",t.uid),r.user=t,r.credentialListener(t),r.receivedInitialUser.resolve()}))}return t.prototype.getConfiguration=function(){return so(this,void 0,void 0,(function(){return ao(this,(function(t){switch(t.label){case 0:return[4,this.receivedInitialUser.promise];case 1:return[2,(t.sent(),{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100})]}}))}))},t.prototype.setCredentialChangeListener=function(t){var e=this;this.credentialListener=t,this.receivedInitialUser.promise.then((function(){return e.credentialListener(e.user)}))},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Oo(Co.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new cc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return so(t,void 0,void 0,(function(){var t,n;return ao(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Xh(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function ip(t,e){return so(this,void 0,void 0,(function(){var n,r,i=this;return ao(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),fo("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(n){r.isEqual(n)||(r=n,t.asyncQueue.enqueueRetryable((function(){return so(i,void 0,void 0,(function(){return ao(this,(function(t){switch(t.label){case 0:return[4,Dl(e.localStore,n)];case 1:return t.sent(),[2]}}))}))})))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function op(t,e){return so(this,void 0,void 0,(function(){var n,r;return ao(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,sp(t)];case 1:return n=i.sent(),fo("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(n){return t.asyncQueue.enqueueRetryable((function(){return function(t,e){return so(this,void 0,void 0,(function(){var n,r;return ao(this,(function(i){switch(i.label){case 0:return(n=bo(t)).asyncQueue.verifyOperationInProgress(),fo("RemoteStore","RemoteStore received new credentials"),r=Rh(n),n.Qr.add(3),[4,xh(n)];case 1:return i.sent(),r&&n.jr.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Qr.delete(3),[4,kh(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,n)}))})),t.onlineComponents=e,[2]}}))}))}function sp(t){return so(this,void 0,void 0,(function(){return ao(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(fo("FirestoreClient","Using default OfflineComponentProvider"),[4,ip(t,new Yf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function ap(t){return so(this,void 0,void 0,(function(){return ao(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(fo("FirestoreClient","Using default OnlineComponentProvider"),[4,op(t,new Zf)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function up(t){return sp(t).then((function(t){return t.persistence}))}function cp(t){return sp(t).then((function(t){return t.localStore}))}function lp(t){return ap(t).then((function(t){return t.remoteStore}))}function hp(t){return ap(t).then((function(t){return t.syncEngine}))}function fp(t){return so(this,void 0,void 0,(function(){var e,n;return ao(this,(function(r){switch(r.label){case 0:return[4,ap(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=bf.bind(null,e.syncEngine),n.onUnlisten=Ef.bind(null,e.syncEngine),n)]}}))}))}function pp(t,e,n){var r=this;void 0===n&&(n={});var i=new cc;return t.asyncQueue.enqueueAndForget((function(){return so(r,void 0,void 0,(function(){var r;return ao(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new tp({next:function(o){e.enqueueAndForget((function(){return sf(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new Oo(Co.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new Oo(Co.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new lf(Os(n.path),o,{includeMetadataChanges:!0,uo:!0});return of(t,s)},[4,fp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function dp(t,e,n){var r=this;void 0===n&&(n={});var i=new cc;return t.asyncQueue.enqueueAndForget((function(){return so(r,void 0,void 0,(function(){var r;return ao(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new tp({next:function(n){e.enqueueAndForget((function(){return sf(t,s)})),n.fromCache&&"server"===r.source?i.reject(new Oo(Co.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new lf(n,o,{includeMetadataChanges:!0,uo:!0});return of(t,s)},[4,fp(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var gp=function(t,e,n,r,i,o){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.autoDetectLongPolling=o},vp=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),yp=new Map,mp=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},bp=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){this.changeListener=t,t(th.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),wp=function(){function t(t){var e=this;this.fc=null,this.currentUser=th.UNAUTHENTICATED,this.receivedInitialUser=!1,this.dc=0,this.changeListener=null,this.forceRefresh=!1,this.fc=function(){e.dc++,e.currentUser=e.wc(),e.receivedInitialUser=!0,e.changeListener&&e.changeListener(e.currentUser)},this.dc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.fc):(this.fc(null),t.get().then((function(t){e.auth=t,e.fc&&e.auth.addAuthTokenListener(e.fc)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.dc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.dc!==e?(fo("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(mo("string"==typeof n.accessToken),new mp(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){this.changeListener=t,this.receivedInitialUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.fc),this.fc=null,this.changeListener=null},t.prototype.wc=function(){var t=this.auth&&this.auth.getUid();return mo(null===t||"string"==typeof t),new th(t)},t}(),Ep=function(){function t(t,e){this._c=t,this.mc=e,this.type="FirstParty",this.user=th.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.mc},e=this._c.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Ip=function(){function t(t,e){this._c=t,this.mc=e}return t.prototype.getToken=function(){return Promise.resolve(new Ep(this._c,this.mc))},t.prototype.setChangeListener=function(t){t(th.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function _p(t,e,n){if(!n)throw new Oo(Co.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Sp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Oo(Co.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Tp(t,e,n,r){if(!0===e&&!0===r)throw new Oo(Co.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function kp(t){if(!Fo.isDocumentKey(t))throw new Oo(Co.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function xp(t){if(Fo.isDocumentKey(t))throw new Oo(Co.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Np(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":yo()}function Ap(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Oo(Co.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Np(t);throw new Oo(Co.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Dp(t,e){if(e<=0)throw new Oo(Co.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Cp=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Oo(Co.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Oo(Co.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Tp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Op=function(){function t(t,e){this._persistenceKey="(lite)",this._settings=new Cp({}),this._settingsFrozen=!1,t instanceof vp?(this._databaseId=t,this._credentials=new bp):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Oo(Co.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vp(t.options.projectId)}(t),this._credentials=new wp(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Oo(Co.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Oo(Co.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Cp(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new bp;switch(t.type){case"gapi":var e=t.client;return mo(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ip(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Oo(Co.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=yp.get(this))&&(fo("ComponentProvider","Removing Datastore"),yp.delete(this),t.terminate()),Promise.resolve();var t},t}(),Lp=function(t){this._delegate=t},Rp=function(){function t(t,e,n){this._converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Mp(this.firestore,this._converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Pp=function(){function t(t,e,n){this._converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Mp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Os(r))||this).firestore=e,i._path=r,i.type="collection",i}return oo(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Rp(this.firestore,null,new Fo(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Pp);function Fp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Lp&&(t=t._delegate),_p("collection","path",e),t instanceof Op)return xp(n=Ro.fromString.apply(Ro,uo([e],r))),new Mp(t,null,n);if(!(t instanceof Rp||t instanceof Mp))throw new Oo(Co.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return xp(n=Ro.fromString.apply(Ro,uo([t.path],r)).child(Ro.fromString(e))),new Mp(t.firestore,null,n)}function Up(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Lp&&(t=t._delegate),1===arguments.length&&(e=Eo.u()),_p("doc","path",e),t instanceof Op)return kp(n=Ro.fromString.apply(Ro,uo([e],r))),new Rp(t,null,new Fo(n));if(!(t instanceof Rp||t instanceof Mp))throw new Oo(Co.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return kp(n=t._path.child(Ro.fromString.apply(Ro,uo([e],r)))),new Rp(t.firestore,t instanceof Mp?t._converter:null,new Fo(n))}function jp(t,e){return t instanceof Lp&&(t=t._delegate),e instanceof Lp&&(e=e._delegate),(t instanceof Rp||t instanceof Mp)&&(e instanceof Rp||e instanceof Mp)&&t.firestore===e.firestore&&t.path===e.path&&t._converter===e._converter}function Vp(t,e){return t instanceof Lp&&(t=t._delegate),e instanceof Lp&&(e=e._delegate),t instanceof Pp&&e instanceof Pp&&t.firestore===e.firestore&&qs(t._query,e._query)&&t._converter===e._converter}var qp=function(){function t(){var t=this;this.yc=Promise.resolve(),this.gc=[],this.Ec=!1,this.Tc=[],this.Ic=null,this.Ac=!1,this.Rc=[],this.rr=new bh(this,"async_queue_retry"),this.bc=function(){var e=yh();e&&fo("AsyncQueue","Visibility state changed to "+e.visibilityState),t.rr.Zi()};var e=yh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.bc)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this.Ec},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.vc(),this.Pc(t)},t.prototype.enterRestrictedMode=function(){if(!this.Ec){this.Ec=!0;var t=yh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.bc)}},t.prototype.enqueue=function(t){return this.vc(),this.Ec?new Promise((function(t){})):this.Pc(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.gc.push(t),e.Vc()}))},t.prototype.Vc=function(){return so(this,void 0,void 0,(function(){var t,e=this;return ao(this,(function(n){switch(n.label){case 0:if(0===this.gc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.gc[0]()];case 2:return n.sent(),this.gc.shift(),this.rr.reset(),[3,4];case 3:if(!gc(t=n.sent()))throw t;return fo("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.gc.length>0&&this.rr.Yi((function(){return e.Vc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Pc=function(t){var e=this,n=this.yc.then((function(){return e.Ac=!0,t().catch((function(t){throw e.Ic=t,e.Ac=!1,po("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.Ac=!1,t}))}));return this.yc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.vc(),this.Rc.indexOf(t)>-1&&(e=0);var i=Jh.createAndSchedule(this,t,e,n,(function(t){return r.Sc(t)}));return this.Tc.push(i),i},t.prototype.vc=function(){this.Ic&&yo()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Dc=function(){return so(this,void 0,void 0,(function(){var t;return ao(this,(function(e){switch(e.label){case 0:return[4,t=this.yc];case 1:e.sent(),e.label=2;case 2:if(t!==this.yc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Cc=function(t){for(var e=0,n=this.Tc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.xc=function(t){var e=this;return this.Dc().then((function(){e.Tc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.Tc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Dc()}))},t.prototype.Nc=function(t){this.Rc.push(t)},t.prototype.Sc=function(t){var e=this.Tc.indexOf(t);this.Tc.splice(e,1)},t}();function Bp(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}!function(){function t(){this._progressObserver={},this._taskCompletionResolver=new cc,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}();var Kp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._queue=new qp,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return oo(e,t),e.prototype._terminate=function(){return this._firestoreClient||Gp(this),this._firestoreClient.terminate()},e}(Op);function zp(t){return t._firestoreClient||Gp(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Gp(t){var e=t._freezeSettings(),n=function(t,e,n){return new gp(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t._databaseId,t._persistenceKey,e);t._firestoreClient=new rp(t._credentials,t._queue,n)}function Hp(t,e,n){var r=this,i=new cc;return t.asyncQueue.enqueue((function(){return so(r,void 0,void 0,(function(){var r;return ao(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,ip(t,n)];case 1:return o.sent(),[4,op(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Co.FAILED_PRECONDITION||t.code===Co.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function Wp(t){if(t._initialized||t._terminated)throw new Oo(Co.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Qp=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Oo(Co.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Mo(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),$p=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Uo.fromBase64String(e))}catch(e){throw new Oo(Co.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Uo.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),Yp=function(t){this._methodName=t},Jp=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Oo(Co.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Oo(Co.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Io(this._lat,t._lat)||Io(this._long,t._long)},t}(),Xp=/^__.*__$/,Zp=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Sa(t,this.data,this.fieldMask,e,this.fieldTransforms):new _a(t,this.data,e,this.fieldTransforms)},t}(),td=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Sa(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function ed(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw yo()}}var nd=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.D=n,this.ignoreUndefinedProperties=r,void 0===i&&this.$c(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Fc",{get:function(){return this.settings.Fc},enumerable:!1,configurable:!0}),t.prototype.Oc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.D,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Oc({path:n,Mc:!1});return r.Lc(t),r},t.prototype.Bc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Oc({path:n,Mc:!1});return r.$c(),r},t.prototype.qc=function(t){return this.Oc({path:void 0,Mc:!0})},t.prototype.Uc=function(t){return Id(t,this.settings.methodName,this.settings.Qc||!1,this.path,this.settings.Kc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.$c=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Lc(this.path.get(t))},t.prototype.Lc=function(t){if(0===t.length)throw this.Uc("Document fields must not be empty");if(ed(this.Fc)&&Xp.test(t))throw this.Uc('Document fields cannot begin and end with "__"')},t}(),rd=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.D=n||mh(t)}return t.prototype.Wc=function(t,e,n,r){return void 0===r&&(r=!1),new nd({Fc:t,methodName:e,Kc:n,path:Mo.emptyPath(),Mc:!1,Qc:r},this.databaseId,this.D,this.ignoreUndefinedProperties)},t}();function id(t){var e=t._freezeSettings(),n=mh(t._databaseId);return new rd(t._databaseId,!!e.ignoreUndefinedProperties,n)}function od(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Wc(o.merge||o.mergeFields?2:0,e,n,i);md("Data must be an object, but it was:",s,r);var a,u,c=vd(r,s);if(o.merge)a=new Qs(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var p=bd(e,f[h],n);if(!s.contains(p))throw new Oo(Co.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");_d(l,p)||l.push(p)}a=new Qs(l),u=s.fieldTransforms.filter((function(t){return a.covers(t.field)}))}else a=null,u=s.fieldTransforms;return new Zp(new $s(c),a,u)}var sd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oo(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Fc)throw 1===t.Fc?t.Uc(this._methodName+"() can only appear at the top level of your update data"):t.Uc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Yp);function ad(t,e,n){return new nd({Fc:3,Kc:e.settings.Kc,methodName:t._methodName,Mc:n},e.databaseId,e.D,e.ignoreUndefinedProperties)}var ud=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oo(e,t),e.prototype._toFieldTransform=function(t){return new pa(t.path,new oa)},e.prototype.isEqual=function(t){return t instanceof e},e}(Yp),cd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).jc=n,r}return oo(e,t),e.prototype._toFieldTransform=function(t){var e=ad(this,t,!0),n=this.jc.map((function(t){return gd(t,e)})),r=new sa(n);return new pa(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Yp),ld=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).jc=n,r}return oo(e,t),e.prototype._toFieldTransform=function(t){var e=ad(this,t,!0),n=this.jc.map((function(t){return gd(t,e)})),r=new ua(n);return new pa(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Yp),hd=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Gc=n,r}return oo(e,t),e.prototype._toFieldTransform=function(t){var e=new la(t.D,ta(t.D,this.Gc));return new pa(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Yp);function fd(t,e,n,r){var i=t.Wc(1,e,n);md("Data must be an object, but it was:",i,r);var o=[],s=new Ys;ko(r,(function(t,r){var a=Ed(e,t,n);r instanceof Lp&&(r=r._delegate);var u=i.Bc(a);if(r instanceof sd)o.push(a);else{var c=gd(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new Qs(o);return new td(s.v(),a,i.fieldTransforms)}function pd(t,e,n,r,i,o){var s=t.Wc(1,e,n),a=[bd(e,r,n)],u=[i];if(o.length%2!=0)throw new Oo(Co.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(bd(e,o[c])),u.push(o[c+1]);for(var l=[],h=new Ys,f=a.length-1;f>=0;--f)if(!_d(l,a[f])){var p=a[f],d=u[f];d instanceof Lp&&(d=d._delegate);var g=s.Bc(p);if(d instanceof sd)l.push(p);else{var v=gd(d,g);null!=v&&(l.push(p),h.set(p,v))}}var y=new Qs(l);return new td(h.v(),y,s.fieldTransforms)}function dd(t,e,n,r){return void 0===r&&(r=!1),gd(n,t.Wc(r?4:3,e))}function gd(t,e){if(t instanceof Lp&&(t=t._delegate),yd(t))return md("Unsupported field value:",e,t),vd(t,e);if(t instanceof Yp)return function(t,e){if(!ed(e.Fc))throw e.Uc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Uc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Mc&&4!==e.Fc)throw e.Uc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=gd(o[i],e.qc(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Lp&&(t=t._delegate),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ta(e.D,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ko.fromDate(t);return{timestampValue:lu(e.D,n)}}if(t instanceof Ko)return n=new Ko(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:lu(e.D,n)};if(t instanceof Jp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof $p)return{bytesValue:hu(e.D,t._byteString)};if(t instanceof Rp){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Uc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:du(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Uc("Unsupported field value: "+Np(t))}(t,e)}function vd(t,e){var n={};return xo(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ko(t,(function(t,r){var i=gd(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function yd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ko||t instanceof Jp||t instanceof $p||t instanceof Rp||t instanceof Yp)}function md(t,e,n){if(!yd(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Np(n);throw"an object"===r?e.Uc(t+" a custom object"):e.Uc(t+" "+r)}}function bd(t,e,n){if(e instanceof Lp&&(e=e._delegate),e instanceof Qp)return e._internalPath;if("string"==typeof e)return Ed(t,e);throw Id("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var wd=new RegExp("[~\\*/\\[\\]]");function Ed(t,e,n){if(e.search(wd)>=0)throw Id("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Qp.bind.apply(Qp,uo([void 0],e.split(".")))))._internalPath}catch(r){throw Id("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Id(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Oo(Co.INVALID_ARGUMENT,(a+=". ")+t+u)}function _d(t,e){return t.some((function(t){return t.isEqual(e)}))}var Sd=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Rp(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Td(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.toProto())}},t.prototype.get=function(t){if(this._document){var e=this._document.data().field(kd("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Td=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oo(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Sd);function kd(t,e){return"string"==typeof e?Ed(t,e):e instanceof Lp?e._delegate._internalPath:e._internalPath}var xd=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Nd=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this)._firestore=e,a._firestoreImpl=e,a.metadata=o,a}return oo(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Ad(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.toProto(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data().field(kd("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Sd),Ad=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oo(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Nd),Dd=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new xd(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Ad(n._firestore,n._userDataWriter,r.key,r,new xd(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query._converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Oo(Co.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){var r=new Ad(t._firestore,t._userDataWriter,e.doc.key,e.doc,new xd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query._converter);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Ad(t._firestore,t._userDataWriter,e.doc.key,e.doc,new xd(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query._converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Cd(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Cd(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return yo()}}function Od(t,e){return t instanceof Nd&&e instanceof Nd?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Dd&&e instanceof Dd&&t._firestore===e._firestore&&Vp(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Ld(t){if(Rs(t)&&0===t.explicitOrderBy.length)throw new Oo(Co.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Rd=function(){};function Pd(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Md=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).zc=e,i.Hc=n,i.Jc=r,i.type="where",i}return oo(e,t),e.prototype._apply=function(t){var e=id(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Oo(Co.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Kd(s,o);for(var u=[],c=0,l=s;c<l.length;c++){var h=l[c];u.push(Bd(r,t,h))}a={arrayValue:{values:u}}}else a=Bd(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Kd(s,o),a=dd(n,"where",s,"in"===o||"not-in"===o);var f=gs.create(i,o,a);return function(t,e){if(e.g()){var n=Ms(t);if(null!==n&&!n.isEqual(e.field))throw new Oo(Co.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Ps(t);null!==r&&zd(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Oo(Co.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Oo(Co.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.zc,this.Hc,this.Jc);return new Pp(t.firestore,t._converter,function(t,e){var n=t.filters.concat([e]);return new Ds(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Rd),Fd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).zc=e,r.Yc=n,r.type="orderBy",r}return oo(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Oo(Co.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Oo(Co.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ks(e,n);return function(t,e){if(null===Ps(t)){var n=Ms(t);null!==n&&zd(0,n,e.field)}}(t,r),r}(t._query,this.zc,this.Yc);return new Pp(t.firestore,t._converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Ds(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Rd),Ud=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Xc=n,i.Zc=r,i}return oo(e,t),e.prototype._apply=function(t){return new Pp(t.firestore,t._converter,Vs(t._query,this.Xc,this.Zc))},e}(Rd),jd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ta=n,i.ea=r,i}return oo(e,t),e.prototype._apply=function(t){var e=qd(t,this.type,this.ta,this.ea);return new Pp(t.firestore,t._converter,function(t,e){return new Ds(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Rd),Vd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ta=n,i.ea=r,i}return oo(e,t),e.prototype._apply=function(t){var e=qd(t,this.type,this.ta,this.ea);return new Pp(t.firestore,t._converter,function(t,e){return new Ds(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Rd);function qd(t,e,n,r){if(n[0]instanceof Lp&&(n[0]=n[0]._delegate),n[0]instanceof Sd)return function(t,e,n,r,i){if(!r)throw new Oo(Co.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=Us(t);s<a.length;s++){var u=a[s];if(u.field.isKeyField())o.push(ts(e,r.key));else{var c=r.field(u.field);if(zo(c))throw new Oo(Co.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new Oo(Co.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Ss(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=id(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Oo(Co.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Oo(Co.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Fs(t)&&-1!==c.indexOf("/"))throw new Oo(Co.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(Ro.fromString(c));if(!Fo.isDocumentKey(l))throw new Oo(Co.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new Fo(l);a.push(ts(e,h))}else{var f=dd(n,r,c);a.push(f)}}return new Ss(a,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function Bd(t,e,n){if(n instanceof Lp&&(n=n._delegate),"string"==typeof n){if(""===n)throw new Oo(Co.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Fs(e)&&-1!==n.indexOf("/"))throw new Oo(Co.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Ro.fromString(n));if(!Fo.isDocumentKey(r))throw new Oo(Co.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ts(t,new Fo(r))}if(n instanceof Rp)return ts(t,n._key);throw new Oo(Co.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Np(n)+".")}function Kd(t,e){if(!Array.isArray(t)||0===t.length)throw new Oo(Co.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Oo(Co.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function zd(t,e,n){if(!n.isEqual(e))throw new Oo(Co.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var Gd=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Wo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return qo(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Bo(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw yo()}},t.prototype.convertObject=function(t,e){var n=this,r={};return ko(t.fields||{},(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new Jp(qo(t.latitude),qo(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Go(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Ho(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Vo(t);return new Ko(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=Ro.fromString(t);mo(ju(n));var r=new vp(n.get(1),n.get(3)),i=new Fo(n.popFirst(5));return r.isEqual(e)||po("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function Hd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Wd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return oo(e,t),e.prototype.convertBytes=function(t){return new $p(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Rp(this.firestore,null,e)},e}(Gd),Qd=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=id(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=$d(t,this._firestore),i=Hd(r._converter,e,n),o=od(this._dataReader,"WriteBatch.set",r._key,i,null!==r._converter,n);return this._mutations.push(o.toMutation(r._key,ga.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,s=$d(t,this._firestore);return e instanceof Lp&&(e=e._delegate),o="string"==typeof e||e instanceof Qp?pd(this._dataReader,"WriteBatch.update",s._key,e,n,r):fd(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,ga.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=$d(t,this._firestore);return this._mutations=this._mutations.concat(new Ca(e._key,ga.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Oo(Co.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function $d(t,e){if(t instanceof Lp&&(t=t._delegate),t.firestore!==e)throw new Oo(Co.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Yd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return oo(e,t),e.prototype.convertBytes=function(t){return new $p(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Rp(this.firestore,null,e)},e}(Gd);function Jd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Ap(t,Rp);var o=Ap(t.firestore,Kp),s=id(o);return e instanceof Lp&&(e=e._delegate),Zd(o,[("string"==typeof e||e instanceof Qp?pd(s,"updateDoc",t._key,e,n,r):fd(s,"updateDoc",t._key,e)).toMutation(t._key,ga.exists(!0))])}function Xd(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof Lp&&(t=t._delegate);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||Bp(i[a])||(s=i[a],a++);var u,c,l,h={includeMetadataChanges:s.includeMetadataChanges};if(Bp(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof Rp)c=Ap(t.firestore,Kp),l=Os(t._key.path),u={next:function(e){i[a]&&i[a](tg(c,t,e))},error:i[a+1],complete:i[a+2]};else{var p=Ap(t,Pp);c=Ap(p.firestore,Kp),l=p._query;var d=new Yd(c);u={next:function(t){i[a]&&i[a](new Dd(c,d,p,t))},error:i[a+1],complete:i[a+2]},Ld(t._query)}return function(t,e,n,r){var i=this,o=new tp(r),s=new lf(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return so(i,void 0,void 0,(function(){var e;return ao(this,(function(n){switch(n.label){case 0:return e=of,[4,fp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Xo(),t.asyncQueue.enqueueAndForget((function(){return so(i,void 0,void 0,(function(){var e;return ao(this,(function(n){switch(n.label){case 0:return e=sf,[4,fp(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(zp(c),l,h,u)}function Zd(t,e){return function(t,e){var n=this,r=new cc;return t.asyncQueue.enqueueAndForget((function(){return so(n,void 0,void 0,(function(){var n;return ao(this,(function(i){switch(i.label){case 0:return n=If,[4,hp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(zp(t),e)}function tg(t,e,n){var r=n.docs.get(e._key),i=new Yd(t);return new Nd(t,i,e._key,r,new xd(n.hasPendingWrites,n.fromCache),e._converter)}var eg=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return oo(e,t),e.prototype.get=function(e){var n=this,r=$d(e,this._firestore),i=new Yd(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new Nd(n._firestore,i,r._key,t._document,new xd(!1,!1),r._converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=id(t)}return t.prototype.get=function(t){var e=this,n=$d(t,this._firestore),r=new Wd(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return yo();var i=t[0];if(i instanceof us)return new Sd(e._firestore,r,n._key,null,n._converter);if(i instanceof as)return new Sd(e._firestore,r,i.key,i,n._converter);throw yo()}))},t.prototype.set=function(t,e,n){var r=$d(t,this._firestore),i=Hd(r._converter,e,n),o=od(this._dataReader,"Transaction.set",r._key,i,null!==r._converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=$d(t,this._firestore);return e instanceof Lp&&(e=e._delegate),o="string"==typeof e||e instanceof Qp?pd(this._dataReader,"Transaction.update",s._key,e,n,r):fd(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this},t.prototype.delete=function(t){var e=$d(t,this._firestore);return this._transaction.delete(e._key),this},t}());function ng(){if("undefined"==typeof Uint8Array)throw new Oo(Co.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function rg(){if("undefined"==typeof atob)throw new Oo(Co.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ig=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oo(e,t),e.fromBase64String=function(t){return rg(),new e($p.fromBase64String(t))},e.fromUint8Array=function(t){return ng(),new e($p.fromUint8Array(t))},e.prototype.toBase64=function(){return rg(),this._delegate.toBase64()},e.prototype.toUint8Array=function(){return ng(),this._delegate.toUint8Array()},e.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Lp),og=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Wp(t=Ap(t,Kp));var n=zp(t),r=t._freezeSettings(),i=new Zf;return Hp(n,i,new Jf(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Wp(t=Ap(t,Kp));var e=zp(t),n=t._freezeSettings(),r=new Zf;return Hp(e,r,new Xf(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Oo(Co.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new cc;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return so(e,void 0,void 0,(function(){var e;return ao(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return so(this,void 0,void 0,(function(){var e;return ao(this,(function(n){switch(n.label){case 0:return fc.At()?(e=t+"main",[4,fc.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(_l(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),sg=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).na=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof vp||(i.sa=e),i}return oo(e,t),Object.defineProperty(e.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._delegate._getSettings()),t)).merge,this._delegate._setSettings(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=Ap(t,Op))._getSettings();"firestore.googleapis.com"!==r.host&&r.host!==e&&go("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this._delegate,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return so(e,void 0,void 0,(function(){var e,n;return ao(this,(function(r){switch(r.label){case 0:return[4,up(t)];case 1:return e=r.sent(),[4,lp(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=bo(t);return e.Qr.delete(0),kh(e)}(n))]}}))}))}))}(zp(Ap(this._delegate,Kp)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return so(e,void 0,void 0,(function(){var e,n;return ao(this,(function(r){switch(r.label){case 0:return[4,up(t)];case 1:return e=r.sent(),[4,lp(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return so(this,void 0,void 0,(function(){var e;return ao(this,(function(n){switch(n.label){case 0:return(e=bo(t)).Qr.add(0),[4,xh(e)];case 1:return n.sent(),e.jr.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(zp(Ap(this._delegate,Kp)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Tp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.na.enableMultiTabIndexedDbPersistence(this):this.na.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.na.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.sa&&(this.sa._removeServiceInstance("firestore"),this.sa._removeServiceInstance("firestore-exp")),this._delegate._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new cc;return t.asyncQueue.enqueueAndForget((function(){return so(e,void 0,void 0,(function(){var e;return ao(this,(function(r){switch(r.label){case 0:return e=Nf,[4,hp(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(zp(Ap(this._delegate,Kp)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new tp(e);return t.asyncQueue.enqueueAndForget((function(){return so(n,void 0,void 0,(function(){var e;return ao(this,(function(n){switch(n.label){case 0:return e=function(t,e){bo(t).Zr.add(e),e.next()},[4,fp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Xo(),t.asyncQueue.enqueueAndForget((function(){return so(n,void 0,void 0,(function(){var e;return ao(this,(function(n){switch(n.label){case 0:return e=function(t,e){bo(t).Zr.delete(e)},[4,fp(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(zp(t=Ap(t,Kp)),Bp(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.sa)throw new Oo(Co.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.sa},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new wg(this,Fp(this._delegate,t))}catch(t){throw fg(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new hg(this,Up(this._delegate,t))}catch(t){throw fg(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new yg(this,function(t,e){if(t=Ap(t,Op),_p("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Oo(Co.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Pp(t,null,function(t){return new Ds(Ro.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw fg(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new cc;return t.asyncQueue.enqueueAndForget((function(){return so(n,void 0,void 0,(function(){var n;return ao(this,(function(i){switch(i.label){case 0:return[4,function(t){return ap(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new np(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(zp(t),(function(n){return e(new eg(t,n))}))}(this._delegate,(function(n){return t(new ug(e,n))}))},e.prototype.batch=function(){var t=this;return zp(this._delegate),new cg(new Qd(this._delegate,(function(e){return Zd(t._delegate,e)})))},e.prototype.loadBundle=function(t){throw new Oo(Co.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new Oo(Co.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(Lp),ag=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return oo(e,t),e.prototype.convertBytes=function(t){return new ig(new $p(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return hg.ia(e,this.firestore,null)},e}(Gd),ug=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this)._firestore=e,r._userDataWriter=new ag(e),r}return oo(e,t),e.prototype.get=function(t){var e=this,n=Eg(t);return this._delegate.get(n).then((function(t){return new gg(e._firestore,new Nd(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n._converter))}))},e.prototype.set=function(t,e,n){var r=Eg(t);return n?(Sp("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Eg(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,uo([s,e,n],i)),this},e.prototype.delete=function(t){var e=Eg(t);return this._delegate.delete(e),this},e}(Lp),cg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oo(e,t),e.prototype.set=function(t,e,n){var r=Eg(t);return n?(Sp("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Eg(t);return 2===arguments.length?this._delegate.update(s,e):(r=this._delegate).update.apply(r,uo([s,e,n],i)),this},e.prototype.delete=function(t){var e=Eg(t);return this._delegate.delete(e),this},e.prototype.commit=function(){return this._delegate.commit()},e}(Lp),lg=function(t){function e(e,n,r){var i=this;return(i=t.call(this,r)||this)._firestore=e,i._userDataWriter=n,i}return oo(e,t),e.prototype.fromFirestore=function(t,e){var n=new Ad(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new vg(this._firestore,n),null!=e?e:{})},e.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},e.ra=function(t,n){var r=e.oa,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new ag(t),n),i.set(n,o)),o},e}(Lp);lg.oa=new WeakMap;var hg=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r._userDataWriter=new ag(e),r}return oo(e,t),e.ca=function(t,n,r){if(t.length%2!=0)throw new Oo(Co.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(n,new Rp(n._delegate,r,new Fo(t)))},e.ia=function(t,n,r){return new e(n,new Rp(n._delegate,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new wg(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new wg(this.firestore,Fp(this._delegate,t))}catch(t){throw fg(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Lp&&(t=t._delegate),t instanceof Rp&&jp(this._delegate,t)},e.prototype.set=function(t,e){e=Sp("DocumentReference.set",e);try{return function(t,e,n){t=Ap(t,Rp);var r=Ap(t.firestore,Kp),i=Hd(t._converter,e,n);return Zd(r,[od(id(r),"setDoc",t._key,i,null!==t._converter,n).toMutation(t._key,ga.none())])}(this._delegate,t,e)}catch(t){throw fg(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Jd(this._delegate,t):Jd.apply(void 0,uo([this._delegate,t,e],n))}catch(t){throw fg(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return Zd(Ap((t=this._delegate).firestore,Kp),[new Ca(t._key,ga.none())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=pg(e),i=dg(e,(function(e){return new gg(t.firestore,new Nd(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate._converter))}));return Xd(this._delegate,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Ap(t,Rp);var e=Ap(t.firestore,Kp),n=zp(e),r=new Yd(e);return function(t,e){var n=this,r=new cc;return t.asyncQueue.enqueueAndForget((function(){return so(n,void 0,void 0,(function(){var n;return ao(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return so(this,void 0,void 0,(function(){var r,i;return ao(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=bo(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Kn.In(t,e)}))}(t,e)];case 1:return(i=o.sent())instanceof as?n.resolve(i):i instanceof us?n.resolve(null):n.reject(new Oo(Co.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Xh(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,cp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new Nd(e,r,t._key,n,new xd(n instanceof as&&n.hasLocalMutations,!0),t._converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Ap(t,Rp);var e=Ap(t.firestore,Kp);return pp(zp(e),t._key,{source:"server"}).then((function(n){return tg(e,t,n)}))}(this._delegate):function(t){t=Ap(t,Rp);var e=Ap(t.firestore,Kp);return pp(zp(e),t._key).then((function(n){return tg(e,t,n)}))}(this._delegate)).then((function(t){return new gg(e.firestore,new Nd(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate._converter))}))},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(lg.ra(this.firestore,t)):this._delegate.withConverter(null))},e}(Lp);function fg(t,e,n){return t.message=t.message.replace(e,n),t}function pg(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Bp(r))return r}return{}}function dg(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Bp(t[0])?t[0]:Bp(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var gg=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this)._firestore=e,r}return oo(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new hg(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this._delegate.data(t)},e.prototype.get=function(t,e){return this._delegate.get(t,e)},e.prototype.isEqual=function(t){return Od(this._delegate,t._delegate)},e}(Lp),vg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oo(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(gg),yg=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r._userDataWriter=new ag(e),r}return oo(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,Pd(this._delegate,function(t,e,n){var r=e,i=kd("where",t);return new Md(i,r,n)}(t,n,r)))}catch(t){throw fg(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Pd(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=kd("orderBy",t);return new Fd(r,n)}(t,n)))}catch(t){throw fg(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Pd(this._delegate,function(t){return Dp("limit",t),new Ud("limit",t,"F")}(t)))}catch(t){throw fg(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Pd(this._delegate,function(t){return Dp("limitToLast",t),new Ud("limitToLast",t,"L")}(t)))}catch(t){throw fg(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Pd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new jd("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw fg(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Pd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new jd("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw fg(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Pd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Vd("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw fg(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Pd(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Vd("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw fg(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Vp(this._delegate,t._delegate)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Ap(t,Pp);var e=Ap(t.firestore,Kp),n=zp(e),r=new Yd(e);return function(t,e){var n=this,r=new cc;return t.asyncQueue.enqueueAndForget((function(){return so(n,void 0,void 0,(function(){var n;return ao(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return so(this,void 0,void 0,(function(){var r,i,o,s,a;return ao(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,Ul(t,e,!0)];case 1:return a=u.sent(),r=new gf(e,a.jn),i=r.Io(a.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=Xh(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,cp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Dd(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Ap(t,Pp);var e=Ap(t.firestore,Kp),n=zp(e),r=new Yd(e);return dp(n,t._query,{source:"server"}).then((function(n){return new Dd(e,r,t,n)}))}(this._delegate):function(t){t=Ap(t,Pp);var e=Ap(t.firestore,Kp),n=zp(e),r=new Yd(e);return Ld(t._query),dp(n,t._query).then((function(n){return new Dd(e,r,t,n)}))}(this._delegate)).then((function(t){return new bg(e.firestore,new Dd(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=pg(e),i=dg(e,(function(e){return new bg(t.firestore,new Dd(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return Xd(this._delegate,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(lg.ra(this.firestore,t)):this._delegate.withConverter(null))},e}(Lp),mg=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this)._firestore=e,r}return oo(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new vg(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),e}(Lp),bg=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this)._firestore=e,r}return oo(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new yg(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new vg(t._firestore,e)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new mg(e._firestore,t)}))},e.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new vg(n._firestore,r))}))},e.prototype.isEqual=function(t){return Od(this._delegate,t._delegate)},e}(Lp),wg=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return oo(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new hg(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new hg(this.firestore,void 0===t?Up(this._delegate):Up(this._delegate,t))}catch(t){throw fg(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Ap(t.firestore,Kp),r=Up(t),i=Hd(t._converter,e);return Zd(n,[od(id(t.firestore),"addDoc",r._key,i,null!==t._converter,{}).toMutation(r._key,ga.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new hg(e.firestore,t)}))},e.prototype.isEqual=function(t){return jp(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(lg.ra(this.firestore,t)):this._delegate.withConverter(null))},e}(yg);function Eg(t){return t instanceof Lp&&(t=t._delegate),Ap(t,Rp)}var Ig,_g=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(Qp.bind.apply(Qp,uo([void 0],e))))||this}return oo(e,t),e.documentId=function(){return new e(Mo.keyField().canonicalString())},e.prototype.isEqual=function(t){return t instanceof Lp&&(t=t._delegate),t instanceof Qp&&this._delegate._internalPath.isEqual(t._internalPath)},e}(Lp),Sg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return oo(e,t),e.serverTimestamp=function(){var t=new ud("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new sd("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new cd("arrayUnion",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new ld("arrayRemove",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new hd("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},e}(Lp),Tg={Firestore:sg,GeoPoint:Jp,Timestamp:Ko,Blob:ig,Transaction:ug,WriteBatch:cg,DocumentReference:hg,DocumentSnapshot:gg,Query:yg,QueryDocumentSnapshot:vg,QuerySnapshot:bg,CollectionReference:wg,FieldPath:_g,FieldValue:Sg,setLogLevel:function(t){var e;e=t,lo.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new St("firestore",(function(t){return function(t,e){return new sg(t,new Kp(t,e),new og)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Tg)))})(Ig=Jt),Ig.registerVersion("@firebase/firestore","2.2.1");const kg={view:t=>e()("line",{class:t.attrs.class,id:t.attrs.id,x1:t.attrs.from[0],y1:t.attrs.from[1],x2:t.attrs.to[0],y2:t.attrs.to[1]})},xg={view:t=>e()("circle",{class:t.attrs.class,id:t.attrs.id,cx:t.attrs.center[0],cy:t.attrs.center[1],r:t.attrs.r})},Ng={view:t=>{const n=t.attrs.width,r=t.attrs.height;return[e()(kg,{class:"axis",from:[n/2,0],to:[n/2,r]}),e()(kg,{class:"axis",from:[0,r/2],to:[n,r/2]}),e()(kg,{class:"axis",from:[0,0],to:[n,r]}),e()(kg,{class:"axis",from:[0,r],to:[n,0]})]}},Ag={view:t=>{const n=t.attrs.width/2/4.5,r=[t.attrs.width/2,t.attrs.height/2],i=[];for(let t=1;t<4.5;++t){const o=e()(xg,{class:"scale-circle",center:r,r:n*t});i.push(o)}return i}},Dg={oninit:t=>{t.state.width=350,t.state.height=350},view:t=>{const n=t.state.width,r=t.state.height;return e()("svg.chart",{width:t.state.width,height:t.state.height,class:t.attrs.class},[e()(Ng,{width:n,height:r}),e()(Ag,{width:n,height:r}),t.children])}},Cg={view:t=>e()(Dg,{},[])},Og={view:t=>e()(Dg,{class:"is-hidden-mobile"},[])},Lg={view:t=>e()(".data-table-wrapper",[t.attrs.dataList.list().map(((t,n)=>e()(Rg,{data:t,idx:n})))])},Rg={view:t=>{const n=t.attrs.data;return e()("table.table.is-bordered.data-table",[e()("caption",{class:f().sprintf("color-%02d",t.attrs.idx+1)},n.getTime()),e()("thead",[e()("th",["Altitude"]),e()("th[colspan=2]",["Wind"]),e()("th",["Temp"])]),e()("tbody",[n.records().map((t=>e()("tr",[e()("td",f().sprintf("%d[%s]",t.getAltitude(),i.altitudeUnitText(l.getMslUnit()))),e()("td",f().sprintf("%.1f[deg]",t.getWindHeading())),e()("td",f().sprintf("%.1f[%s]",t.getWindSpeed(),i.windspeedUnitText(l.getWindspeedUnit()))),e()("td",f().sprintf("%.1f[℃]",t.getTemperature()))]))).reverse()])])}},Pg=Lg;let Mg;const Fg={oninit:t=>{Mg=new class{constructor(){this.db=Jt.firestore(),this.sondeDataRef=this.db.collection("sondeview"),this._list=[],this._selectedData=null}fetch(){this.sondeDataRef.orderBy("measured_at","desc").limit(10).get().then((t=>{this._list=[],t.forEach((t=>{const e=new ot(t.id,t.data());this._list.push(e)})),console.log(this._list),this._selectedData=this._list[0],e().redraw()}))}list(){return this._list}selectedData(){return this._selectedData}},Mg.fetch()},view:t=>{const n=Mg?Mg.selectedData():null;return[e()(rt.NavBar,{title:n?n.getDate():""}),Mg?e()(Ug):"",Mg?e()(".chart-wrapper",[e()(Cg,{dataList:Mg}),e()(Og)]):"",Mg?e()(Pg,{dataList:Mg}):""]}},Ug={view:t=>Mg?e()(".data-selector",[e()(".chart-top-button.is-flex.is-justify-content-space-between",[e()(".field.is-grouped",[Mg.list().map(((t,n)=>{let r=f().sprintf("color-%02d",n+1);return t.id==Mg.selectedData().id&&(r+=" is-active"),e()(".control",[e()("button.button.is-small",{class:r},t.getTime())])}))])])]):""},jg=Fg,Vg={view:t=>[e()(rt.NavBar,{title:"履歴"})]},qg={view:t=>[e()(rt.NavBar,{title:"設定"})]};var Bg=[],Kg=Bg.forEach,zg=Bg.slice;function Gg(t){return Kg.call(zg.call(arguments,1),(function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])})),t}var Hg=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,Wg=function(t,e,n){var r=n||{};r.path=r.path||"/";var i=t+"="+encodeURIComponent(e);if(r.maxAge>0){var o=r.maxAge-0;if(isNaN(o))throw new Error("maxAge should be a Number");i+="; Max-Age="+Math.floor(o)}if(r.domain){if(!Hg.test(r.domain))throw new TypeError("option domain is invalid");i+="; Domain="+r.domain}if(r.path){if(!Hg.test(r.path))throw new TypeError("option path is invalid");i+="; Path="+r.path}if(r.expires){if("function"!=typeof r.expires.toUTCString)throw new TypeError("option expires is invalid");i+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.sameSite)switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return i},Qg={name:"cookie",lookup:function(t){var e;if(t.lookupCookie&&"undefined"!=typeof document){var n=function(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return i.substring(e.length,i.length)}return null}(t.lookupCookie);n&&(e=n)}return e},cacheUserLanguage:function(t,e){e.lookupCookie&&"undefined"!=typeof document&&function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};n&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+60*n*1e3)),r&&(i.domain=r),document.cookie=Wg(t,encodeURIComponent(e),i)}(e.lookupCookie,t,e.cookieMinutes,e.cookieDomain,e.cookieOptions)}},$g={name:"querystring",lookup:function(t){var e;if("undefined"!=typeof window)for(var n=window.location.search.substring(1).split("&"),r=0;r<n.length;r++){var i=n[r].indexOf("=");i>0&&n[r].substring(0,i)===t.lookupQuerystring&&(e=n[r].substring(i+1))}return e}},Yg=null,Jg=function(){if(null!==Yg)return Yg;try{Yg="undefined"!==window&&null!==window.localStorage;var t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch(t){Yg=!1}return Yg},Xg={name:"localStorage",lookup:function(t){var e;if(t.lookupLocalStorage&&Jg()){var n=window.localStorage.getItem(t.lookupLocalStorage);n&&(e=n)}return e},cacheUserLanguage:function(t,e){e.lookupLocalStorage&&Jg()&&window.localStorage.setItem(e.lookupLocalStorage,t)}},Zg=null,tv=function(){if(null!==Zg)return Zg;try{Zg="undefined"!==window&&null!==window.sessionStorage;var t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch(t){Zg=!1}return Zg},ev={name:"sessionStorage",lookup:function(t){var e;if(t.lookupSessionStorage&&tv()){var n=window.sessionStorage.getItem(t.lookupSessionStorage);n&&(e=n)}return e},cacheUserLanguage:function(t,e){e.lookupSessionStorage&&tv()&&window.sessionStorage.setItem(e.lookupSessionStorage,t)}},nv={name:"navigator",lookup:function(t){var e=[];if("undefined"!=typeof navigator){if(navigator.languages)for(var n=0;n<navigator.languages.length;n++)e.push(navigator.languages[n]);navigator.userLanguage&&e.push(navigator.userLanguage),navigator.language&&e.push(navigator.language)}return e.length>0?e:void 0}},rv={name:"htmlTag",lookup:function(t){var e,n=t.htmlTag||("undefined"!=typeof document?document.documentElement:null);return n&&"function"==typeof n.getAttribute&&(e=n.getAttribute("lang")),e}},iv={name:"path",lookup:function(t){var e;if("undefined"!=typeof window){var n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(n instanceof Array)if("number"==typeof t.lookupFromPathIndex){if("string"!=typeof n[t.lookupFromPathIndex])return;e=n[t.lookupFromPathIndex].replace("/","")}else e=n[0].replace("/","")}return e}},ov={name:"subdomain",lookup:function(t){var e;if("undefined"!=typeof window){var n=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi);n instanceof Array&&(e="number"==typeof t.lookupFromSubdomainIndex?n[t.lookupFromSubdomainIndex].replace("http://","").replace("https://","").replace(".",""):n[0].replace("http://","").replace("https://","").replace(".",""))}return e}},sv=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(this,t),this.type="languageDetector",this.detectors={},this.init(e,n)}return m(t,[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=t,this.options=Gg(e,this.options||{},{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"]}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(Qg),this.addDetector($g),this.addDetector(Xg),this.addDetector(ev),this.addDetector(nv),this.addDetector(rv),this.addDetector(iv),this.addDetector(ov)}},{key:"addDetector",value:function(t){this.detectors[t.name]=t}},{key:"detect",value:function(t){var e=this;t||(t=this.options.order);var n=[];return t.forEach((function(t){if(e.detectors[t]){var r=e.detectors[t].lookup(e.options);r&&"string"==typeof r&&(r=[r]),r&&(n=n.concat(r))}})),this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}},{key:"cacheUserLanguage",value:function(t,e){var n=this;e||(e=this.options.caches),e&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(t)>-1||e.forEach((function(e){n.detectors[e]&&n.detectors[e].cacheUserLanguage(t,n.options)})))}}]),t}();sv.type="languageDetector";const av=sv;Jt.initializeApp(firebaseConfig);const uv=document.body;et.use(av).init({fallbackLng:"en",debug:!0,resources:{ja:{translation:{appName:"SondeView",menuView:"閲覧",menuHistory:"履歴",menuSetup:"設定"}},en:{translation:{appName:"SondeView",menuView:"View",menuHistory:"History",menuSetup:"Setup"}}}}).then((()=>{e().route(uv,"/main",{"/main":jg,"/history":Vg,"/setup":qg})}))})()})();